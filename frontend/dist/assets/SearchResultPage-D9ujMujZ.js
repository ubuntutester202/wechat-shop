import{j as e,a as C,u as L,r as n,S as q}from"./index-DWm9dxUp.js";import{P as B}from"./ProductCard-CZ0cuVpc.js";const R=({className:l=""})=>e.jsxs("div",{className:`bg-white rounded-lg shadow-sm overflow-hidden ${l}`,children:[e.jsx("div",{className:"w-full h-32 bg-gray-200 animate-pulse"}),e.jsxs("div",{className:"p-3",children:[e.jsxs("div",{className:"space-y-2 mb-2",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded animate-pulse"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 animate-pulse"})]}),e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("div",{className:"h-5 bg-gray-200 rounded w-16 animate-pulse"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-12 animate-pulse"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex space-x-1",children:[...Array(5)].map((g,c)=>e.jsx("div",{className:"w-3 h-3 bg-gray-200 rounded animate-pulse"},c))}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-8 ml-1 animate-pulse"})]})]})]}),M=()=>{const[l,g]=C(),c=L(),[i,o]=n.useState([]),[d,p]=n.useState(!0),[m,j]=n.useState(""),[u,x]=n.useState(0),a=l.get("q")||"",y=l.get("category")||"";n.useEffect(()=>{a&&(j(a),N(a,y))},[a,y]);const N=async(s,t)=>{try{p(!0);const r=new URLSearchParams;r.append("q",s),t&&r.append("category",t),console.log(`[搜索] 关键词: ${s}, 分类: ${t}`);const b=await fetch(`/api/products/search?${r.toString()}`),h=await b.json();b.ok?(o(h.data||[]),x(h.total||0)):(console.error("搜索失败:",h),o([]),x(0))}catch(r){console.error("搜索出错:",r),o([]),x(0)}finally{p(!1)}},v=()=>{c(-1)},w=s=>{c(`/product/${s}`)},f=s=>{s.trim()&&g({q:s.trim()})},k=s=>{j(s.target.value)},S=s=>{s.preventDefault(),m.trim()&&f(m.trim())},P=()=>d?e.jsx("div",{className:"grid grid-cols-2 gap-4 px-4",children:[...Array(8)].map((s,t)=>e.jsx(R,{},t))}):i.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 px-4",children:[e.jsx("div",{className:"w-24 h-24 bg-gray-200 rounded-full flex items-center justify-center mb-4",children:e.jsx("svg",{className:"w-12 h-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"未找到相关商品"}),e.jsxs("p",{className:"text-sm text-gray-500 text-center mb-4",children:['抱歉，没有找到与 "',a,'" 相关的商品']}),e.jsx("button",{onClick:()=>f(""),className:"px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium",children:"浏览所有商品"})]}):e.jsx("div",{className:"grid grid-cols-2 gap-4 px-4",children:i.map(s=>e.jsx(B,{product:s,onClick:w},s.id))});return e.jsxs("div",{className:"bg-gray-50 min-h-screen",children:[e.jsx(q,{}),e.jsx("div",{className:"bg-white shadow-sm",children:e.jsxs("div",{className:"flex items-center px-4 py-3",children:[e.jsx("button",{onClick:v,className:"mr-3 p-1","aria-label":"返回",children:e.jsx("svg",{className:"w-6 h-6 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})})}),e.jsx("form",{onSubmit:S,className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:"搜索商品",value:m,onChange:k,className:"w-full bg-gray-100 rounded-full px-4 py-2 pr-10 text-sm outline-none focus:bg-gray-50 transition-colors",autoFocus:!0}),e.jsx("button",{type:"submit",className:"absolute right-3 top-1/2 -translate-y-1/2","aria-label":"搜索",children:e.jsx("svg",{className:"w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]})})]})}),!d&&e.jsx("div",{className:"px-4 py-3 bg-white border-b border-gray-100",children:e.jsx("p",{className:"text-sm text-gray-600",children:u>0?e.jsxs(e.Fragment,{children:["找到 ",e.jsx("span",{className:"font-medium text-gray-900",children:u})," 个相关商品"]}):e.jsxs(e.Fragment,{children:['搜索 "',a,'" 的结果']})})}),e.jsx("div",{className:"py-4",children:P()}),!d&&i.length>0&&i.length<u&&e.jsx("div",{className:"flex justify-center py-6",children:e.jsx("button",{className:"px-6 py-2 bg-white border border-gray-300 rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-50",children:"加载更多"})})]})};export{M as default};
//# sourceMappingURL=SearchResultPage-D9ujMujZ.js.map
