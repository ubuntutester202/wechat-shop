{"version":3,"file":"CartPage-I06bZJR2.js","sources":["../../src/pages/cart/CartPage.tsx"],"sourcesContent":["import React from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { useCartStore, CartItem } from '../../stores/cartStore';\r\nimport StatusBar from '../../components/common/StatusBar';\r\nimport BottomNavigation from '../../components/common/BottomNavigation';\r\n\r\n/**\r\n * 购物车页面组件\r\n * 显示购物车中的商品列表、总价，并提供管理购物车的操作\r\n */\r\nconst CartPage: React.FC = () => {\r\n  const navigate = useNavigate();\r\n  const { \r\n    items, \r\n    totalItems, \r\n    totalPrice, \r\n    selectedTotalItems,\r\n    selectedTotalPrice,\r\n    updateQuantity, \r\n    removeItem, \r\n    clearCart,\r\n    toggleItemSelection,\r\n    toggleAllSelection,\r\n    getSelectedItems\r\n  } = useCartStore();\r\n\r\n  // 处理返回\r\n  const handleGoBack = () => {\r\n    navigate(-1);\r\n  };\r\n\r\n  // 处理数量变化\r\n  const handleQuantityChange = (itemId: string, newQuantity: number) => {\r\n    updateQuantity(itemId, newQuantity);\r\n  };\r\n\r\n  // 处理移除商品\r\n  const handleRemoveItem = (itemId: string) => {\r\n    removeItem(itemId);\r\n  };\r\n\r\n  // 跳转到商品详情\r\n  const handleProductClick = (productId: string) => {\r\n    navigate(`/product/${productId}`);\r\n  };\r\n\r\n  // 处理商品勾选\r\n  const handleItemSelection = (itemId: string) => {\r\n    toggleItemSelection(itemId);\r\n  };\r\n\r\n  // 处理全选\r\n  const handleSelectAll = () => {\r\n    toggleAllSelection();\r\n  };\r\n\r\n  // 跳转到结算页面\r\n  const handleCheckout = () => {\r\n    const selectedItems = getSelectedItems();\r\n    if (selectedItems.length === 0) {\r\n      alert('请选择要结算的商品');\r\n      return;\r\n    }\r\n    navigate('/checkout');\r\n  };\r\n\r\n  // 检查是否全选\r\n  const isAllSelected = items.length > 0 && items.every(item => item.selected);\r\n  const hasSelectedItems = items.some(item => item.selected);\r\n\r\n  // 渲染购物车项目\r\n  const renderCartItem = (item: CartItem) => (\r\n    <div key={item.id} className=\"flex items-start gap-4 bg-white p-4 rounded-lg shadow-sm mb-3\">\r\n      {/* 选择框 */}\r\n      <div className=\"flex items-center pt-2\">\r\n        <button\r\n          onClick={() => handleItemSelection(item.id)}\r\n          className={`w-5 h-5 rounded-full border-2 flex items-center justify-center ${\r\n            item.selected \r\n              ? 'border-red-500 bg-red-500' \r\n              : 'border-gray-300'\r\n          }`}\r\n          title={item.selected ? '取消选择' : '选择商品'}\r\n        >\r\n          {item.selected && (\r\n            <svg className=\"w-3 h-3 text-white\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\r\n              <path fillRule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clipRule=\"evenodd\" />\r\n            </svg>\r\n          )}\r\n        </button>\r\n      </div>\r\n      \r\n      {/* 商品图片 */}\r\n      <div \r\n        className=\"w-24 h-24 rounded-md bg-gray-200 cursor-pointer\"\r\n        onClick={() => handleProductClick(item.productId)}\r\n      >\r\n        <img \r\n          src={item.image} \r\n          alt={item.name}\r\n          className=\"w-full h-full object-cover rounded-md\"\r\n        />\r\n      </div>\r\n      \r\n      {/* 商品信息 */}\r\n      <div className=\"flex-1\">\r\n        <p \r\n          className=\"font-medium text-gray-900 mb-1 line-clamp-2 cursor-pointer\"\r\n          onClick={() => handleProductClick(item.productId)}\r\n        >\r\n          {item.name}\r\n        </p>\r\n        <div className=\"text-sm text-gray-500 mb-2\">\r\n          {Object.entries(item.selectedVariants).map(([type, value]) => (\r\n            <span key={type} className=\"mr-2\">{`${type}: ${value}`}</span>\r\n          ))}\r\n        </div>\r\n        <div className=\"flex items-center justify-between\">\r\n          <span className=\"font-bold text-red-600\">¥{item.price.toFixed(2)}</span>\r\n          \r\n          {/* 数量调整 */}\r\n          <div className=\"flex items-center gap-2\">\r\n            <button\r\n              onClick={() => handleQuantityChange(item.id, item.quantity - 1)}\r\n              disabled={item.quantity <= 1}\r\n              className=\"w-7 h-7 rounded-full border border-gray-300 flex items-center justify-center disabled:opacity-50\"\r\n              title=\"减少数量\"\r\n            >\r\n              <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M20 12H4\" /></svg>\r\n            </button>\r\n            <span className=\"text-md font-medium w-8 text-center\">{item.quantity}</span>\r\n            <button\r\n              onClick={() => handleQuantityChange(item.id, item.quantity + 1)}\r\n              disabled={item.quantity >= item.stock}\r\n              className=\"w-7 h-7 rounded-full border border-gray-300 flex items-center justify-center disabled:opacity-50\"\r\n              title=\"增加数量\"\r\n            >\r\n              <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M12 6v6m0 0v6m0-6h6m-6 0H6\" /></svg>\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* 移除按钮 */}\r\n      <button \r\n        onClick={() => handleRemoveItem(item.id)}\r\n        className=\"text-gray-400 hover:text-red-500 transition-colors\"\r\n        title=\"移除商品\"\r\n      >\r\n        <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M6 18L18 6M6 6l12 12\" /></svg>\r\n      </button>\r\n    </div>\r\n  );\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-50\">\r\n      <StatusBar />\r\n      \r\n      {/* 头部导航 */}\r\n      <div className=\"bg-white shadow-sm sticky top-0 z-10\">\r\n        <div className=\"flex items-center justify-between px-4 py-3\">\r\n          <button\r\n            onClick={handleGoBack}\r\n            className=\"flex items-center justify-center w-10 h-10 rounded-full hover:bg-gray-100\"\r\n            title=\"返回\"\r\n          >\r\n            <svg className=\"w-6 h-6 text-gray-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M15 19l-7-7 7-7\" /></svg>\r\n          </button>\r\n          <h1 className=\"text-lg font-medium text-gray-900\">购物车 ({totalItems})</h1>\r\n          <button\r\n            onClick={clearCart}\r\n            className=\"text-sm font-medium text-gray-600 hover:text-red-600\"\r\n          >\r\n            清空\r\n          </button>\r\n        </div>\r\n        \r\n        {/* 全选栏 */}\r\n        {items.length > 0 && (\r\n          <div className=\"flex items-center justify-between px-4 py-3 border-t border-gray-100\">\r\n            <div className=\"flex items-center gap-3\">\r\n              <button\r\n                onClick={handleSelectAll}\r\n                className={`w-5 h-5 rounded-full border-2 flex items-center justify-center ${\r\n                  isAllSelected \r\n                    ? 'border-red-500 bg-red-500' \r\n                    : 'border-gray-300'\r\n                }`}\r\n                title={isAllSelected ? '取消全选' : '全选'}\r\n              >\r\n                {isAllSelected && (\r\n                  <svg className=\"w-3 h-3 text-white\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\r\n                    <path fillRule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clipRule=\"evenodd\" />\r\n                  </svg>\r\n                )}\r\n              </button>\r\n              <span className=\"text-sm text-gray-900\">全选</span>\r\n            </div>\r\n            <div className=\"text-sm text-gray-500\">\r\n              已选择 {selectedTotalItems} 件商品\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n      \r\n      {/* 主要内容 */}\r\n      <div className=\"p-4 pb-40\">\r\n        {items.length > 0 ? (\r\n          items.map(renderCartItem)\r\n        ) : (\r\n          <div className=\"text-center py-20\">\r\n            <svg className=\"w-16 h-16 mx-auto text-gray-300 mb-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"1\" d=\"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z\" />\r\n            </svg>\r\n            <p className=\"text-gray-500 mb-6\">购物车是空的</p>\r\n            <button\r\n              onClick={() => navigate('/shop')}\r\n              className=\"bg-blue-600 text-white font-medium py-3 px-8 rounded-lg hover:bg-blue-700 transition-colors\"\r\n            >\r\n              去逛逛\r\n            </button>\r\n          </div>\r\n        )}\r\n      </div>\r\n      \r\n      {/* 底部结算栏 */}\r\n      {items.length > 0 && (\r\n        <div className=\"fixed bottom-16 left-0 right-0 bg-white border-t border-gray-200 z-40\">\r\n          <div className=\"px-4 py-3\">\r\n            <div className=\"flex items-center justify-between mb-2\">\r\n              <div className=\"text-sm text-gray-600\">\r\n                合计 ({selectedTotalItems} 件):\r\n              </div>\r\n              <div className=\"text-right\">\r\n                <span className=\"font-bold text-red-600 text-xl\">¥{selectedTotalPrice.toFixed(2)}</span>\r\n              </div>\r\n            </div>\r\n            <button\r\n              onClick={handleCheckout}\r\n              className={`w-full font-medium py-3 px-8 rounded-lg transition-colors ${\r\n                hasSelectedItems\r\n                  ? 'bg-red-500 text-white hover:bg-red-600'\r\n                  : 'bg-gray-300 text-gray-500 cursor-not-allowed'\r\n              }`}\r\n              disabled={!hasSelectedItems}\r\n            >\r\n              结算 ({selectedTotalItems})\r\n            </button>\r\n          </div>\r\n        </div>\r\n      )}\r\n      <BottomNavigation />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default CartPage; "],"names":["CartPage","navigate","useNavigate","items","totalItems","totalPrice","selectedTotalItems","selectedTotalPrice","updateQuantity","removeItem","clearCart","toggleItemSelection","toggleAllSelection","getSelectedItems","useCartStore","handleGoBack","handleQuantityChange","itemId","newQuantity","handleRemoveItem","handleProductClick","productId","handleItemSelection","handleSelectAll","handleCheckout","isAllSelected","item","hasSelectedItems","renderCartItem","jsxs","jsx","type","value","StatusBar","BottomNavigation"],"mappings":"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"}