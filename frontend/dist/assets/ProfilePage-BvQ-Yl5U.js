var Nt=Object.defineProperty;var Lt=(Pe,fe,L)=>fe in Pe?Nt(Pe,fe,{enumerable:!0,configurable:!0,writable:!0,value:L}):Pe[fe]=L;var dt=(Pe,fe,L)=>Lt(Pe,typeof fe!="symbol"?fe+"":fe,L);import{g as Ut,e as Mt,r as et,j as G,f as Ft,p as Kt,u as _t,S as Ht,B as zt}from"./index-DWm9dxUp.js";var Ot={exports:{}};(function(Pe,fe){(function(J,B){Pe.exports=B()})(Mt,function(){return function(L){var J={};function B(U){if(J[U])return J[U].exports;var A=J[U]={i:U,l:!1,exports:{}};return L[U].call(A.exports,A,A.exports,B),A.l=!0,A.exports}return B.m=L,B.c=J,B.d=function(U,A,F){B.o(U,A)||Object.defineProperty(U,A,{enumerable:!0,get:F})},B.r=function(U){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(U,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(U,"__esModule",{value:!0})},B.t=function(U,A){if(A&1&&(U=B(U)),A&8||A&4&&typeof U=="object"&&U&&U.__esModule)return U;var F=Object.create(null);if(B.r(F),Object.defineProperty(F,"default",{enumerable:!0,value:U}),A&2&&typeof U!="string")for(var N in U)B.d(F,N,(function(M){return U[M]}).bind(null,N));return F},B.n=function(U){var A=U&&U.__esModule?function(){return U.default}:function(){return U};return B.d(A,"a",A),A},B.o=function(U,A){return Object.prototype.hasOwnProperty.call(U,A)},B.p="/dist/",B(B.s="./index.js")}({"./index.js":function(L,J,B){var U=B("./src/cos.js");L.exports=U},"./lib/base64.js":function(L,J){var B=function(U){U=U||{};var A=U.Base64,F="2.1.9",N="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",M=function(r){for(var a={},y=0,I=r.length;y<I;y++)a[r.charAt(y)]=y;return a}(N),i=String.fromCharCode,p=function(a){if(a.length<2){var y=a.charCodeAt(0);return y<128?a:y<2048?i(192|y>>>6)+i(128|y&63):i(224|y>>>12&15)+i(128|y>>>6&63)+i(128|y&63)}else{var y=65536+(a.charCodeAt(0)-55296)*1024+(a.charCodeAt(1)-56320);return i(240|y>>>18&7)+i(128|y>>>12&63)+i(128|y>>>6&63)+i(128|y&63)}},l=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,C=function(a){return a.replace(l,p)},f=function(a){var y=[0,2,1][a.length%3],I=a.charCodeAt(0)<<16|(a.length>1?a.charCodeAt(1):0)<<8|(a.length>2?a.charCodeAt(2):0),T=[N.charAt(I>>>18),N.charAt(I>>>12&63),y>=2?"=":N.charAt(I>>>6&63),y>=1?"=":N.charAt(I&63)];return T.join("")},k=U.btoa?function(r){return U.btoa(r)}:function(r){return r.replace(/[\s\S]{1,3}/g,f)},S=function(r){return k(C(r))},b=function(a,y){return y?S(String(a)).replace(/[+\/]/g,function(I){return I=="+"?"-":"_"}).replace(/=/g,""):S(String(a))},P=function(a){return b(a,!0)},j=new RegExp(["[À-ß][-¿]","[à-ï][-¿]{2}","[ð-÷][-¿]{3}"].join("|"),"g"),z=function(a){switch(a.length){case 4:var y=(7&a.charCodeAt(0))<<18|(63&a.charCodeAt(1))<<12|(63&a.charCodeAt(2))<<6|63&a.charCodeAt(3),I=y-65536;return i((I>>>10)+55296)+i((I&1023)+56320);case 3:return i((15&a.charCodeAt(0))<<12|(63&a.charCodeAt(1))<<6|63&a.charCodeAt(2));default:return i((31&a.charCodeAt(0))<<6|63&a.charCodeAt(1))}},q=function(a){return a.replace(j,z)},h=function(a){var y=a.length,I=y%4,T=(y>0?M[a.charAt(0)]<<18:0)|(y>1?M[a.charAt(1)]<<12:0)|(y>2?M[a.charAt(2)]<<6:0)|(y>3?M[a.charAt(3)]:0),K=[i(T>>>16),i(T>>>8&255),i(T&255)];return K.length-=[0,0,2,1][I],K.join("")},d=U.atob?function(r){return U.atob(r)}:function(r){return r.replace(/[\s\S]{1,4}/g,h)},m=function(r){return q(d(r))},s=function(a){return m(String(a).replace(/[-_]/g,function(y){return y=="-"?"+":"/"}).replace(/[^A-Za-z0-9\+\/]/g,""))},n=function(){var a=U.Base64;return U.Base64=A,a},t={VERSION:F,atob:d,btoa:k,fromBase64:s,toBase64:b,utob:C,encode:b,encodeURI:P,btou:q,decode:s,noConflict:n};return t}();L.exports=B},"./lib/crypto.js":function(L,J,B){(function(U){var A=B("./node_modules/@babel/runtime/helpers/typeof.js"),F=F||function(N,M){var i={},p=i.lib={},l=function(){},C=p.Base={extend:function(h){l.prototype=this;var d=new l;return h&&d.mixIn(h),d.hasOwnProperty("init")||(d.init=function(){d.$super.init.apply(this,arguments)}),d.init.prototype=d,d.$super=this,d},create:function(){var h=this.extend();return h.init.apply(h,arguments),h},init:function(){},mixIn:function(h){for(var d in h)h.hasOwnProperty(d)&&(this[d]=h[d]);h.hasOwnProperty("toString")&&(this.toString=h.toString)},clone:function(){return this.init.prototype.extend(this)}},f=p.WordArray=C.extend({init:function(h,d){h=this.words=h||[],this.sigBytes=d!=M?d:4*h.length},toString:function(h){return(h||S).stringify(this)},concat:function(h){var d=this.words,m=h.words,s=this.sigBytes;if(h=h.sigBytes,this.clamp(),s%4)for(var n=0;n<h;n++)d[s+n>>>2]|=(m[n>>>2]>>>24-8*(n%4)&255)<<24-8*((s+n)%4);else if(65535<m.length)for(n=0;n<h;n+=4)d[s+n>>>2]=m[n>>>2];else d.push.apply(d,m);return this.sigBytes+=h,this},clamp:function(){var h=this.words,d=this.sigBytes;h[d>>>2]&=4294967295<<32-8*(d%4),h.length=N.ceil(d/4)},clone:function(){var h=C.clone.call(this);return h.words=this.words.slice(0),h},random:function(h){for(var d=[],m=0;m<h;m+=4)d.push(4294967296*N.random()|0);return new f.init(d,h)}}),k=i.enc={},S=k.Hex={stringify:function(h){var d=h.words;h=h.sigBytes;for(var m=[],s=0;s<h;s++){var n=d[s>>>2]>>>24-8*(s%4)&255;m.push((n>>>4).toString(16)),m.push((n&15).toString(16))}return m.join("")},parse:function(h){for(var d=h.length,m=[],s=0;s<d;s+=2)m[s>>>3]|=parseInt(h.substr(s,2),16)<<24-4*(s%8);return new f.init(m,d/2)}},b=k.Latin1={stringify:function(h){var d=h.words;h=h.sigBytes;for(var m=[],s=0;s<h;s++)m.push(String.fromCharCode(d[s>>>2]>>>24-8*(s%4)&255));return m.join("")},parse:function(h){for(var d=h.length,m=[],s=0;s<d;s++)m[s>>>2]|=(h.charCodeAt(s)&255)<<24-8*(s%4);return new f.init(m,d)}},P=k.Utf8={stringify:function(h){try{return decodeURIComponent(escape(b.stringify(h)))}catch{throw Error("Malformed UTF-8 data")}},parse:function(h){return b.parse(unescape(encodeURIComponent(h)))}},j=p.BufferedBlockAlgorithm=C.extend({reset:function(){this._data=new f.init,this._nDataBytes=0},_append:function(h){typeof h=="string"&&(h=P.parse(h)),this._data.concat(h),this._nDataBytes+=h.sigBytes},_process:function(h){var d=this._data,m=d.words,s=d.sigBytes,n=this.blockSize,t=s/(4*n),t=h?N.ceil(t):N.max((t|0)-this._minBufferSize,0);if(h=t*n,s=N.min(4*h,s),h){for(var r=0;r<h;r+=n)this._doProcessBlock(m,r);r=m.splice(0,h),d.sigBytes-=s}return new f.init(r,s)},clone:function(){var h=C.clone.call(this);return h._data=this._data.clone(),h},_minBufferSize:0});p.Hasher=j.extend({cfg:C.extend(),init:function(h){this.cfg=this.cfg.extend(h),this.reset()},reset:function(){j.reset.call(this),this._doReset()},update:function(h){return this._append(h),this._process(),this},finalize:function(h){return h&&this._append(h),this._doFinalize()},blockSize:16,_createHelper:function(h){return function(d,m){return new h.init(m).finalize(d)}},_createHmacHelper:function(h){return function(d,m){return new z.HMAC.init(h,m).finalize(d)}}});var z=i.algo={};return i}(Math);(function(){var N=F,l=N.lib,M=l.WordArray,i=l.Hasher,p=[],l=N.algo.SHA1=i.extend({_doReset:function(){this._hash=new M.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(f,k){for(var S=this._hash.words,b=S[0],P=S[1],j=S[2],z=S[3],q=S[4],h=0;80>h;h++){if(16>h)p[h]=f[k+h]|0;else{var d=p[h-3]^p[h-8]^p[h-14]^p[h-16];p[h]=d<<1|d>>>31}d=(b<<5|b>>>27)+q+p[h],d=20>h?d+((P&j|~P&z)+1518500249):40>h?d+((P^j^z)+1859775393):60>h?d+((P&j|P&z|j&z)-1894007588):d+((P^j^z)-899497514),q=z,z=j,j=P<<30|P>>>2,P=b,b=d}S[0]=S[0]+b|0,S[1]=S[1]+P|0,S[2]=S[2]+j|0,S[3]=S[3]+z|0,S[4]=S[4]+q|0},_doFinalize:function(){var f=this._data,k=f.words,S=8*this._nDataBytes,b=8*f.sigBytes;return k[b>>>5]|=128<<24-b%32,k[(b+64>>>9<<4)+14]=Math.floor(S/4294967296),k[(b+64>>>9<<4)+15]=S,f.sigBytes=4*k.length,this._process(),this._hash},clone:function(){var f=i.clone.call(this);return f._hash=this._hash.clone(),f}});N.SHA1=i._createHelper(l),N.HmacSHA1=i._createHmacHelper(l)})(),function(){var N=F,M=N.enc.Utf8;N.algo.HMAC=N.lib.Base.extend({init:function(p,l){p=this._hasher=new p.init,typeof l=="string"&&(l=M.parse(l));var C=p.blockSize,f=4*C;l.sigBytes>f&&(l=p.finalize(l)),l.clamp();for(var k=this._oKey=l.clone(),S=this._iKey=l.clone(),b=k.words,P=S.words,j=0;j<C;j++)b[j]^=1549556828,P[j]^=909522486;k.sigBytes=S.sigBytes=f,this.reset()},reset:function(){var p=this._hasher;p.reset(),p.update(this._iKey)},update:function(p){return this._hasher.update(p),this},finalize:function(p){var l=this._hasher;return p=l.finalize(p),l.reset(),l.finalize(this._oKey.clone().concat(p))}})}(),function(){var N=F,M=N.lib,i=M.WordArray,p=N.enc;p.Base64={stringify:function(C){var f=C.words,k=C.sigBytes,S=this._map;C.clamp();for(var b=[],P=0;P<k;P+=3)for(var j=f[P>>>2]>>>24-P%4*8&255,z=f[P+1>>>2]>>>24-(P+1)%4*8&255,q=f[P+2>>>2]>>>24-(P+2)%4*8&255,h=j<<16|z<<8|q,d=0;d<4&&P+d*.75<k;d++)b.push(S.charAt(h>>>6*(3-d)&63));var m=S.charAt(64);if(m)for(;b.length%4;)b.push(m);return b.join("")},parse:function(C){var f=C.length,k=this._map,S=k.charAt(64);if(S){var b=C.indexOf(S);b!=-1&&(f=b)}for(var P=[],j=0,z=0;z<f;z++)if(z%4){var q=k.indexOf(C.charAt(z-1))<<z%4*2,h=k.indexOf(C.charAt(z))>>>6-z%4*2;P[j>>>2]|=(q|h)<<24-j%4*8,j++}return i.create(P,j)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),A(U)==="object"?U.exports=F:window.CryptoJS=F}).call(this,B("./node_modules/webpack/buildin/module.js")(L))},"./lib/md5.js":function(L,J,B){(function(U){var A,F=B("./node_modules/@babel/runtime/helpers/typeof.js");(function(){var N=(typeof window>"u"?"undefined":F(window))==="object",M=N?window:{};M.JS_MD5_NO_WINDOW&&(N=!1);var i=!N&&(typeof self>"u"?"undefined":F(self))==="object";i&&(M=self);var p=!M.JS_MD5_NO_COMMON_JS&&F(U)==="object"&&U.exports,l=B("./node_modules/webpack/buildin/amd-options.js"),C=!M.JS_MD5_NO_ARRAY_BUFFER&&typeof ArrayBuffer<"u",f="0123456789abcdef".split(""),k=[128,32768,8388608,-2147483648],S=[0,8,16,24],b=["hex","array","digest","buffer","arrayBuffer","base64"],P="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),j=[],z;if(C){var q=new ArrayBuffer(68);z=new Uint8Array(q),j=new Uint32Array(q)}(M.JS_MD5_NO_NODE_JS||!Array.isArray)&&(Array.isArray=function(n){return Object.prototype.toString.call(n)==="[object Array]"}),C&&(M.JS_MD5_NO_ARRAY_BUFFER_IS_VIEW||!ArrayBuffer.isView)&&(ArrayBuffer.isView=function(n){return F(n)==="object"&&n.buffer&&n.buffer.constructor===ArrayBuffer});var h=function(t){return function(r,a){return new m(!0).update(r,a)[t]()}},d=function(){var t=h("hex");t.getCtx=t.create=function(){return new m},t.update=function(y){return t.create().update(y)};for(var r=0;r<b.length;++r){var a=b[r];t[a]=h(a)}return t};function m(n){if(n)j[0]=j[16]=j[1]=j[2]=j[3]=j[4]=j[5]=j[6]=j[7]=j[8]=j[9]=j[10]=j[11]=j[12]=j[13]=j[14]=j[15]=0,this.blocks=j,this.buffer8=z;else if(C){var t=new ArrayBuffer(68);this.buffer8=new Uint8Array(t),this.blocks=new Uint32Array(t)}else this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.h0=this.h1=this.h2=this.h3=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0}m.prototype.update=function(n,t){if(!this.finalized){for(var r,a=0,y,I=n.length,T=this.blocks,K=this.buffer8;a<I;){if(this.hashed&&(this.hashed=!1,T[0]=T[16],T[16]=T[1]=T[2]=T[3]=T[4]=T[5]=T[6]=T[7]=T[8]=T[9]=T[10]=T[11]=T[12]=T[13]=T[14]=T[15]=0),C)for(y=this.start;a<I&&y<64;++a)r=n.charCodeAt(a),t||r<128?K[y++]=r:r<2048?(K[y++]=192|r>>6,K[y++]=128|r&63):r<55296||r>=57344?(K[y++]=224|r>>12,K[y++]=128|r>>6&63,K[y++]=128|r&63):(r=65536+((r&1023)<<10|n.charCodeAt(++a)&1023),K[y++]=240|r>>18,K[y++]=128|r>>12&63,K[y++]=128|r>>6&63,K[y++]=128|r&63);else for(y=this.start;a<I&&y<64;++a)r=n.charCodeAt(a),t||r<128?T[y>>2]|=r<<S[y++&3]:r<2048?(T[y>>2]|=(192|r>>6)<<S[y++&3],T[y>>2]|=(128|r&63)<<S[y++&3]):r<55296||r>=57344?(T[y>>2]|=(224|r>>12)<<S[y++&3],T[y>>2]|=(128|r>>6&63)<<S[y++&3],T[y>>2]|=(128|r&63)<<S[y++&3]):(r=65536+((r&1023)<<10|n.charCodeAt(++a)&1023),T[y>>2]|=(240|r>>18)<<S[y++&3],T[y>>2]|=(128|r>>12&63)<<S[y++&3],T[y>>2]|=(128|r>>6&63)<<S[y++&3],T[y>>2]|=(128|r&63)<<S[y++&3]);this.lastByteIndex=y,this.bytes+=y-this.start,y>=64?(this.start=y-64,this.hash(),this.hashed=!0):this.start=y}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},m.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var n=this.blocks,t=this.lastByteIndex;n[t>>2]|=k[t&3],t>=56&&(this.hashed||this.hash(),n[0]=n[16],n[16]=n[1]=n[2]=n[3]=n[4]=n[5]=n[6]=n[7]=n[8]=n[9]=n[10]=n[11]=n[12]=n[13]=n[14]=n[15]=0),n[14]=this.bytes<<3,n[15]=this.hBytes<<3|this.bytes>>>29,this.hash()}},m.prototype.hash=function(){var n,t,r,a,y,I,T=this.blocks;this.first?(n=T[0]-680876937,n=(n<<7|n>>>25)-271733879<<0,a=(-1732584194^n&2004318071)+T[1]-117830708,a=(a<<12|a>>>20)+n<<0,r=(-271733879^a&(n^-271733879))+T[2]-1126478375,r=(r<<17|r>>>15)+a<<0,t=(n^r&(a^n))+T[3]-1316259209,t=(t<<22|t>>>10)+r<<0):(n=this.h0,t=this.h1,r=this.h2,a=this.h3,n+=(a^t&(r^a))+T[0]-680876936,n=(n<<7|n>>>25)+t<<0,a+=(r^n&(t^r))+T[1]-389564586,a=(a<<12|a>>>20)+n<<0,r+=(t^a&(n^t))+T[2]+606105819,r=(r<<17|r>>>15)+a<<0,t+=(n^r&(a^n))+T[3]-1044525330,t=(t<<22|t>>>10)+r<<0),n+=(a^t&(r^a))+T[4]-176418897,n=(n<<7|n>>>25)+t<<0,a+=(r^n&(t^r))+T[5]+1200080426,a=(a<<12|a>>>20)+n<<0,r+=(t^a&(n^t))+T[6]-1473231341,r=(r<<17|r>>>15)+a<<0,t+=(n^r&(a^n))+T[7]-45705983,t=(t<<22|t>>>10)+r<<0,n+=(a^t&(r^a))+T[8]+1770035416,n=(n<<7|n>>>25)+t<<0,a+=(r^n&(t^r))+T[9]-1958414417,a=(a<<12|a>>>20)+n<<0,r+=(t^a&(n^t))+T[10]-42063,r=(r<<17|r>>>15)+a<<0,t+=(n^r&(a^n))+T[11]-1990404162,t=(t<<22|t>>>10)+r<<0,n+=(a^t&(r^a))+T[12]+1804603682,n=(n<<7|n>>>25)+t<<0,a+=(r^n&(t^r))+T[13]-40341101,a=(a<<12|a>>>20)+n<<0,r+=(t^a&(n^t))+T[14]-1502002290,r=(r<<17|r>>>15)+a<<0,t+=(n^r&(a^n))+T[15]+1236535329,t=(t<<22|t>>>10)+r<<0,n+=(r^a&(t^r))+T[1]-165796510,n=(n<<5|n>>>27)+t<<0,a+=(t^r&(n^t))+T[6]-1069501632,a=(a<<9|a>>>23)+n<<0,r+=(n^t&(a^n))+T[11]+643717713,r=(r<<14|r>>>18)+a<<0,t+=(a^n&(r^a))+T[0]-373897302,t=(t<<20|t>>>12)+r<<0,n+=(r^a&(t^r))+T[5]-701558691,n=(n<<5|n>>>27)+t<<0,a+=(t^r&(n^t))+T[10]+38016083,a=(a<<9|a>>>23)+n<<0,r+=(n^t&(a^n))+T[15]-660478335,r=(r<<14|r>>>18)+a<<0,t+=(a^n&(r^a))+T[4]-405537848,t=(t<<20|t>>>12)+r<<0,n+=(r^a&(t^r))+T[9]+568446438,n=(n<<5|n>>>27)+t<<0,a+=(t^r&(n^t))+T[14]-1019803690,a=(a<<9|a>>>23)+n<<0,r+=(n^t&(a^n))+T[3]-187363961,r=(r<<14|r>>>18)+a<<0,t+=(a^n&(r^a))+T[8]+1163531501,t=(t<<20|t>>>12)+r<<0,n+=(r^a&(t^r))+T[13]-1444681467,n=(n<<5|n>>>27)+t<<0,a+=(t^r&(n^t))+T[2]-51403784,a=(a<<9|a>>>23)+n<<0,r+=(n^t&(a^n))+T[7]+1735328473,r=(r<<14|r>>>18)+a<<0,t+=(a^n&(r^a))+T[12]-1926607734,t=(t<<20|t>>>12)+r<<0,y=t^r,n+=(y^a)+T[5]-378558,n=(n<<4|n>>>28)+t<<0,a+=(y^n)+T[8]-2022574463,a=(a<<11|a>>>21)+n<<0,I=a^n,r+=(I^t)+T[11]+1839030562,r=(r<<16|r>>>16)+a<<0,t+=(I^r)+T[14]-35309556,t=(t<<23|t>>>9)+r<<0,y=t^r,n+=(y^a)+T[1]-1530992060,n=(n<<4|n>>>28)+t<<0,a+=(y^n)+T[4]+1272893353,a=(a<<11|a>>>21)+n<<0,I=a^n,r+=(I^t)+T[7]-155497632,r=(r<<16|r>>>16)+a<<0,t+=(I^r)+T[10]-1094730640,t=(t<<23|t>>>9)+r<<0,y=t^r,n+=(y^a)+T[13]+681279174,n=(n<<4|n>>>28)+t<<0,a+=(y^n)+T[0]-358537222,a=(a<<11|a>>>21)+n<<0,I=a^n,r+=(I^t)+T[3]-722521979,r=(r<<16|r>>>16)+a<<0,t+=(I^r)+T[6]+76029189,t=(t<<23|t>>>9)+r<<0,y=t^r,n+=(y^a)+T[9]-640364487,n=(n<<4|n>>>28)+t<<0,a+=(y^n)+T[12]-421815835,a=(a<<11|a>>>21)+n<<0,I=a^n,r+=(I^t)+T[15]+530742520,r=(r<<16|r>>>16)+a<<0,t+=(I^r)+T[2]-995338651,t=(t<<23|t>>>9)+r<<0,n+=(r^(t|~a))+T[0]-198630844,n=(n<<6|n>>>26)+t<<0,a+=(t^(n|~r))+T[7]+1126891415,a=(a<<10|a>>>22)+n<<0,r+=(n^(a|~t))+T[14]-1416354905,r=(r<<15|r>>>17)+a<<0,t+=(a^(r|~n))+T[5]-57434055,t=(t<<21|t>>>11)+r<<0,n+=(r^(t|~a))+T[12]+1700485571,n=(n<<6|n>>>26)+t<<0,a+=(t^(n|~r))+T[3]-1894986606,a=(a<<10|a>>>22)+n<<0,r+=(n^(a|~t))+T[10]-1051523,r=(r<<15|r>>>17)+a<<0,t+=(a^(r|~n))+T[1]-2054922799,t=(t<<21|t>>>11)+r<<0,n+=(r^(t|~a))+T[8]+1873313359,n=(n<<6|n>>>26)+t<<0,a+=(t^(n|~r))+T[15]-30611744,a=(a<<10|a>>>22)+n<<0,r+=(n^(a|~t))+T[6]-1560198380,r=(r<<15|r>>>17)+a<<0,t+=(a^(r|~n))+T[13]+1309151649,t=(t<<21|t>>>11)+r<<0,n+=(r^(t|~a))+T[4]-145523070,n=(n<<6|n>>>26)+t<<0,a+=(t^(n|~r))+T[11]-1120210379,a=(a<<10|a>>>22)+n<<0,r+=(n^(a|~t))+T[2]+718787259,r=(r<<15|r>>>17)+a<<0,t+=(a^(r|~n))+T[9]-343485551,t=(t<<21|t>>>11)+r<<0,this.first?(this.h0=n+1732584193<<0,this.h1=t-271733879<<0,this.h2=r-1732584194<<0,this.h3=a+271733878<<0,this.first=!1):(this.h0=this.h0+n<<0,this.h1=this.h1+t<<0,this.h2=this.h2+r<<0,this.h3=this.h3+a<<0)},m.prototype.hex=function(){this.finalize();var n=this.h0,t=this.h1,r=this.h2,a=this.h3;return f[n>>4&15]+f[n&15]+f[n>>12&15]+f[n>>8&15]+f[n>>20&15]+f[n>>16&15]+f[n>>28&15]+f[n>>24&15]+f[t>>4&15]+f[t&15]+f[t>>12&15]+f[t>>8&15]+f[t>>20&15]+f[t>>16&15]+f[t>>28&15]+f[t>>24&15]+f[r>>4&15]+f[r&15]+f[r>>12&15]+f[r>>8&15]+f[r>>20&15]+f[r>>16&15]+f[r>>28&15]+f[r>>24&15]+f[a>>4&15]+f[a&15]+f[a>>12&15]+f[a>>8&15]+f[a>>20&15]+f[a>>16&15]+f[a>>28&15]+f[a>>24&15]},m.prototype.toString=m.prototype.hex,m.prototype.digest=function(n){if(n==="hex")return this.hex();this.finalize();var t=this.h0,r=this.h1,a=this.h2,y=this.h3,I=[t&255,t>>8&255,t>>16&255,t>>24&255,r&255,r>>8&255,r>>16&255,r>>24&255,a&255,a>>8&255,a>>16&255,a>>24&255,y&255,y>>8&255,y>>16&255,y>>24&255];return I},m.prototype.array=m.prototype.digest,m.prototype.arrayBuffer=function(){this.finalize();var n=new ArrayBuffer(16),t=new Uint32Array(n);return t[0]=this.h0,t[1]=this.h1,t[2]=this.h2,t[3]=this.h3,n},m.prototype.buffer=m.prototype.arrayBuffer,m.prototype.base64=function(){for(var n,t,r,a="",y=this.array(),I=0;I<15;)n=y[I++],t=y[I++],r=y[I++],a+=P[n>>>2]+P[(n<<4|t>>>4)&63]+P[(t<<2|r>>>6)&63]+P[r&63];return n=y[I],a+=P[n>>>2]+P[n<<4&63]+"==",a};var s=d();p?U.exports=s:(M.md5=s,l&&(A=(function(){return s}).call(s,B,s,U),A!==void 0&&(U.exports=A)))})()}).call(this,B("./node_modules/webpack/buildin/module.js")(L))},"./lib/request.js":function(L,J,B){var U=B("./node_modules/@babel/runtime/helpers/typeof.js"),A=function(l){switch(U(l)){case"string":return l;case"boolean":return l?"true":"false";case"number":return isFinite(l)?l:"";default:return""}},F=function(l,C,f,k){return C=C||"&",f=f||"=",l===null&&(l=void 0),U(l)==="object"?Object.keys(l).map(function(S){var b=encodeURIComponent(A(S))+f;return Array.isArray(l[S])?l[S].map(function(P){return b+encodeURIComponent(A(P))}).join(C):b+encodeURIComponent(A(l[S]))}).filter(Boolean).join(C):""},N=function(l,C,f){var k={},S=C.getAllResponseHeaders();return S&&S.length>0&&S.trim().split(`
`).forEach(function(b){if(b){var P=b.indexOf(":"),j=b.substr(0,P).trim().toLowerCase(),z=b.substr(P+1).trim();k[j]=z}}),{error:l,statusCode:C.status,statusMessage:C.statusText,headers:k,body:f}},M=function(l,C){return!C&&C==="text"?l.responseText:l.response},i=function(l,C){var f=(l.method||"GET").toUpperCase(),k=l.url;if(l.qs){var S=F(l.qs);S&&(k+=(k.indexOf("?")===-1?"?":"&")+S)}var b=new XMLHttpRequest;if(b.open(f,k,!0),b.responseType=l.dataType||"text",l.xhrFields)for(var P in l.xhrFields)b[P]=l.xhrFields[P];var j=l.headers;if(j)for(var z in j)j.hasOwnProperty(z)&&z.toLowerCase()!=="content-length"&&z.toLowerCase()!=="user-agent"&&z.toLowerCase()!=="origin"&&z.toLowerCase()!=="host"&&b.setRequestHeader(z,j[z]);return l.onProgress&&b.upload&&(b.upload.onprogress=l.onProgress),l.onDownloadProgress&&(b.onprogress=l.onDownloadProgress),l.timeout&&(b.timeout=l.timeout),b.ontimeout=function(q){var h=new Error("timeout");C(N(h,b))},b.onload=function(){C(N(null,b,M(b,l.dataType)))},b.onerror=function(q){var h=M(b,l.dataType);if(h)C(N(null,b,h));else{var d=b.statusText;!d&&b.status===0&&(d=new Error("CORS blocked or network error")),C(N(d,b,h))}},b.send(l.body||""),b};L.exports=i},"./node_modules/@babel/runtime/helpers/classCallCheck.js":function(L,J){function B(U,A){if(!(U instanceof A))throw new TypeError("Cannot call a class as a function")}L.exports=B,L.exports.__esModule=!0,L.exports.default=L.exports},"./node_modules/@babel/runtime/helpers/createClass.js":function(L,J,B){var U=B("./node_modules/@babel/runtime/helpers/toPropertyKey.js");function A(N,M){for(var i=0;i<M.length;i++){var p=M[i];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(N,U(p.key),p)}}function F(N,M,i){return M&&A(N.prototype,M),i&&A(N,i),Object.defineProperty(N,"prototype",{writable:!1}),N}L.exports=F,L.exports.__esModule=!0,L.exports.default=L.exports},"./node_modules/@babel/runtime/helpers/defineProperty.js":function(L,J,B){var U=B("./node_modules/@babel/runtime/helpers/toPropertyKey.js");function A(F,N,M){return(N=U(N))in F?Object.defineProperty(F,N,{value:M,enumerable:!0,configurable:!0,writable:!0}):F[N]=M,F}L.exports=A,L.exports.__esModule=!0,L.exports.default=L.exports},"./node_modules/@babel/runtime/helpers/toPrimitive.js":function(L,J,B){var U=B("./node_modules/@babel/runtime/helpers/typeof.js").default;function A(F,N){if(U(F)!="object"||!F)return F;var M=F[Symbol.toPrimitive];if(M!==void 0){var i=M.call(F,N||"default");if(U(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(N==="string"?String:Number)(F)}L.exports=A,L.exports.__esModule=!0,L.exports.default=L.exports},"./node_modules/@babel/runtime/helpers/toPropertyKey.js":function(L,J,B){var U=B("./node_modules/@babel/runtime/helpers/typeof.js").default,A=B("./node_modules/@babel/runtime/helpers/toPrimitive.js");function F(N){var M=A(N,"string");return U(M)=="symbol"?M:M+""}L.exports=F,L.exports.__esModule=!0,L.exports.default=L.exports},"./node_modules/@babel/runtime/helpers/typeof.js":function(L,J){function B(U){"@babel/helpers - typeof";return L.exports=B=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(A){return typeof A}:function(A){return A&&typeof Symbol=="function"&&A.constructor===Symbol&&A!==Symbol.prototype?"symbol":typeof A},L.exports.__esModule=!0,L.exports.default=L.exports,B(U)}L.exports=B,L.exports.__esModule=!0,L.exports.default=L.exports},"./node_modules/fast-xml-parser/src/fxp.js":function(L,J,B){const U=B("./node_modules/fast-xml-parser/src/validator.js"),A=B("./node_modules/fast-xml-parser/src/xmlparser/XMLParser.js"),F=B("./node_modules/fast-xml-parser/src/xmlbuilder/json2xml.js");L.exports={XMLParser:A,XMLValidator:U,XMLBuilder:F}},"./node_modules/fast-xml-parser/src/ignoreAttributes.js":function(L,J){function B(U){return typeof U=="function"?U:Array.isArray(U)?A=>{for(const F of U)if(typeof F=="string"&&A===F||F instanceof RegExp&&F.test(A))return!0}:()=>!1}L.exports=B},"./node_modules/fast-xml-parser/src/util.js":function(L,J,B){const U=":A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",A=U+"\\-.\\d\\u00B7\\u0300-\\u036F\\u203F-\\u2040",F="["+U+"]["+A+"]*",N=new RegExp("^"+F+"$"),M=function(p,l){const C=[];let f=l.exec(p);for(;f;){const k=[];k.startIndex=l.lastIndex-f[0].length;const S=f.length;for(let b=0;b<S;b++)k.push(f[b]);C.push(k),f=l.exec(p)}return C},i=function(p){const l=N.exec(p);return!(l===null||typeof l>"u")};J.isExist=function(p){return typeof p<"u"},J.isEmptyObject=function(p){return Object.keys(p).length===0},J.merge=function(p,l,C){if(l){const f=Object.keys(l),k=f.length;for(let S=0;S<k;S++)C==="strict"?p[f[S]]=[l[f[S]]]:p[f[S]]=l[f[S]]}},J.getValue=function(p){return J.isExist(p)?p:""},J.isName=i,J.getAllMatches=M,J.nameRegexp=F},"./node_modules/fast-xml-parser/src/validator.js":function(L,J,B){const U=B("./node_modules/fast-xml-parser/src/util.js"),A={allowBooleanAttributes:!1,unpairedTags:[]};J.validate=function(h,d){d=Object.assign({},A,d);const m=[];let s=!1,n=!1;h[0]==="\uFEFF"&&(h=h.substr(1));for(let t=0;t<h.length;t++)if(h[t]==="<"&&h[t+1]==="?"){if(t+=2,t=N(h,t),t.err)return t}else if(h[t]==="<"){let r=t;if(t++,h[t]==="!"){t=M(h,t);continue}else{let a=!1;h[t]==="/"&&(a=!0,t++);let y="";for(;t<h.length&&h[t]!==">"&&h[t]!==" "&&h[t]!=="	"&&h[t]!==`
`&&h[t]!=="\r";t++)y+=h[t];if(y=y.trim(),y[y.length-1]==="/"&&(y=y.substring(0,y.length-1),t--),!j(y)){let K;return y.trim().length===0?K="Invalid space after '<'.":K="Tag '"+y+"' is an invalid name.",b("InvalidTag",K,z(h,t))}const I=l(h,t);if(I===!1)return b("InvalidAttr","Attributes for '"+y+"' have open quote.",z(h,t));let T=I.value;if(t=I.index,T[T.length-1]==="/"){const K=t-T.length;T=T.substring(0,T.length-1);const _=f(T,d);if(_===!0)s=!0;else return b(_.err.code,_.err.msg,z(h,K+_.err.line))}else if(a)if(I.tagClosed){if(T.trim().length>0)return b("InvalidTag","Closing tag '"+y+"' can't have attributes or invalid starting.",z(h,r));if(m.length===0)return b("InvalidTag","Closing tag '"+y+"' has not been opened.",z(h,r));{const K=m.pop();if(y!==K.tagName){let _=z(h,K.tagStartPos);return b("InvalidTag","Expected closing tag '"+K.tagName+"' (opened in line "+_.line+", col "+_.col+") instead of closing tag '"+y+"'.",z(h,r))}m.length==0&&(n=!0)}}else return b("InvalidTag","Closing tag '"+y+"' doesn't have proper closing.",z(h,t));else{const K=f(T,d);if(K!==!0)return b(K.err.code,K.err.msg,z(h,t-T.length+K.err.line));if(n===!0)return b("InvalidXml","Multiple possible root nodes found.",z(h,t));d.unpairedTags.indexOf(y)!==-1||m.push({tagName:y,tagStartPos:r}),s=!0}for(t++;t<h.length;t++)if(h[t]==="<")if(h[t+1]==="!"){t++,t=M(h,t);continue}else if(h[t+1]==="?"){if(t=N(h,++t),t.err)return t}else break;else if(h[t]==="&"){const K=S(h,t);if(K==-1)return b("InvalidChar","char '&' is not expected.",z(h,t));t=K}else if(n===!0&&!F(h[t]))return b("InvalidXml","Extra text at the end",z(h,t));h[t]==="<"&&t--}}else{if(F(h[t]))continue;return b("InvalidChar","char '"+h[t]+"' is not expected.",z(h,t))}if(s){if(m.length==1)return b("InvalidTag","Unclosed tag '"+m[0].tagName+"'.",z(h,m[0].tagStartPos));if(m.length>0)return b("InvalidXml","Invalid '"+JSON.stringify(m.map(t=>t.tagName),null,4).replace(/\r?\n/g,"")+"' found.",{line:1,col:1})}else return b("InvalidXml","Start tag expected.",1);return!0};function F(h){return h===" "||h==="	"||h===`
`||h==="\r"}function N(h,d){const m=d;for(;d<h.length;d++)if(h[d]=="?"||h[d]==" "){const s=h.substr(m,d-m);if(d>5&&s==="xml")return b("InvalidXml","XML declaration allowed only at the start of the document.",z(h,d));if(h[d]=="?"&&h[d+1]==">"){d++;break}else continue}return d}function M(h,d){if(h.length>d+5&&h[d+1]==="-"&&h[d+2]==="-"){for(d+=3;d<h.length;d++)if(h[d]==="-"&&h[d+1]==="-"&&h[d+2]===">"){d+=2;break}}else if(h.length>d+8&&h[d+1]==="D"&&h[d+2]==="O"&&h[d+3]==="C"&&h[d+4]==="T"&&h[d+5]==="Y"&&h[d+6]==="P"&&h[d+7]==="E"){let m=1;for(d+=8;d<h.length;d++)if(h[d]==="<")m++;else if(h[d]===">"&&(m--,m===0))break}else if(h.length>d+9&&h[d+1]==="["&&h[d+2]==="C"&&h[d+3]==="D"&&h[d+4]==="A"&&h[d+5]==="T"&&h[d+6]==="A"&&h[d+7]==="["){for(d+=8;d<h.length;d++)if(h[d]==="]"&&h[d+1]==="]"&&h[d+2]===">"){d+=2;break}}return d}const i='"',p="'";function l(h,d){let m="",s="",n=!1;for(;d<h.length;d++){if(h[d]===i||h[d]===p)s===""?s=h[d]:s!==h[d]||(s="");else if(h[d]===">"&&s===""){n=!0;break}m+=h[d]}return s!==""?!1:{value:m,index:d,tagClosed:n}}const C=new RegExp(`(\\s*)([^\\s=]+)(\\s*=)?(\\s*(['"])(([\\s\\S])*?)\\5)?`,"g");function f(h,d){const m=U.getAllMatches(h,C),s={};for(let n=0;n<m.length;n++){if(m[n][1].length===0)return b("InvalidAttr","Attribute '"+m[n][2]+"' has no space in starting.",q(m[n]));if(m[n][3]!==void 0&&m[n][4]===void 0)return b("InvalidAttr","Attribute '"+m[n][2]+"' is without value.",q(m[n]));if(m[n][3]===void 0&&!d.allowBooleanAttributes)return b("InvalidAttr","boolean attribute '"+m[n][2]+"' is not allowed.",q(m[n]));const t=m[n][2];if(!P(t))return b("InvalidAttr","Attribute '"+t+"' is an invalid name.",q(m[n]));if(!s.hasOwnProperty(t))s[t]=1;else return b("InvalidAttr","Attribute '"+t+"' is repeated.",q(m[n]))}return!0}function k(h,d){let m=/\d/;for(h[d]==="x"&&(d++,m=/[\da-fA-F]/);d<h.length;d++){if(h[d]===";")return d;if(!h[d].match(m))break}return-1}function S(h,d){if(d++,h[d]===";")return-1;if(h[d]==="#")return d++,k(h,d);let m=0;for(;d<h.length;d++,m++)if(!(h[d].match(/\w/)&&m<20)){if(h[d]===";")break;return-1}return d}function b(h,d,m){return{err:{code:h,msg:d,line:m.line||m,col:m.col}}}function P(h){return U.isName(h)}function j(h){return U.isName(h)}function z(h,d){const m=h.substring(0,d).split(/\r?\n/);return{line:m.length,col:m[m.length-1].length+1}}function q(h){return h.startIndex+h[1].length}},"./node_modules/fast-xml-parser/src/xmlbuilder/json2xml.js":function(L,J,B){const U=B("./node_modules/fast-xml-parser/src/xmlbuilder/orderedJs2Xml.js"),A=B("./node_modules/fast-xml-parser/src/ignoreAttributes.js"),F={attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,cdataPropName:!1,format:!1,indentBy:"  ",suppressEmptyNode:!1,suppressUnpairedNode:!0,suppressBooleanAttributes:!0,tagValueProcessor:function(l,C){return C},attributeValueProcessor:function(l,C){return C},preserveOrder:!1,commentPropName:!1,unpairedTags:[],entities:[{regex:new RegExp("&","g"),val:"&amp;"},{regex:new RegExp(">","g"),val:"&gt;"},{regex:new RegExp("<","g"),val:"&lt;"},{regex:new RegExp("'","g"),val:"&apos;"},{regex:new RegExp('"',"g"),val:"&quot;"}],processEntities:!0,stopNodes:[],oneListGroup:!1};function N(l){this.options=Object.assign({},F,l),this.options.ignoreAttributes===!0||this.options.attributesGroupName?this.isAttribute=function(){return!1}:(this.ignoreAttributesFn=A(this.options.ignoreAttributes),this.attrPrefixLen=this.options.attributeNamePrefix.length,this.isAttribute=p),this.processTextOrObjNode=M,this.options.format?(this.indentate=i,this.tagEndChar=`>
`,this.newLine=`
`):(this.indentate=function(){return""},this.tagEndChar=">",this.newLine="")}N.prototype.build=function(l){return this.options.preserveOrder?U(l,this.options):(Array.isArray(l)&&this.options.arrayNodeName&&this.options.arrayNodeName.length>1&&(l={[this.options.arrayNodeName]:l}),this.j2x(l,0,[]).val)},N.prototype.j2x=function(l,C,f){let k="",S="";const b=f.join(".");for(let P in l)if(Object.prototype.hasOwnProperty.call(l,P))if(typeof l[P]>"u")this.isAttribute(P)&&(S+="");else if(l[P]===null)this.isAttribute(P)?S+="":P[0]==="?"?S+=this.indentate(C)+"<"+P+"?"+this.tagEndChar:S+=this.indentate(C)+"<"+P+"/"+this.tagEndChar;else if(l[P]instanceof Date)S+=this.buildTextValNode(l[P],P,"",C);else if(typeof l[P]!="object"){const j=this.isAttribute(P);if(j&&!this.ignoreAttributesFn(j,b))k+=this.buildAttrPairStr(j,""+l[P]);else if(!j)if(P===this.options.textNodeName){let z=this.options.tagValueProcessor(P,""+l[P]);S+=this.replaceEntitiesValue(z)}else S+=this.buildTextValNode(l[P],P,"",C)}else if(Array.isArray(l[P])){const j=l[P].length;let z="",q="";for(let h=0;h<j;h++){const d=l[P][h];if(!(typeof d>"u"))if(d===null)P[0]==="?"?S+=this.indentate(C)+"<"+P+"?"+this.tagEndChar:S+=this.indentate(C)+"<"+P+"/"+this.tagEndChar;else if(typeof d=="object")if(this.options.oneListGroup){const m=this.j2x(d,C+1,f.concat(P));z+=m.val,this.options.attributesGroupName&&d.hasOwnProperty(this.options.attributesGroupName)&&(q+=m.attrStr)}else z+=this.processTextOrObjNode(d,P,C,f);else if(this.options.oneListGroup){let m=this.options.tagValueProcessor(P,d);m=this.replaceEntitiesValue(m),z+=m}else z+=this.buildTextValNode(d,P,"",C)}this.options.oneListGroup&&(z=this.buildObjectNode(z,P,q,C)),S+=z}else if(this.options.attributesGroupName&&P===this.options.attributesGroupName){const j=Object.keys(l[P]),z=j.length;for(let q=0;q<z;q++)k+=this.buildAttrPairStr(j[q],""+l[P][j[q]])}else S+=this.processTextOrObjNode(l[P],P,C,f);return{attrStr:k,val:S}},N.prototype.buildAttrPairStr=function(l,C){return C=this.options.attributeValueProcessor(l,""+C),C=this.replaceEntitiesValue(C),this.options.suppressBooleanAttributes&&C==="true"?" "+l:" "+l+'="'+C+'"'};function M(l,C,f,k){const S=this.j2x(l,f+1,k.concat(C));return l[this.options.textNodeName]!==void 0&&Object.keys(l).length===1?this.buildTextValNode(l[this.options.textNodeName],C,S.attrStr,f):this.buildObjectNode(S.val,C,S.attrStr,f)}N.prototype.buildObjectNode=function(l,C,f,k){if(l==="")return C[0]==="?"?this.indentate(k)+"<"+C+f+"?"+this.tagEndChar:this.indentate(k)+"<"+C+f+this.closeTag(C)+this.tagEndChar;{let S="</"+C+this.tagEndChar,b="";return C[0]==="?"&&(b="?",S=""),(f||f==="")&&l.indexOf("<")===-1?this.indentate(k)+"<"+C+f+b+">"+l+S:this.options.commentPropName!==!1&&C===this.options.commentPropName&&b.length===0?this.indentate(k)+`<!--${l}-->`+this.newLine:this.indentate(k)+"<"+C+f+b+this.tagEndChar+l+this.indentate(k)+S}},N.prototype.closeTag=function(l){let C="";return this.options.unpairedTags.indexOf(l)!==-1?this.options.suppressUnpairedNode||(C="/"):this.options.suppressEmptyNode?C="/":C=`></${l}`,C},N.prototype.buildTextValNode=function(l,C,f,k){if(this.options.cdataPropName!==!1&&C===this.options.cdataPropName)return this.indentate(k)+`<![CDATA[${l}]]>`+this.newLine;if(this.options.commentPropName!==!1&&C===this.options.commentPropName)return this.indentate(k)+`<!--${l}-->`+this.newLine;if(C[0]==="?")return this.indentate(k)+"<"+C+f+"?"+this.tagEndChar;{let S=this.options.tagValueProcessor(C,l);return S=this.replaceEntitiesValue(S),S===""?this.indentate(k)+"<"+C+f+this.closeTag(C)+this.tagEndChar:this.indentate(k)+"<"+C+f+">"+S+"</"+C+this.tagEndChar}},N.prototype.replaceEntitiesValue=function(l){if(l&&l.length>0&&this.options.processEntities)for(let C=0;C<this.options.entities.length;C++){const f=this.options.entities[C];l=l.replace(f.regex,f.val)}return l};function i(l){return this.options.indentBy.repeat(l)}function p(l){return l.startsWith(this.options.attributeNamePrefix)&&l!==this.options.textNodeName?l.substr(this.attrPrefixLen):!1}L.exports=N},"./node_modules/fast-xml-parser/src/xmlbuilder/orderedJs2Xml.js":function(L,J){const B=`
`;function U(p,l){let C="";return l.format&&l.indentBy.length>0&&(C=B),A(p,l,"",C)}function A(p,l,C,f){let k="",S=!1;for(let b=0;b<p.length;b++){const P=p[b],j=F(P);if(j===void 0)continue;let z="";if(C.length===0?z=j:z=`${C}.${j}`,j===l.textNodeName){let s=P[j];M(z,l)||(s=l.tagValueProcessor(j,s),s=i(s,l)),S&&(k+=f),k+=s,S=!1;continue}else if(j===l.cdataPropName){S&&(k+=f),k+=`<![CDATA[${P[j][0][l.textNodeName]}]]>`,S=!1;continue}else if(j===l.commentPropName){k+=f+`<!--${P[j][0][l.textNodeName]}-->`,S=!0;continue}else if(j[0]==="?"){const s=N(P[":@"],l),n=j==="?xml"?"":f;let t=P[j][0][l.textNodeName];t=t.length!==0?" "+t:"",k+=n+`<${j}${t}${s}?>`,S=!0;continue}let q=f;q!==""&&(q+=l.indentBy);const h=N(P[":@"],l),d=f+`<${j}${h}`,m=A(P[j],l,z,q);l.unpairedTags.indexOf(j)!==-1?l.suppressUnpairedNode?k+=d+">":k+=d+"/>":(!m||m.length===0)&&l.suppressEmptyNode?k+=d+"/>":m&&m.endsWith(">")?k+=d+`>${m}${f}</${j}>`:(k+=d+">",m&&f!==""&&(m.includes("/>")||m.includes("</"))?k+=f+l.indentBy+m+f:k+=m,k+=`</${j}>`),S=!0}return k}function F(p){const l=Object.keys(p);for(let C=0;C<l.length;C++){const f=l[C];if(p.hasOwnProperty(f)&&f!==":@")return f}}function N(p,l){let C="";if(p&&!l.ignoreAttributes)for(let f in p){if(!p.hasOwnProperty(f))continue;let k=l.attributeValueProcessor(f,p[f]);k=i(k,l),k===!0&&l.suppressBooleanAttributes?C+=` ${f.substr(l.attributeNamePrefix.length)}`:C+=` ${f.substr(l.attributeNamePrefix.length)}="${k}"`}return C}function M(p,l){p=p.substr(0,p.length-l.textNodeName.length-1);let C=p.substr(p.lastIndexOf(".")+1);for(let f in l.stopNodes)if(l.stopNodes[f]===p||l.stopNodes[f]==="*."+C)return!0;return!1}function i(p,l){if(p&&p.length>0&&l.processEntities)for(let C=0;C<l.entities.length;C++){const f=l.entities[C];p=p.replace(f.regex,f.val)}return p}L.exports=U},"./node_modules/fast-xml-parser/src/xmlparser/DocTypeReader.js":function(L,J,B){const U=B("./node_modules/fast-xml-parser/src/util.js");function A(f,k){const S={};if(f[k+3]==="O"&&f[k+4]==="C"&&f[k+5]==="T"&&f[k+6]==="Y"&&f[k+7]==="P"&&f[k+8]==="E"){k=k+9;let b=1,P=!1,j=!1,z="";for(;k<f.length;k++)if(f[k]==="<"&&!j){if(P&&M(f,k))k+=7,[entityName,val,k]=F(f,k+1),val.indexOf("&")===-1&&(S[C(entityName)]={regx:RegExp(`&${entityName};`,"g"),val});else if(P&&i(f,k))k+=8;else if(P&&p(f,k))k+=8;else if(P&&l(f,k))k+=9;else if(N)j=!0;else throw new Error("Invalid DOCTYPE");b++,z=""}else if(f[k]===">"){if(j?f[k-1]==="-"&&f[k-2]==="-"&&(j=!1,b--):b--,b===0)break}else f[k]==="["?P=!0:z+=f[k];if(b!==0)throw new Error("Unclosed DOCTYPE")}else throw new Error("Invalid Tag instead of DOCTYPE");return{entities:S,i:k}}function F(f,k){let S="";for(;k<f.length&&f[k]!=="'"&&f[k]!=='"';k++)S+=f[k];if(S=S.trim(),S.indexOf(" ")!==-1)throw new Error("External entites are not supported");const b=f[k++];let P="";for(;k<f.length&&f[k]!==b;k++)P+=f[k];return[S,P,k]}function N(f,k){return f[k+1]==="!"&&f[k+2]==="-"&&f[k+3]==="-"}function M(f,k){return f[k+1]==="!"&&f[k+2]==="E"&&f[k+3]==="N"&&f[k+4]==="T"&&f[k+5]==="I"&&f[k+6]==="T"&&f[k+7]==="Y"}function i(f,k){return f[k+1]==="!"&&f[k+2]==="E"&&f[k+3]==="L"&&f[k+4]==="E"&&f[k+5]==="M"&&f[k+6]==="E"&&f[k+7]==="N"&&f[k+8]==="T"}function p(f,k){return f[k+1]==="!"&&f[k+2]==="A"&&f[k+3]==="T"&&f[k+4]==="T"&&f[k+5]==="L"&&f[k+6]==="I"&&f[k+7]==="S"&&f[k+8]==="T"}function l(f,k){return f[k+1]==="!"&&f[k+2]==="N"&&f[k+3]==="O"&&f[k+4]==="T"&&f[k+5]==="A"&&f[k+6]==="T"&&f[k+7]==="I"&&f[k+8]==="O"&&f[k+9]==="N"}function C(f){if(U.isName(f))return f;throw new Error(`Invalid entity name ${f}`)}L.exports=A},"./node_modules/fast-xml-parser/src/xmlparser/OptionsBuilder.js":function(L,J){const B={preserveOrder:!1,attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,removeNSPrefix:!1,allowBooleanAttributes:!1,parseTagValue:!0,parseAttributeValue:!1,trimValues:!0,cdataPropName:!1,numberParseOptions:{hex:!0,leadingZeros:!0,eNotation:!0},tagValueProcessor:function(A,F){return F},attributeValueProcessor:function(A,F){return F},stopNodes:[],alwaysCreateTextNode:!1,isArray:()=>!1,commentPropName:!1,unpairedTags:[],processEntities:!0,htmlEntities:!1,ignoreDeclaration:!1,ignorePiTags:!1,transformTagName:!1,transformAttributeName:!1,updateTag:function(A,F,N){return A}},U=function(A){return Object.assign({},B,A)};J.buildOptions=U,J.defaultOptions=B},"./node_modules/fast-xml-parser/src/xmlparser/OrderedObjParser.js":function(L,J,B){const U=B("./node_modules/fast-xml-parser/src/util.js"),A=B("./node_modules/fast-xml-parser/src/xmlparser/xmlNode.js"),F=B("./node_modules/fast-xml-parser/src/xmlparser/DocTypeReader.js"),N=B("./node_modules/strnum/strnum.js"),M=B("./node_modules/fast-xml-parser/src/ignoreAttributes.js");class i{constructor(t){this.options=t,this.currentNode=null,this.tagsNodeStack=[],this.docTypeEntities={},this.lastEntities={apos:{regex:/&(apos|#39|#x27);/g,val:"'"},gt:{regex:/&(gt|#62|#x3E);/g,val:">"},lt:{regex:/&(lt|#60|#x3C);/g,val:"<"},quot:{regex:/&(quot|#34|#x22);/g,val:'"'}},this.ampEntity={regex:/&(amp|#38|#x26);/g,val:"&"},this.htmlEntities={space:{regex:/&(nbsp|#160);/g,val:" "},cent:{regex:/&(cent|#162);/g,val:"¢"},pound:{regex:/&(pound|#163);/g,val:"£"},yen:{regex:/&(yen|#165);/g,val:"¥"},euro:{regex:/&(euro|#8364);/g,val:"€"},copyright:{regex:/&(copy|#169);/g,val:"©"},reg:{regex:/&(reg|#174);/g,val:"®"},inr:{regex:/&(inr|#8377);/g,val:"₹"},num_dec:{regex:/&#([0-9]{1,7});/g,val:(r,a)=>String.fromCharCode(Number.parseInt(a,10))},num_hex:{regex:/&#x([0-9a-fA-F]{1,6});/g,val:(r,a)=>String.fromCharCode(Number.parseInt(a,16))}},this.addExternalEntities=p,this.parseXml=S,this.parseTextData=l,this.resolveNameSpace=C,this.buildAttributesMap=k,this.isItStopNode=z,this.replaceEntitiesValue=P,this.readStopNodeData=m,this.saveTextToParentTag=j,this.addChild=b,this.ignoreAttributesFn=M(this.options.ignoreAttributes)}}function p(n){const t=Object.keys(n);for(let r=0;r<t.length;r++){const a=t[r];this.lastEntities[a]={regex:new RegExp("&"+a+";","g"),val:n[a]}}}function l(n,t,r,a,y,I,T){if(n!==void 0&&(this.options.trimValues&&!a&&(n=n.trim()),n.length>0)){T||(n=this.replaceEntitiesValue(n));const K=this.options.tagValueProcessor(t,n,r,y,I);return K==null?n:typeof K!=typeof n||K!==n?K:this.options.trimValues?s(n,this.options.parseTagValue,this.options.numberParseOptions):n.trim()===n?s(n,this.options.parseTagValue,this.options.numberParseOptions):n}}function C(n){if(this.options.removeNSPrefix){const t=n.split(":"),r=n.charAt(0)==="/"?"/":"";if(t[0]==="xmlns")return"";t.length===2&&(n=r+t[1])}return n}const f=new RegExp(`([^\\s=]+)\\s*(=\\s*(['"])([\\s\\S]*?)\\3)?`,"gm");function k(n,t,r){if(this.options.ignoreAttributes!==!0&&typeof n=="string"){const a=U.getAllMatches(n,f),y=a.length,I={};for(let T=0;T<y;T++){const K=this.resolveNameSpace(a[T][1]);if(this.ignoreAttributesFn(K,t))continue;let _=a[T][4],Z=this.options.attributeNamePrefix+K;if(K.length)if(this.options.transformAttributeName&&(Z=this.options.transformAttributeName(Z)),Z==="__proto__"&&(Z="#__proto__"),_!==void 0){this.options.trimValues&&(_=_.trim()),_=this.replaceEntitiesValue(_);const X=this.options.attributeValueProcessor(K,_,t);X==null?I[Z]=_:typeof X!=typeof _||X!==_?I[Z]=X:I[Z]=s(_,this.options.parseAttributeValue,this.options.numberParseOptions)}else this.options.allowBooleanAttributes&&(I[Z]=!0)}if(!Object.keys(I).length)return;if(this.options.attributesGroupName){const T={};return T[this.options.attributesGroupName]=I,T}return I}}const S=function(n){const t=new A("!xml");let r=t,a="",y="";for(let I=0;I<n.length;I++)if(n[I]==="<")if(n[I+1]==="/"){const K=h(n,">",I,"Closing Tag is not closed.");let _=n.substring(I+2,K).trim();if(this.options.removeNSPrefix){const ne=_.indexOf(":");ne!==-1&&(_=_.substr(ne+1))}this.options.transformTagName&&(_=this.options.transformTagName(_)),r&&(a=this.saveTextToParentTag(a,r,y));const Z=y.substring(y.lastIndexOf(".")+1);if(_&&this.options.unpairedTags.indexOf(_)!==-1)throw new Error(`Unpaired tag can not be used as closing tag: </${_}>`);let X=0;Z&&this.options.unpairedTags.indexOf(Z)!==-1?(X=y.lastIndexOf(".",y.lastIndexOf(".")-1),this.tagsNodeStack.pop()):X=y.lastIndexOf("."),y=y.substring(0,X),r=this.tagsNodeStack.pop(),a="",I=K}else if(n[I+1]==="?"){let K=d(n,I,!1,"?>");if(!K)throw new Error("Pi Tag is not closed.");if(a=this.saveTextToParentTag(a,r,y),!(this.options.ignoreDeclaration&&K.tagName==="?xml"||this.options.ignorePiTags)){const _=new A(K.tagName);_.add(this.options.textNodeName,""),K.tagName!==K.tagExp&&K.attrExpPresent&&(_[":@"]=this.buildAttributesMap(K.tagExp,y,K.tagName)),this.addChild(r,_,y)}I=K.closeIndex+1}else if(n.substr(I+1,3)==="!--"){const K=h(n,"-->",I+4,"Comment is not closed.");if(this.options.commentPropName){const _=n.substring(I+4,K-2);a=this.saveTextToParentTag(a,r,y),r.add(this.options.commentPropName,[{[this.options.textNodeName]:_}])}I=K}else if(n.substr(I+1,2)==="!D"){const K=F(n,I);this.docTypeEntities=K.entities,I=K.i}else if(n.substr(I+1,2)==="!["){const K=h(n,"]]>",I,"CDATA is not closed.")-2,_=n.substring(I+9,K);a=this.saveTextToParentTag(a,r,y);let Z=this.parseTextData(_,r.tagname,y,!0,!1,!0,!0);Z==null&&(Z=""),this.options.cdataPropName?r.add(this.options.cdataPropName,[{[this.options.textNodeName]:_}]):r.add(this.options.textNodeName,Z),I=K+2}else{let K=d(n,I,this.options.removeNSPrefix),_=K.tagName;const Z=K.rawTagName;let X=K.tagExp,ne=K.attrExpPresent,oe=K.closeIndex;this.options.transformTagName&&(_=this.options.transformTagName(_)),r&&a&&r.tagname!=="!xml"&&(a=this.saveTextToParentTag(a,r,y,!1));const Se=r;if(Se&&this.options.unpairedTags.indexOf(Se.tagname)!==-1&&(r=this.tagsNodeStack.pop(),y=y.substring(0,y.lastIndexOf("."))),_!==t.tagname&&(y+=y?"."+_:_),this.isItStopNode(this.options.stopNodes,y,_)){let le="";if(X.length>0&&X.lastIndexOf("/")===X.length-1)_[_.length-1]==="/"?(_=_.substr(0,_.length-1),y=y.substr(0,y.length-1),X=_):X=X.substr(0,X.length-1),I=K.closeIndex;else if(this.options.unpairedTags.indexOf(_)!==-1)I=K.closeIndex;else{const ee=this.readStopNodeData(n,Z,oe+1);if(!ee)throw new Error(`Unexpected end of ${Z}`);I=ee.i,le=ee.tagContent}const se=new A(_);_!==X&&ne&&(se[":@"]=this.buildAttributesMap(X,y,_)),le&&(le=this.parseTextData(le,_,y,!0,ne,!0,!0)),y=y.substr(0,y.lastIndexOf(".")),se.add(this.options.textNodeName,le),this.addChild(r,se,y)}else{if(X.length>0&&X.lastIndexOf("/")===X.length-1){_[_.length-1]==="/"?(_=_.substr(0,_.length-1),y=y.substr(0,y.length-1),X=_):X=X.substr(0,X.length-1),this.options.transformTagName&&(_=this.options.transformTagName(_));const le=new A(_);_!==X&&ne&&(le[":@"]=this.buildAttributesMap(X,y,_)),this.addChild(r,le,y),y=y.substr(0,y.lastIndexOf("."))}else{const le=new A(_);this.tagsNodeStack.push(r),_!==X&&ne&&(le[":@"]=this.buildAttributesMap(X,y,_)),this.addChild(r,le,y),r=le}a="",I=oe}}else a+=n[I];return t.child};function b(n,t,r){const a=this.options.updateTag(t.tagname,r,t[":@"]);a===!1||(typeof a=="string"&&(t.tagname=a),n.addChild(t))}const P=function(n){if(this.options.processEntities){for(let t in this.docTypeEntities){const r=this.docTypeEntities[t];n=n.replace(r.regx,r.val)}for(let t in this.lastEntities){const r=this.lastEntities[t];n=n.replace(r.regex,r.val)}if(this.options.htmlEntities)for(let t in this.htmlEntities){const r=this.htmlEntities[t];n=n.replace(r.regex,r.val)}n=n.replace(this.ampEntity.regex,this.ampEntity.val)}return n};function j(n,t,r,a){return n&&(a===void 0&&(a=Object.keys(t.child).length===0),n=this.parseTextData(n,t.tagname,r,!1,t[":@"]?Object.keys(t[":@"]).length!==0:!1,a),n!==void 0&&n!==""&&t.add(this.options.textNodeName,n),n=""),n}function z(n,t,r){const a="*."+r;for(const y in n){const I=n[y];if(a===I||t===I)return!0}return!1}function q(n,t,r=">"){let a,y="";for(let I=t;I<n.length;I++){let T=n[I];if(a)T===a&&(a="");else if(T==='"'||T==="'")a=T;else if(T===r[0])if(r[1]){if(n[I+1]===r[1])return{data:y,index:I}}else return{data:y,index:I};else T==="	"&&(T=" ");y+=T}}function h(n,t,r,a){const y=n.indexOf(t,r);if(y===-1)throw new Error(a);return y+t.length-1}function d(n,t,r,a=">"){const y=q(n,t+1,a);if(!y)return;let I=y.data;const T=y.index,K=I.search(/\s/);let _=I,Z=!0;K!==-1&&(_=I.substring(0,K),I=I.substring(K+1).trimStart());const X=_;if(r){const ne=_.indexOf(":");ne!==-1&&(_=_.substr(ne+1),Z=_!==y.data.substr(ne+1))}return{tagName:_,tagExp:I,closeIndex:T,attrExpPresent:Z,rawTagName:X}}function m(n,t,r){const a=r;let y=1;for(;r<n.length;r++)if(n[r]==="<")if(n[r+1]==="/"){const I=h(n,">",r,`${t} is not closed`);if(n.substring(r+2,I).trim()===t&&(y--,y===0))return{tagContent:n.substring(a,r),i:I};r=I}else if(n[r+1]==="?")r=h(n,"?>",r+1,"StopNode is not closed.");else if(n.substr(r+1,3)==="!--")r=h(n,"-->",r+3,"StopNode is not closed.");else if(n.substr(r+1,2)==="![")r=h(n,"]]>",r,"StopNode is not closed.")-2;else{const I=d(n,r,">");I&&((I&&I.tagName)===t&&I.tagExp[I.tagExp.length-1]!=="/"&&y++,r=I.closeIndex)}}function s(n,t,r){if(t&&typeof n=="string"){const a=n.trim();return a==="true"?!0:a==="false"?!1:N(n,r)}else return U.isExist(n)?n:""}L.exports=i},"./node_modules/fast-xml-parser/src/xmlparser/XMLParser.js":function(L,J,B){const{buildOptions:U}=B("./node_modules/fast-xml-parser/src/xmlparser/OptionsBuilder.js"),A=B("./node_modules/fast-xml-parser/src/xmlparser/OrderedObjParser.js"),{prettify:F}=B("./node_modules/fast-xml-parser/src/xmlparser/node2json.js"),N=B("./node_modules/fast-xml-parser/src/validator.js");class M{constructor(p){this.externalEntities={},this.options=U(p)}parse(p,l){if(typeof p!="string")if(p.toString)p=p.toString();else throw new Error("XML data is accepted in String or Bytes[] form.");if(l){l===!0&&(l={});const k=N.validate(p,l);if(k!==!0)throw Error(`${k.err.msg}:${k.err.line}:${k.err.col}`)}const C=new A(this.options);C.addExternalEntities(this.externalEntities);const f=C.parseXml(p);return this.options.preserveOrder||f===void 0?f:F(f,this.options)}addEntity(p,l){if(l.indexOf("&")!==-1)throw new Error("Entity value can't have '&'");if(p.indexOf("&")!==-1||p.indexOf(";")!==-1)throw new Error("An entity must be set without '&' and ';'. Eg. use '#xD' for '&#xD;'");if(l==="&")throw new Error("An entity with value '&' is not permitted");this.externalEntities[p]=l}}L.exports=M},"./node_modules/fast-xml-parser/src/xmlparser/node2json.js":function(L,J,B){function U(i,p){return A(i,p)}function A(i,p,l){let C;const f={};for(let k=0;k<i.length;k++){const S=i[k],b=F(S);let P="";if(l===void 0?P=b:P=l+"."+b,b===p.textNodeName)C===void 0?C=S[b]:C+=""+S[b];else{if(b===void 0)continue;if(S[b]){let j=A(S[b],p,P);const z=M(j,p);S[":@"]?N(j,S[":@"],P,p):Object.keys(j).length===1&&j[p.textNodeName]!==void 0&&!p.alwaysCreateTextNode?j=j[p.textNodeName]:Object.keys(j).length===0&&(p.alwaysCreateTextNode?j[p.textNodeName]="":j=""),f[b]!==void 0&&f.hasOwnProperty(b)?(Array.isArray(f[b])||(f[b]=[f[b]]),f[b].push(j)):p.isArray(b,P,z)?f[b]=[j]:f[b]=j}}}return typeof C=="string"?C.length>0&&(f[p.textNodeName]=C):C!==void 0&&(f[p.textNodeName]=C),f}function F(i){const p=Object.keys(i);for(let l=0;l<p.length;l++){const C=p[l];if(C!==":@")return C}}function N(i,p,l,C){if(p){const f=Object.keys(p),k=f.length;for(let S=0;S<k;S++){const b=f[S];C.isArray(b,l+"."+b,!0,!0)?i[b]=[p[b]]:i[b]=p[b]}}}function M(i,p){const{textNodeName:l}=p,C=Object.keys(i).length;return!!(C===0||C===1&&(i[l]||typeof i[l]=="boolean"||i[l]===0))}J.prettify=U},"./node_modules/fast-xml-parser/src/xmlparser/xmlNode.js":function(L,J,B){class U{constructor(F){this.tagname=F,this.child=[],this[":@"]={}}add(F,N){F==="__proto__"&&(F="#__proto__"),this.child.push({[F]:N})}addChild(F){F.tagname==="__proto__"&&(F.tagname="#__proto__"),F[":@"]&&Object.keys(F[":@"]).length>0?this.child.push({[F.tagname]:F.child,":@":F[":@"]}):this.child.push({[F.tagname]:F.child})}}L.exports=U},"./node_modules/process/browser.js":function(L,J){var B=L.exports={},U,A;function F(){throw new Error("setTimeout has not been defined")}function N(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?U=setTimeout:U=F}catch{U=F}try{typeof clearTimeout=="function"?A=clearTimeout:A=N}catch{A=N}})();function M(j){if(U===setTimeout)return setTimeout(j,0);if((U===F||!U)&&setTimeout)return U=setTimeout,setTimeout(j,0);try{return U(j,0)}catch{try{return U.call(null,j,0)}catch{return U.call(this,j,0)}}}function i(j){if(A===clearTimeout)return clearTimeout(j);if((A===N||!A)&&clearTimeout)return A=clearTimeout,clearTimeout(j);try{return A(j)}catch{try{return A.call(null,j)}catch{return A.call(this,j)}}}var p=[],l=!1,C,f=-1;function k(){!l||!C||(l=!1,C.length?p=C.concat(p):f=-1,p.length&&S())}function S(){if(!l){var j=M(k);l=!0;for(var z=p.length;z;){for(C=p,p=[];++f<z;)C&&C[f].run();f=-1,z=p.length}C=null,l=!1,i(j)}}B.nextTick=function(j){var z=new Array(arguments.length-1);if(arguments.length>1)for(var q=1;q<arguments.length;q++)z[q-1]=arguments[q];p.push(new b(j,z)),p.length===1&&!l&&M(S)};function b(j,z){this.fun=j,this.array=z}b.prototype.run=function(){this.fun.apply(null,this.array)},B.title="browser",B.browser=!0,B.env={},B.argv=[],B.version="",B.versions={};function P(){}B.on=P,B.addListener=P,B.once=P,B.off=P,B.removeListener=P,B.removeAllListeners=P,B.emit=P,B.prependListener=P,B.prependOnceListener=P,B.listeners=function(j){return[]},B.binding=function(j){throw new Error("process.binding is not supported")},B.cwd=function(){return"/"},B.chdir=function(j){throw new Error("process.chdir is not supported")},B.umask=function(){return 0}},"./node_modules/strnum/strnum.js":function(L,J){const B=/^[-+]?0x[a-fA-F0-9]+$/,U=/^([\-\+])?(0*)([0-9]*(\.[0-9]*)?)$/,A={hex:!0,leadingZeros:!0,decimalPoint:".",eNotation:!0};function F(i,p={}){if(p=Object.assign({},A,p),!i||typeof i!="string")return i;let l=i.trim();if(p.skipLike!==void 0&&p.skipLike.test(l))return i;if(i==="0")return 0;if(p.hex&&B.test(l))return M(l,16);if(l.search(/[eE]/)!==-1){const C=l.match(/^([-\+])?(0*)([0-9]*(\.[0-9]*)?[eE][-\+]?[0-9]+)$/);if(C){if(p.leadingZeros)l=(C[1]||"")+C[3];else if(!(C[2]==="0"&&C[3][0]==="."))return i;return p.eNotation?Number(l):i}else return i}else{const C=U.exec(l);if(C){const f=C[1],k=C[2];let S=N(C[3]);if(!p.leadingZeros&&k.length>0&&f&&l[2]!==".")return i;if(!p.leadingZeros&&k.length>0&&!f&&l[1]!==".")return i;if(p.leadingZeros&&k===i)return 0;{const b=Number(l),P=""+b;return P.search(/[eE]/)!==-1?p.eNotation?b:i:l.indexOf(".")!==-1?P==="0"&&S===""||P===S||f&&P==="-"+S?b:i:k?S===P||f+S===P?b:i:l===P||l===f+P?b:i}}else return i}}function N(i){return i&&i.indexOf(".")!==-1&&(i=i.replace(/0+$/,""),i==="."?i="0":i[0]==="."?i="0"+i:i[i.length-1]==="."&&(i=i.substr(0,i.length-1))),i}function M(i,p){if(parseInt)return parseInt(i,p);if(Number.parseInt)return Number.parseInt(i,p);if(window&&window.parseInt)return window.parseInt(i,p);throw new Error("parseInt, Number.parseInt, window.parseInt are not supported")}L.exports=F},"./node_modules/webpack/buildin/amd-options.js":function(L,J){(function(B){L.exports=B}).call(this,{})},"./node_modules/webpack/buildin/module.js":function(L,J){L.exports=function(B){return B.webpackPolyfill||(B.deprecate=function(){},B.paths=[],B.children||(B.children=[]),Object.defineProperty(B,"loaded",{enumerable:!0,get:function(){return B.l}}),Object.defineProperty(B,"id",{enumerable:!0,get:function(){return B.i}}),B.webpackPolyfill=1),B}},"./package.json":function(L){L.exports=JSON.parse('{"name":"cos-js-sdk-v5","version":"1.10.1","description":"JavaScript SDK for [腾讯云对象存储](https://cloud.tencent.com/product/cos)","main":"dist/cos-js-sdk-v5.js","types":"index.d.ts","scripts":{"prettier":"prettier --write src demo/demo.js demo/CIDemos/*.js test/test.js server/sts.js lib/request.js index.d.ts","server":"node server/sts.js","dev":"cross-env NODE_ENV=development webpack -w --mode=development","build":"cross-env NODE_ENV=production webpack --mode=production","cos-auth.min.js":"uglifyjs ./demo/common/cos-auth.js -o ./demo/common/cos-auth.min.js -c -m","test":"jest --runInBand --coverage","postinstall":"node scripts/patch-check.js"},"repository":{"type":"git","url":"git+https://github.com/tencentyun/cos-js-sdk-v5.git"},"keywords":[],"author":"carsonxu","license":"ISC","bugs":{"url":"https://github.com/tencentyun/cos-js-sdk-v5/issues"},"homepage":"https://github.com/tencentyun/cos-js-sdk-v5#readme","dependencies":{"fast-xml-parser":"4.5.0"},"devDependencies":{"@babel/core":"7.17.9","@babel/plugin-transform-runtime":"7.18.10","@babel/preset-env":"7.16.11","babel-loader":"8.2.5","body-parser":"^1.18.3","cross-env":"^5.2.0","express":"^4.16.4","jest":"29.7.0","jest-environment-jsdom":"29.7.0","patch-package":"^8.0.0","prettier":"^3.0.1","qcloud-cos-sts":"^3.0.2","request":"^2.87.0","terser-webpack-plugin":"4.2.3","uglifyjs":"^2.4.11","webpack":"4.46.0","webpack-cli":"4.10.0"}}')},"./src/advance.js":function(L,J,B){var U=B("./node_modules/@babel/runtime/helpers/typeof.js"),A=B("./src/session.js"),F=B("./src/async.js"),N=B("./src/event.js").EventProxy,M=B("./src/util.js"),i=B("./src/tracker.js");function p(s,n){var t=this,r=new N,a=s.TaskId,y=s.Bucket,I=s.Region,T=s.Key,K=s.Body,_=s.ChunkSize||s.SliceSize||t.options.ChunkSize,Z=s.AsyncLimit,X=s.StorageClass,ne=s.ServerSideEncryption,oe,Se,le=s.onHashProgress,se=s.tracker;se&&se.setParams({chunkSize:_}),t.logger.info({cate:"PROCESS",tag:"upload",msg:"[key=".concat(s.Key,"] 分块上传开始")}),r.on("error",function(ee){if(t._isRunningTask(a))return s.UploadData.UploadId&&A.removeUsing(s.UploadData.UploadId),ee.UploadId=s.UploadData.UploadId||"",t.logger.error({cate:"RESULT",tag:"upload",msg:"[key=".concat(s.Key,"] 分块上传失败: ").concat(JSON.stringify(ee))}),n(ee)}),r.on("upload_complete",function(ee){var W=M.extend({UploadId:s.UploadData.UploadId||""},ee);n(null,W)}),r.on("upload_slice_complete",function(ee){var W={};M.each(s.Headers,function(te,de){var he=de.toLowerCase();(he.indexOf("x-cos-meta-")===0||["pic-operations","x-cos-callback","x-cos-callback-var","x-cos-return-body"].includes(he))&&(W[de]=te)}),t.logger.info({cate:"PROCESS",tag:"upload",msg:"[key=".concat(s.Key,"] 开始完成分块请求")}),b.call(t,{Bucket:y,Region:I,Key:T,UploadId:ee.UploadId,SliceList:ee.SliceList,Headers:W,tracker:se},function(te,de){if(t._isRunningTask(a)){if(A.removeUsing(ee.UploadId),te)return Se(null,!0),t.logger.error({cate:"RESULT",tag:"upload",msg:"[key=".concat(s.Key,"] 完成分块请求失败")}),r.emit("error",te);A.removeUploadId.call(t,ee.UploadId),Se({loaded:oe,total:oe},!0),t.logger.info({cate:"RESULT",tag:"upload",msg:"[key=".concat(s.Key,"] 完成分块请求成功")}),r.emit("upload_complete",de)}})}),r.on("get_upload_data_finish",function(ee){var W=A.getFileId(K,s.ChunkSize,y,T);W&&A.saveUploadId.call(t,W,ee.UploadId,t.options.UploadIdCacheLimit),A.setUsing(ee.UploadId),Se(null,!0),t.logger.info({cate:"PROCESS",tag:"upload",msg:"[key=".concat(s.Key,"] 开始上传各个分块")}),k.call(t,{TaskId:a,Bucket:y,Region:I,Key:T,Body:K,FileSize:oe,SliceSize:_,AsyncLimit:Z,ServerSideEncryption:ne,UploadData:ee,Headers:s.Headers,onProgress:Se,tracker:se},function(te,de){if(t._isRunningTask(a)){if(te)return Se(null,!0),t.logger.error({cate:"PROCESS",tag:"upload",msg:"[key=".concat(s.Key,"] 分块上传失败")}),r.emit("error",te);t.logger.info({cate:"PROCESS",tag:"upload",msg:"[key=".concat(s.Key,"] 所有分块上传完成")}),r.emit("upload_slice_complete",de)}})}),r.on("get_file_size_finish",function(){if(Se=M.throttleOnProgress.call(t,oe,s.onProgress),s.UploadData.UploadId)t.logger.info({cate:"PROCESS",tag:"upload",msg:"[key=".concat(s.Key,"] 已经获取到 uploadId, ").concat(s.UploadData.UploadId)}),r.emit("get_upload_data_finish",s.UploadData);else{var ee=M.extend({TaskId:a,Bucket:y,Region:I,Key:T,Headers:s.Headers,StorageClass:X,Body:K,FileSize:oe,SliceSize:_,onHashProgress:le,tracker:se},s);t.logger.info({cate:"PROCESS",tag:"upload",msg:"[key=".concat(s.Key,"] 去获取 uploadId")}),l.call(t,ee,function(W,te){if(t._isRunningTask(a)){if(W)return r.emit("error",W);s.UploadData.UploadId=te.UploadId,s.UploadData.PartList=te.PartList,t.logger.info({cate:"PROCESS",tag:"upload",msg:"[key=".concat(s.Key,"] 获取到 uploadId, ").concat(s.UploadData.UploadId)}),r.emit("get_upload_data_finish",s.UploadData)}})}}),oe=s.ContentLength,delete s.ContentLength,!s.Headers&&(s.Headers={}),M.each(s.Headers,function(ee,W){W.toLowerCase()==="content-length"&&delete s.Headers[W]}),function(){for(var ee=[1,2,4,8,16,32,64,128,256,512,1024,2048,4096,5120],W=1024*1024,te=0;te<ee.length&&(W=ee[te]*1024*1024,!(oe/W<=t.options.MaxPartNumber));te++);s.ChunkSize=s.SliceSize=_=Math.max(_,W)}(),oe===0?(s.Body="",s.ContentLength=0,s.SkipTask=!0,t.logger.info({cate:"PROCESS",tag:"upload",msg:"[key=".concat(s.Key,"] 文件大小为 0，执行简单上传")}),t.putObject(s,n)):r.emit("get_file_size_finish")}function l(s,n){var t=s.TaskId,r=s.Bucket,a=s.Region,y=s.Key,I=s.StorageClass,T=this,K={},_=s.FileSize,Z=s.SliceSize,X=Math.ceil(_/Z),ne=0,oe=M.throttleOnProgress.call(T,_,s.onHashProgress),Se=function(W,te){var de=Z*(W-1),he=Math.min(de+Z,_),re=he-de;K[W]?te(null,{PartNumber:W,ETag:K[W],Size:re}):M.fileSlice(s.Body,de,he,!1,function(ce){M.getFileMd5(ce,function(ve,pe){if(ve)return te(M.error(ve));var Ce='"'+pe+'"';K[W]=Ce,ne+=re,oe({loaded:ne,total:_}),te(null,{PartNumber:W,ETag:Ce,Size:re})})})},le=function(W,te){var de=W.length;if(de===0)return te(null,!0);if(de>X)return te(null,!1);if(de>1){var he=Math.max(W[0].Size,W[1].Size);if(he!==Z)return te(null,!1)}var re=function(ve){if(ve<de){var pe=W[ve];Se(pe.PartNumber,function(Ce,Ae){Ae&&Ae.ETag===pe.ETag&&Ae.Size===pe.Size?re(ve+1):te(null,!1)})}else te(null,!0)};re(0)},se=new N;se.on("error",function(ee){if(T._isRunningTask(t))return n(ee)}),se.on("upload_id_available",function(ee){var W={},te=[];M.each(ee.PartList,function(re){W[re.PartNumber]=re});for(var de=1;de<=X;de++){var he=W[de];he?(he.PartNumber=de,he.Uploaded=!0):he={PartNumber:de,ETag:null,Uploaded:!1},te.push(he)}ee.PartList=te,n(null,ee)}),se.on("no_available_upload_id",function(){if(T._isRunningTask(t)){var ee=M.extend({Bucket:r,Region:a,Key:y,Query:M.clone(s.Query),StorageClass:I,Body:s.Body,calledBySdk:"sliceUploadFile",tracker:s.tracker},s),W=M.clone(s.Headers);delete W["x-cos-mime-limit"],ee.Headers=W,T.logger.info({cate:"PROCESS",tag:"upload",msg:"[key=".concat(s.Key,"] 准备初始化分块上传")}),T.multipartInit(ee,function(te,de){if(T._isRunningTask(t)){if(te)return T.logger.error({cate:"PROCESS",tag:"upload",msg:"[key=".concat(s.Key,"] 初始化分块上传失败, ").concat(JSON.stringify(te))}),se.emit("error",te);var he=de.UploadId;if(!he)return n(M.error(new Error("no such upload id")));T.logger.info({cate:"PROCESS",tag:"upload",msg:"[key=".concat(s.Key,"] 初始化分块上传成功")}),se.emit("upload_id_available",{UploadId:he,PartList:[]})}})}}),se.on("has_and_check_upload_id",function(ee){ee=ee.reverse(),F.eachLimit(ee,1,function(W,te){if(T._isRunningTask(t)){if(A.using[W]){te();return}f.call(T,{Bucket:r,Region:a,Key:y,UploadId:W,tracker:s.tracker},function(de,he){if(T._isRunningTask(t)){if(de)return A.removeUsing(W),se.emit("error",de);var re=he.PartList;re.forEach(function(ce){ce.PartNumber*=1,ce.Size*=1,ce.ETag=ce.ETag||""}),le(re,function(ce,ve){if(T._isRunningTask(t)){if(ce)return se.emit("error",ce);ve?te({UploadId:W,PartList:re}):te()}})}})}},function(W){T._isRunningTask(t)&&(oe(null,!0),W&&W.UploadId?se.emit("upload_id_available",W):se.emit("no_available_upload_id"))})}),se.on("seek_local_avail_upload_id",function(ee){var W=A.getFileId(s.Body,s.ChunkSize,r,y),te=A.getUploadIdList.call(T,W);if(!W||!te){se.emit("has_and_check_upload_id",ee);return}var de=function(re){if(re>=te.length){se.emit("has_and_check_upload_id",ee);return}var ce=te[re];if(!M.isInArray(ee,ce)){A.removeUploadId.call(T,ce),de(re+1);return}if(A.using[ce]){de(re+1);return}f.call(T,{Bucket:r,Region:a,Key:y,UploadId:ce,tracker:s.tracker},function(ve,pe){T._isRunningTask(t)&&(ve?(A.removeUploadId.call(T,ce),de(re+1)):se.emit("upload_id_available",{UploadId:ce,PartList:pe.PartList}))})};de(0)}),se.on("get_remote_upload_id_list",function(){C.call(T,{Bucket:r,Region:a,Key:y,tracker:s.tracker},function(ee,W){if(T._isRunningTask(t)){if(ee)return se.emit("error",ee);var te=M.filter(W.UploadList,function(re){return re.Key===y&&(!I||re.StorageClass.toUpperCase()===I.toUpperCase())}).reverse().map(function(re){return re.UploadId||re.UploadID});if(te.length)se.emit("seek_local_avail_upload_id",te);else{var de=A.getFileId(s.Body,s.ChunkSize,r,y),he;de&&(he=A.getUploadIdList.call(T,de))&&M.each(he,function(re){A.removeUploadId.call(T,re)}),se.emit("no_available_upload_id")}}})}),se.emit("get_remote_upload_id_list")}function C(s,n){var t=this,r=[],a={Bucket:s.Bucket,Region:s.Region,Prefix:s.Key,calledBySdk:s.calledBySdk||"sliceUploadFile",tracker:s.tracker},y=function(){t.multipartList(a,function(T,K){if(T)return n(T);r.push.apply(r,K.Upload||[]),K.IsTruncated==="true"?(a.KeyMarker=K.NextKeyMarker,a.UploadIdMarker=K.NextUploadIdMarker,y()):n(null,{UploadList:r})})};y()}function f(s,n){var t=this,r=[],a={Bucket:s.Bucket,Region:s.Region,Key:s.Key,UploadId:s.UploadId,calledBySdk:"sliceUploadFile",tracker:s.tracker},y=function(){t.multipartListPart(a,function(T,K){if(T)return n(T);r.push.apply(r,K.Part||[]),K.IsTruncated==="true"?(a.PartNumberMarker=K.NextPartNumberMarker,y()):n(null,{PartList:r})})};y()}function k(s,n){var t=this,r=s.TaskId,a=s.Bucket,y=s.Region,I=s.Key,T=s.UploadData,K=s.FileSize,_=s.SliceSize,Z=Math.min(s.AsyncLimit||t.options.ChunkParallelLimit||1,256),X=s.Body,ne=Math.ceil(K/_),oe=0,Se=s.ServerSideEncryption,le=s.Headers,se=M.filter(T.PartList,function(W){return W.Uploaded&&(oe+=W.PartNumber>=ne&&K%_||_),!W.Uploaded}),ee=s.onProgress;t.logger.info({cate:"PROCESS",tag:"upload",msg:"[key=".concat(s.Key,"] 开始并发上传各个分块")}),F.eachLimit(se,Z,function(W,te){if(t._isRunningTask(r)){var de=W.PartNumber,he=Math.min(K,W.PartNumber*_)-(W.PartNumber-1)*_,re=0;t.logger.info({cate:"PROCESS",tag:"upload",msg:"[key=".concat(s.Key,"] 分块").concat(de,"开始上传")}),S.call(t,{TaskId:r,Bucket:a,Region:y,Key:I,SliceSize:_,FileSize:K,PartNumber:de,ServerSideEncryption:Se,Body:X,UploadData:T,Headers:le,onProgress:function(ve){oe+=ve.loaded-re,re=ve.loaded,ee({loaded:oe,total:K})},tracker:s.tracker},function(ce,ve){t._isRunningTask(r)&&(!ce&&!ve.ETag&&(ce='get ETag error, please add "ETag" to CORS ExposeHeader setting.( 获取ETag失败，请在CORS ExposeHeader设置中添加ETag，请参考文档：https://cloud.tencent.com/document/product/436/13318 )',t.logger.error({cate:"PROCESS",tag:"upload",msg:"[key=".concat(s.Key,"] 分块").concat(de,"上传请求成功，但是未获取到 eTag")})),ce?(oe-=re,t.logger.info({cate:"RESULT",tag:"upload",msg:"[key=".concat(s.Key,"] 分块").concat(de,"上传失败")})):(oe+=he-re,W.ETag=ve.ETag),t.logger.info({cate:"RESULT",tag:"upload",msg:"[key=".concat(s.Key,"] 分块").concat(de,"上传成功")}),ee({loaded:oe,total:K}),te(ce||null,ve))})}},function(W){if(t._isRunningTask(r)){if(W)return n(W);n(null,{UploadId:T.UploadId,SliceList:T.PartList})}})}function S(s,n){var t=this,r=s.TaskId,a=s.Bucket,y=s.Region,I=s.Key,T=s.FileSize,K=s.Body,_=s.PartNumber*1,Z=s.SliceSize,X=s.ServerSideEncryption,ne=s.UploadData,oe=s.Headers||{},Se=t.options.ChunkRetryTimes+1,le=Z*(_-1),se=Z,ee=le+Z;ee>T&&(ee=T,se=ee-le);var W=["x-cos-traffic-limit","x-cos-mime-limit"],te={};M.each(oe,function(he,re){W.indexOf(re)>-1&&(te[re]=he)});var de=ne.PartList[_-1];F.retry(Se,function(he){t._isRunningTask(r)&&M.fileSlice(K,le,ee,!0,function(re){t.multipartUpload({TaskId:r,Bucket:a,Region:y,Key:I,ContentLength:se,PartNumber:_,UploadId:ne.UploadId,ServerSideEncryption:X,Body:re,Headers:te,onProgress:s.onProgress,calledBySdk:"sliceUploadFile",tracker:s.tracker},function(ce,ve){if(t._isRunningTask(r))return ce?he(ce):(de.Uploaded=!0,he(null,ve))})})},function(he,re){if(t._isRunningTask(r))return n(he,re)})}function b(s,n){var t=s.Bucket,r=s.Region,a=s.Key,y=s.UploadId,I=s.SliceList,T=this,K=this.options.ChunkRetryTimes+1,_=s.Headers,Z=I.map(function(X){return{PartNumber:X.PartNumber,ETag:X.ETag}});F.retry(K,function(X){T.multipartComplete({Bucket:t,Region:r,Key:a,UploadId:y,Parts:Z,Headers:_,calledBySdk:"sliceUploadFile",tracker:s.tracker},X)},function(X,ne){n(X,ne)})}function P(s,n){var t=s.Bucket,r=s.Region,a=s.Key,y=s.UploadId,I=s.Level||"task",T=s.AsyncLimit,K=this,_=new N;if(_.on("error",function(Z){return n(Z)}),_.on("get_abort_array",function(Z){j.call(K,{Bucket:t,Region:r,Key:a,Headers:s.Headers,AsyncLimit:T,AbortArray:Z},n)}),I==="bucket")C.call(K,{Bucket:t,Region:r,calledBySdk:"abortUploadTask"},function(Z,X){if(Z)return n(Z);_.emit("get_abort_array",X.UploadList||[])});else if(I==="file"){if(!a)return n(M.error(new Error("abort_upload_task_no_key")));C.call(K,{Bucket:t,Region:r,Key:a,calledBySdk:"abortUploadTask"},function(Z,X){if(Z)return n(Z);_.emit("get_abort_array",X.UploadList||[])})}else if(I==="task"){if(!y)return n(M.error(new Error("abort_upload_task_no_id")));if(!a)return n(M.error(new Error("abort_upload_task_no_key")));_.emit("get_abort_array",[{Key:a,UploadId:y}])}else return n(M.error(new Error("abort_unknown_level")))}function j(s,n){var t=s.Bucket,r=s.Region,a=s.Key,y=s.AbortArray,I=s.AsyncLimit||1,T=this,K=0,_=new Array(y.length);F.eachLimit(y,I,function(Z,X){var ne=K;if(a&&a!==Z.Key){_[ne]={error:{KeyNotMatch:!0}},X(null);return}var oe=Z.UploadId||Z.UploadID;T.multipartAbort({Bucket:t,Region:r,Key:Z.Key,Headers:s.Headers,UploadId:oe},function(Se){var le={Bucket:t,Region:r,Key:Z.Key,UploadId:oe};_[ne]={error:Se,task:le},X(null)}),K++},function(Z){if(Z)return n(Z);for(var X=[],ne=[],oe=0,Se=_.length;oe<Se;oe++){var le=_[oe];le.task&&(le.error?ne.push(le.task):X.push(le.task))}return n(null,{successList:X,errorList:ne})})}function z(s,n){var t=this,r=s.SliceSize===void 0?t.options.SliceSize:s.SliceSize,a=[],y=s.Body,I=y.size||y.length||0,T={TaskId:""};if(t.options.EnableReporter){var K=t.options.UseAccelerate||typeof t.options.Domain=="string"&&t.options.Domain.includes("accelerate."),_=I>r?"sliceUploadFile":"putObject";s.tracker=new i({Beacon:t.options.BeaconReporter,clsReporter:t.options.ClsReporter,bucket:s.Bucket,region:s.Region,apiName:"uploadFile",realApi:_,fileKey:s.Key,fileSize:I,accelerate:K,deepTracker:t.options.DeepTracker,customId:t.options.CustomId,delay:t.options.TrackerDelay})}M.each(s,function(le,se){U(le)!=="object"&&typeof le!="function"&&(T[se]=le)});var Z=s.onTaskReady,X=function(se){T.TaskId=se,Z&&Z(se)};s.onTaskReady=X;var ne=I>r?"sliceUploadFile":"putObject",oe=s.onFileFinish,Se=function(se,ee){s.tracker&&s.tracker.report(se,ee),oe&&oe(se,ee,T),n&&n(se,ee)};a.push({api:ne,params:s,callback:Se}),t._addTasks(a)}function q(s,n){var t=this,r=s.SliceSize===void 0?t.options.SliceSize:s.SliceSize,a=0,y=0,I=M.throttleOnProgress.call(t,y,s.onProgress),T=s.files.length,K=s.onFileFinish,_=Array(T),Z=function(oe,Se,le){I(null,!0),K&&K(oe,Se,le),_[le.Index]={options:le,error:oe,data:Se},--T<=0&&n&&n(null,{files:_})},X=[];M.each(s.files,function(ne,oe){(function(){var Se=ne.Body,le=Se.size||Se.length||0,se={Index:oe,TaskId:""};if(!t.options.UseRawKey&&ne.Key&&ne.Key.substr(0,1)==="/"&&(ne.Key=ne.Key.substr(1)),a+=le,t.options.EnableReporter){var ee=t.options.UseAccelerate||typeof t.options.Domain=="string"&&t.options.Domain.includes("accelerate."),W=le>r?"sliceUploadFile":"putObject";ne.tracker=new i({Beacon:t.options.BeaconReporter,clsReporter:t.options.ClsReporter,bucket:ne.Bucket,region:ne.Region,apiName:"uploadFiles",realApi:W,fileKey:ne.Key,fileSize:le,accelerate:ee,deepTracker:t.options.DeepTracker,customId:t.options.CustomId,delay:t.options.TrackerDelay})}M.each(ne,function(Ae,me){U(Ae)!=="object"&&typeof Ae!="function"&&(se[me]=Ae)});var te=ne.onTaskReady,de=function(me){se.TaskId=me,te&&te(me)};ne.onTaskReady=de;var he=0,re=ne.onProgress,ce=function(me){y=y-he+me.loaded,he=me.loaded,re&&re(me),I({loaded:y,total:a})};ne.onProgress=ce;var ve=le>r?"sliceUploadFile":"putObject",pe=ne.onFileFinish,Ce=function(me,je){ne.tracker&&ne.tracker.report(me,je),pe&&pe(me,je),Z&&Z(me,je,se)};X.push({api:ve,params:ne,callback:Ce})})()}),t._addTasks(X)}function h(s,n){var t=new N,r=this,a=s.Bucket,y=s.Region,I=s.Key,T=s.CopySource,K=M.getSourceParams.call(this,T);if(!K){n(M.error(new Error("CopySource format error")));return}var _=K.Bucket,Z=K.Region,X=decodeURIComponent(K.Key),ne=s.CopySliceSize===void 0?r.options.CopySliceSize:s.CopySliceSize;ne=Math.max(0,ne);var oe=s.CopyChunkSize||this.options.CopyChunkSize,Se=this.options.CopyChunkParallelLimit,le=this.options.ChunkRetryTimes+1,se=0,ee=0,W,te,de={},he={},re={};t.on("copy_slice_complete",function(ce){M.each(s.Headers,function(pe,Ce){Ce.toLowerCase().indexOf("x-cos-meta-")});var ve=M.map(ce.PartList,function(pe){return{PartNumber:pe.PartNumber,ETag:pe.ETag}});F.retry(le,function(pe){r.multipartComplete({Bucket:a,Region:y,Key:I,UploadId:ce.UploadId,Parts:ve,tracker:s.tracker,calledBySdk:"sliceCopyFile"},pe)},function(pe,Ce){if(A.removeUsing(ce.UploadId),pe)return te(null,!0),n(pe);A.removeUploadId(ce.UploadId),te({loaded:W,total:W},!0),n(null,Ce)})}),t.on("get_copy_data_finish",function(ce){var ve=A.getCopyFileId(T,de,oe,a,I);ve&&A.saveUploadId(ve,ce.UploadId,r.options.UploadIdCacheLimit),A.setUsing(ce.UploadId);var pe=M.filter(ce.PartList,function(Ce){return Ce.Uploaded&&(ee+=Ce.PartNumber>=se&&W%oe||oe),!Ce.Uploaded});F.eachLimit(pe,Se,function(Ce,Ae){var me=Ce.PartNumber,je=Ce.CopySourceRange,We=Ce.end-Ce.start;F.retry(le,function(He){d.call(r,{Bucket:a,Region:y,Key:I,CopySource:T,UploadId:ce.UploadId,PartNumber:me,CopySourceRange:je,tracker:s.tracker,calledBySdk:"sliceCopyFile"},He)},function(He,Qe){if(He)return Ae(He);ee+=We,te({loaded:ee,total:W}),Ce.ETag=Qe.ETag,Ae(He||null,Qe)})},function(Ce){if(Ce)return A.removeUsing(ce.UploadId),te(null,!0),n(Ce);t.emit("copy_slice_complete",ce)})}),t.on("get_chunk_size_finish",function(){var ce=function(){r.multipartInit({Bucket:a,Region:y,Key:I,Headers:re,tracker:s.tracker,calledBySdk:"sliceCopyFile"},function(me,je){if(me)return n(me);s.UploadId=je.UploadId,t.emit("get_copy_data_finish",{UploadId:s.UploadId,PartList:s.PartList})})},ve=A.getCopyFileId(T,de,oe,a,I),pe=A.getUploadIdList(ve);if(!ve||!pe)return ce();var Ce=function(me){if(me>=pe.length)return ce();var je=pe[me];if(A.using[je])return Ce(me+1);f.call(r,{Bucket:a,Region:y,Key:I,UploadId:je,tracker:s.tracker,calledBySdk:"sliceCopyFile"},function(We,He){if(We)A.removeUploadId(je),Ce(me+1);else{if(A.using[je])return Ce(me+1);var Qe={},Ye=0;M.each(He.PartList,function(ze){var Je=parseInt(ze.Size),st=Ye+Je-1;Qe[ze.PartNumber+"|"+Ye+"|"+st]=ze.ETag,Ye+=Je}),M.each(s.PartList,function(ze){var Je=Qe[ze.PartNumber+"|"+ze.start+"|"+ze.end];Je&&(ze.ETag=Je,ze.Uploaded=!0)}),t.emit("get_copy_data_finish",{UploadId:je,PartList:s.PartList})}})};Ce(0)}),t.on("get_file_size_finish",function(){if(function(){for(var ve=[1,2,4,8,16,32,64,128,256,512,1024,2048,4096,5120],pe=1024*1024,Ce=0;Ce<ve.length&&(pe=ve[Ce]*1024*1024,!(W/pe<=r.options.MaxPartNumber));Ce++);s.ChunkSize=oe=Math.max(oe,pe),se=Math.ceil(W/oe);for(var Ae=[],me=1;me<=se;me++){var je=(me-1)*oe,We=me*oe<W?me*oe-1:W-1,He={PartNumber:me,start:je,end:We,CopySourceRange:"bytes="+je+"-"+We};Ae.push(He)}s.PartList=Ae}(),s.Headers["x-cos-metadata-directive"]==="Replaced"?re=s.Headers:re=he,re["x-cos-storage-class"]=s.Headers["x-cos-storage-class"]||he["x-cos-storage-class"],re=M.clearKey(re),he["x-cos-storage-class"]==="ARCHIVE"||he["x-cos-storage-class"]==="DEEP_ARCHIVE"){var ce=he["x-cos-restore"];if(!ce||ce==='ongoing-request="true"'){n(M.error(new Error("Unrestored archive object is not allowed to be copied")));return}}delete re["x-cos-copy-source"],delete re["x-cos-metadata-directive"],delete re["x-cos-copy-source-If-Modified-Since"],delete re["x-cos-copy-source-If-Unmodified-Since"],delete re["x-cos-copy-source-If-Match"],delete re["x-cos-copy-source-If-None-Match"],t.emit("get_chunk_size_finish")}),r.headObject({Bucket:_,Region:Z,Key:X,tracker:s.tracker,calledBySdk:"sliceCopyFile"},function(ce,ve){if(ce){ce.statusCode&&ce.statusCode===404?n(M.error(ce,{ErrorStatus:X+" Not Exist"})):n(ce);return}if(W=s.FileSize=ve.headers["content-length"],W===void 0||!W){n(M.error(new Error('get Content-Length error, please add "Content-Length" to CORS ExposeHeader setting.（ 获取Content-Length失败，请在CORS ExposeHeader设置中添加Content-Length，请参考文档：https://cloud.tencent.com/document/product/436/13318 ）')));return}if(s.tracker&&s.tracker.setParams({httpSize:W}),te=M.throttleOnProgress.call(r,W,s.onProgress),W<=ne)s.Headers["x-cos-metadata-directive"]||(s.Headers["x-cos-metadata-directive"]="Copy"),r.putObjectCopy(Object.assign(s,{calledBySdk:"sliceCopyFile"}),function(Ce,Ae){if(Ce)return te(null,!0),n(Ce);te({loaded:W,total:W},!0),n(Ce,Ae)});else{var pe=ve.headers;de=pe,he={"Cache-Control":pe["cache-control"],"Content-Disposition":pe["content-disposition"],"Content-Encoding":pe["content-encoding"],"Content-Type":pe["content-type"],Expires:pe.expires,"x-cos-storage-class":pe["x-cos-storage-class"]},M.each(pe,function(Ce,Ae){var me="x-cos-meta-";Ae.indexOf(me)===0&&Ae.length>me.length&&(he[Ae]=Ce)}),t.emit("get_file_size_finish")}})}function d(s,n){var t=s.TaskId,r=s.Bucket,a=s.Region,y=s.Key,I=s.CopySource,T=s.UploadId,K=s.PartNumber*1,_=s.CopySourceRange,Z=this.options.ChunkRetryTimes+1,X=this;F.retry(Z,function(ne){X.uploadPartCopy({TaskId:t,Bucket:r,Region:a,Key:y,CopySource:I,UploadId:T,PartNumber:K,CopySourceRange:_,tracker:s.tracker,calledBySdk:s.calledBySdk},function(oe,Se){ne(oe||null,Se)})},function(ne,oe){return n(ne,oe)})}var m={sliceUploadFile:p,abortUploadTask:P,uploadFile:z,uploadFiles:q,sliceCopyFile:h};L.exports.init=function(s,n){n.transferToTaskMethod(m,"sliceUploadFile"),M.each(m,function(t,r){s.prototype[r]=M.apiWrapper(r,t)})}},"./src/async.js":function(L,J){var B=function(N,M,i,p){if(p=p||function(){},!N.length||M<=0)return p();var l=0,C=0,f=0;(function k(){if(l>=N.length)return p();for(;f<M&&C<N.length;)C+=1,f+=1,i(N[C-1],function(S){S?(p(S),p=function(){}):(l+=1,f-=1,l>=N.length?p():k())})})()},U=function(N,M,i){var p=function(C){M(function(f,k){f&&C<N?p(C+1):i(f,k)})};N<1?i():p(1)},A={eachLimit:B,retry:U};L.exports=A},"./src/base.js":function(L,J,B){var U=B("./node_modules/@babel/runtime/helpers/defineProperty.js"),A=B("./node_modules/@babel/runtime/helpers/typeof.js");function F(e,u){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);u&&(c=c.filter(function(v){return Object.getOwnPropertyDescriptor(e,v).enumerable})),o.push.apply(o,c)}return o}function N(e){for(var u=1;u<arguments.length;u++){var o=arguments[u]!=null?arguments[u]:{};u%2?F(Object(o),!0).forEach(function(c){U(e,c,o[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):F(Object(o)).forEach(function(c){Object.defineProperty(e,c,Object.getOwnPropertyDescriptor(o,c))})}return e}var M=B("./lib/request.js"),i=B("./src/util.js");function p(e,u){var o=this.options.Protocol||(i.isBrowser&&(typeof location>"u"?"undefined":A(location))==="object"&&location.protocol==="http:"?"http:":"https:"),c=this.options.ServiceDomain,v=e.AppId||this.options.appId,g=e.Region;c?(c=c.replace(/\{\{AppId\}\}/gi,v||"").replace(/\{\{Region\}\}/gi,g||"").replace(/\{\{.*?\}\}/gi,""),/^[a-zA-Z]+:\/\//.test(c)||(c=o+"//"+c),c.slice(-1)==="/"&&(c=c.slice(0,-1))):g?c=o+"//cos."+g+".myqcloud.com":c=o+"//service.cos.myqcloud.com";var x="",E=g?"cos."+g+".myqcloud.com":"service.cos.myqcloud.com",H=c.replace(/^https?:\/\/([^/]+)(\/.*)?$/,"$1");E===H&&(x=E),Y.call(this,{Action:"name/cos:GetService",url:c,method:"GET",headers:e.Headers,SignHost:x,tracker:e.tracker},function(ue,ae){if(ue)return u(ue);var xe=ae&&ae.ListAllMyBucketsResult&&ae.ListAllMyBucketsResult.Buckets&&ae.ListAllMyBucketsResult.Buckets.Bucket||[];xe=i.isArray(xe)?xe:[xe];var $=ae&&ae.ListAllMyBucketsResult&&ae.ListAllMyBucketsResult.Owner||{};u(null,{Buckets:xe,Owner:$,statusCode:ae.statusCode,headers:ae.headers})})}function l(e,u){var o=this,c="";if(e.BucketAZConfig){var v={BucketAZConfig:e.BucketAZConfig};c=i.json2xml({CreateBucketConfiguration:v})}Y.call(this,{Action:"name/cos:PutBucket",method:"PUT",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,body:c,tracker:e.tracker},function(g,x){if(g)return u(g);var E=qe({protocol:o.options.Protocol,domain:o.options.Domain,bucket:e.Bucket,region:e.Region,isLocation:!0});u(null,{Location:E,statusCode:x.statusCode,headers:x.headers})})}function C(e,u){Y.call(this,{Action:"name/cos:HeadBucket",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,method:"HEAD",tracker:e.tracker},u)}function f(e,u){var o={};o.prefix=e.Prefix||"",o.delimiter=e.Delimiter,o.marker=e.Marker,o["max-keys"]=e.MaxKeys,o["encoding-type"]=e.EncodingType,Y.call(this,{Action:"name/cos:GetBucket",ResourceKey:o.prefix,method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,qs:o,tracker:e.tracker},function(c,v){if(c)return u(c);var g=v.ListBucketResult||{},x=g.Contents||[],E=g.CommonPrefixes||[];x=i.isArray(x)?x:[x],E=i.isArray(E)?E:[E];var H=i.clone(g);i.extend(H,{Contents:x,CommonPrefixes:E,statusCode:v.statusCode,headers:v.headers}),u(null,H)})}function k(e,u){Y.call(this,{Action:"name/cos:DeleteBucket",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,method:"DELETE",tracker:e.tracker},function(o,c){if(o&&o.statusCode===204)return u(null,{statusCode:o.statusCode});if(o)return u(o);u(null,{statusCode:c.statusCode,headers:c.headers})})}function S(e,u){var o=e.Headers,c="";if(e.AccessControlPolicy){var v=i.clone(e.AccessControlPolicy||{}),g=v.Grants||v.Grant;g=i.isArray(g)?g:[g],delete v.Grant,delete v.Grants,v.AccessControlList={Grant:g},c=i.json2xml({AccessControlPolicy:v}),o["Content-Type"]="application/xml",o["Content-MD5"]=i.b64(i.md5(c))}i.each(o,function(x,E){E.indexOf("x-cos-grant-")===0&&(o[E]=$e(o[E]))}),Y.call(this,{Action:"name/cos:PutBucketACL",method:"PUT",Bucket:e.Bucket,Region:e.Region,headers:o,action:"acl",body:c,tracker:e.tracker},function(x,E){if(x)return u(x);u(null,{statusCode:E.statusCode,headers:E.headers})})}function b(e,u){Y.call(this,{Action:"name/cos:GetBucketACL",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"acl",tracker:e.tracker},function(o,c){if(o)return u(o);var v=c.AccessControlPolicy||{},g=v.Owner||{},x=v.AccessControlList.Grant||[];x=i.isArray(x)?x:[x];var E=be(v);c.headers&&c.headers["x-cos-acl"]&&(E.ACL=c.headers["x-cos-acl"]),E=i.extend(E,{Owner:g,Grants:x,statusCode:c.statusCode,headers:c.headers}),u(null,E)})}function P(e,u){var o=e.CORSConfiguration||{},c=o.CORSRules||e.CORSRules||[];c=i.clone(i.isArray(c)?c:[c]),i.each(c,function(E){i.each(["AllowedOrigin","AllowedHeader","AllowedMethod","ExposeHeader"],function(H){var ue=H+"s",ae=E[ue]||E[H]||[];delete E[ue],E[H]=i.isArray(ae)?ae:[ae]})});var v={CORSRule:c};e.ResponseVary&&(v.ResponseVary=e.ResponseVary);var g=i.json2xml({CORSConfiguration:v}),x=e.Headers;x["Content-Type"]="application/xml",x["Content-MD5"]=i.b64(i.md5(g)),Y.call(this,{Action:"name/cos:PutBucketCORS",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:g,action:"cors",headers:x,tracker:e.tracker},function(E,H){if(E)return u(E);u(null,{statusCode:H.statusCode,headers:H.headers})})}function j(e,u){Y.call(this,{Action:"name/cos:GetBucketCORS",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"cors",tracker:e.tracker},function(o,c){if(o){if(o.statusCode===404&&o.error&&o.error.Code==="NoSuchCORSConfiguration"){var v={CORSRules:[],statusCode:o.statusCode};o.headers&&(v.headers=o.headers),u(null,v)}else u(o);return}var g=c.CORSConfiguration||{},x=g.CORSRules||g.CORSRule||[];x=i.clone(i.isArray(x)?x:[x]);var E=g.ResponseVary;i.each(x,function(H){i.each(["AllowedOrigin","AllowedHeader","AllowedMethod","ExposeHeader"],function(ue){var ae=ue+"s",xe=H[ae]||H[ue]||[];delete H[ue],H[ae]=i.isArray(xe)?xe:[xe]})}),u(null,{CORSRules:x,ResponseVary:E,statusCode:c.statusCode,headers:c.headers})})}function z(e,u){Y.call(this,{Action:"name/cos:DeleteBucketCORS",method:"DELETE",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"cors",tracker:e.tracker},function(o,c){if(o&&o.statusCode===204)return u(null,{statusCode:o.statusCode});if(o)return u(o);u(null,{statusCode:c.statusCode||o.statusCode,headers:c.headers})})}function q(e,u){Y.call(this,{Action:"name/cos:GetBucketLocation",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"location",tracker:e.tracker},u)}function h(e,u){var o=e.Policy;try{typeof o=="string"&&(o=JSON.parse(o))}catch{}if(!o||typeof o=="string")return u(i.error(new Error("Policy format error")));var c=JSON.stringify(o);o.version||(o.version="2.0");var v=e.Headers;v["Content-Type"]="application/json",v["Content-MD5"]=i.b64(i.md5(c)),Y.call(this,{Action:"name/cos:PutBucketPolicy",method:"PUT",Bucket:e.Bucket,Region:e.Region,action:"policy",body:c,headers:v,tracker:e.tracker},function(g,x){if(g&&g.statusCode===204)return u(null,{statusCode:g.statusCode});if(g)return u(g);u(null,{statusCode:x.statusCode,headers:x.headers})})}function d(e,u){Y.call(this,{Action:"name/cos:GetBucketPolicy",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"policy",rawBody:!0,tracker:e.tracker},function(o,c){if(o)return o.statusCode&&o.statusCode===403?u(i.error(o,{ErrorStatus:"Access Denied"})):o.statusCode&&o.statusCode===405?u(i.error(o,{ErrorStatus:"Method Not Allowed"})):o.statusCode&&o.statusCode===404?u(i.error(o,{ErrorStatus:"Policy Not Found"})):u(o);var v={};try{v=JSON.parse(c.body)}catch{}u(null,{Policy:v,statusCode:c.statusCode,headers:c.headers})})}function m(e,u){Y.call(this,{Action:"name/cos:DeleteBucketPolicy",method:"DELETE",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"policy",tracker:e.tracker},function(o,c){if(o&&o.statusCode===204)return u(null,{statusCode:o.statusCode});if(o)return u(o);u(null,{statusCode:c.statusCode||o.statusCode,headers:c.headers})})}function s(e,u){var o=e.Tagging||{},c=o.TagSet||o.Tags||e.Tags||[];c=i.clone(i.isArray(c)?c:[c]);var v=i.json2xml({Tagging:{TagSet:{Tag:c}}}),g=e.Headers;g["Content-Type"]="application/xml",g["Content-MD5"]=i.b64(i.md5(v)),Y.call(this,{Action:"name/cos:PutBucketTagging",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:v,action:"tagging",headers:g,tracker:e.tracker},function(x,E){if(x&&x.statusCode===204)return u(null,{statusCode:x.statusCode});if(x)return u(x);u(null,{statusCode:E.statusCode,headers:E.headers})})}function n(e,u){Y.call(this,{Action:"name/cos:GetBucketTagging",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"tagging",tracker:e.tracker},function(o,c){if(o){if(o.statusCode===404&&o.error&&(o.error==="Not Found"||o.error.Code==="NoSuchTagSet")){var v={Tags:[],statusCode:o.statusCode};o.headers&&(v.headers=o.headers),u(null,v)}else u(o);return}var g=[];try{g=c.Tagging.TagSet.Tag||[]}catch{}g=i.clone(i.isArray(g)?g:[g]),u(null,{Tags:g,statusCode:c.statusCode,headers:c.headers})})}function t(e,u){Y.call(this,{Action:"name/cos:DeleteBucketTagging",method:"DELETE",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"tagging",tracker:e.tracker},function(o,c){if(o&&o.statusCode===204)return u(null,{statusCode:o.statusCode});if(o)return u(o);u(null,{statusCode:c.statusCode,headers:c.headers})})}function r(e,u){var o=e.LifecycleConfiguration||{},c=o.Rules||e.Rules||[];c=i.clone(c);var v=i.json2xml({LifecycleConfiguration:{Rule:c}}),g=e.Headers;g["Content-Type"]="application/xml",g["Content-MD5"]=i.b64(i.md5(v)),Y.call(this,{Action:"name/cos:PutBucketLifecycle",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:v,action:"lifecycle",headers:g,tracker:e.tracker},function(x,E){if(x&&x.statusCode===204)return u(null,{statusCode:x.statusCode});if(x)return u(x);u(null,{statusCode:E.statusCode,headers:E.headers})})}function a(e,u){Y.call(this,{Action:"name/cos:GetBucketLifecycle",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"lifecycle",tracker:e.tracker},function(o,c){if(o){if(o.statusCode===404&&o.error&&o.error.Code==="NoSuchLifecycleConfiguration"){var v={Rules:[],statusCode:o.statusCode};o.headers&&(v.headers=o.headers),u(null,v)}else u(o);return}var g=[];try{g=c.LifecycleConfiguration.Rule||[]}catch{}g=i.clone(i.isArray(g)?g:[g]),u(null,{Rules:g,statusCode:c.statusCode,headers:c.headers})})}function y(e,u){Y.call(this,{Action:"name/cos:DeleteBucketLifecycle",method:"DELETE",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"lifecycle",tracker:e.tracker},function(o,c){if(o&&o.statusCode===204)return u(null,{statusCode:o.statusCode});if(o)return u(o);u(null,{statusCode:c.statusCode,headers:c.headers})})}function I(e,u){if(!e.VersioningConfiguration){u(i.error(new Error("missing param VersioningConfiguration")));return}var o=e.VersioningConfiguration||{},c=i.json2xml({VersioningConfiguration:o}),v=e.Headers;v["Content-Type"]="application/xml",v["Content-MD5"]=i.b64(i.md5(c)),Y.call(this,{Action:"name/cos:PutBucketVersioning",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:c,action:"versioning",headers:v,tracker:e.tracker},function(g,x){if(g&&g.statusCode===204)return u(null,{statusCode:g.statusCode});if(g)return u(g);u(null,{statusCode:x.statusCode,headers:x.headers})})}function T(e,u){Y.call(this,{Action:"name/cos:GetBucketVersioning",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"versioning",tracker:e.tracker},function(o,c){o||!c.VersioningConfiguration&&(c.VersioningConfiguration={}),u(o,c)})}function K(e,u){var o=i.clone(e.ReplicationConfiguration),c=i.json2xml({ReplicationConfiguration:o});c=c.replace(/<(\/?)Rules>/gi,"<$1Rule>"),c=c.replace(/<(\/?)Tags>/gi,"<$1Tag>");var v=e.Headers;v["Content-Type"]="application/xml",v["Content-MD5"]=i.b64(i.md5(c)),Y.call(this,{Action:"name/cos:PutBucketReplication",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:c,action:"replication",headers:v,tracker:e.tracker},function(g,x){if(g&&g.statusCode===204)return u(null,{statusCode:g.statusCode});if(g)return u(g);u(null,{statusCode:x.statusCode,headers:x.headers})})}function _(e,u){Y.call(this,{Action:"name/cos:GetBucketReplication",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"replication",tracker:e.tracker},function(o,c){if(o){if(o.statusCode===404&&o.error&&(o.error==="Not Found"||o.error.Code==="ReplicationConfigurationnotFoundError")){var v={ReplicationConfiguration:{Rules:[]},statusCode:o.statusCode};o.headers&&(v.headers=o.headers),u(null,v)}else u(o);return}!c.ReplicationConfiguration&&(c.ReplicationConfiguration={}),c.ReplicationConfiguration.Rule&&(c.ReplicationConfiguration.Rules=i.makeArray(c.ReplicationConfiguration.Rule),delete c.ReplicationConfiguration.Rule),u(o,c)})}function Z(e,u){Y.call(this,{Action:"name/cos:DeleteBucketReplication",method:"DELETE",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"replication",tracker:e.tracker},function(o,c){if(o&&o.statusCode===204)return u(null,{statusCode:o.statusCode});if(o)return u(o);u(null,{statusCode:c.statusCode,headers:c.headers})})}function X(e,u){if(!e.WebsiteConfiguration){u(i.error(new Error("missing param WebsiteConfiguration")));return}var o=i.clone(e.WebsiteConfiguration||{}),c=o.RoutingRules||o.RoutingRule||[];c=i.isArray(c)?c:[c],delete o.RoutingRule,delete o.RoutingRules,c.length&&(o.RoutingRules={RoutingRule:c});var v=i.json2xml({WebsiteConfiguration:o}),g=e.Headers;g["Content-Type"]="application/xml",g["Content-MD5"]=i.b64(i.md5(v)),Y.call(this,{Action:"name/cos:PutBucketWebsite",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:v,action:"website",headers:g,tracker:e.tracker},function(x,E){if(x&&x.statusCode===204)return u(null,{statusCode:x.statusCode});if(x)return u(x);u(null,{statusCode:E.statusCode,headers:E.headers})})}function ne(e,u){Y.call(this,{Action:"name/cos:GetBucketWebsite",method:"GET",Bucket:e.Bucket,Region:e.Region,Key:e.Key,headers:e.Headers,action:"website",tracker:e.tracker},function(o,c){if(o){if(o.statusCode===404&&o.error.Code==="NoSuchWebsiteConfiguration"){var v={WebsiteConfiguration:{},statusCode:o.statusCode};o.headers&&(v.headers=o.headers),u(null,v)}else u(o);return}var g=c.WebsiteConfiguration||{};if(g.RoutingRules){var x=i.clone(g.RoutingRules.RoutingRule||[]);x=i.makeArray(x),g.RoutingRules=x}u(null,{WebsiteConfiguration:g,statusCode:c.statusCode,headers:c.headers})})}function oe(e,u){Y.call(this,{Action:"name/cos:DeleteBucketWebsite",method:"DELETE",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"website",tracker:e.tracker},function(o,c){if(o&&o.statusCode===204)return u(null,{statusCode:o.statusCode});if(o)return u(o);u(null,{statusCode:c.statusCode,headers:c.headers})})}function Se(e,u){if(!e.RefererConfiguration){u(i.error(new Error("missing param RefererConfiguration")));return}var o=i.clone(e.RefererConfiguration||{}),c=o.DomainList||{},v=c.Domains||c.Domain||[];v=i.isArray(v)?v:[v],v.length&&(o.DomainList={Domain:v});var g=i.json2xml({RefererConfiguration:o}),x=e.Headers;x["Content-Type"]="application/xml",x["Content-MD5"]=i.b64(i.md5(g)),Y.call(this,{Action:"name/cos:PutBucketReferer",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:g,action:"referer",headers:x,tracker:e.tracker},function(E,H){if(E&&E.statusCode===204)return u(null,{statusCode:E.statusCode});if(E)return u(E);u(null,{statusCode:H.statusCode,headers:H.headers})})}function le(e,u){Y.call(this,{Action:"name/cos:GetBucketReferer",method:"GET",Bucket:e.Bucket,Region:e.Region,Key:e.Key,headers:e.Headers,action:"referer",tracker:e.tracker},function(o,c){if(o){if(o.statusCode===404&&o.error.Code==="NoSuchRefererConfiguration"){var v={WebsiteConfiguration:{},statusCode:o.statusCode};o.headers&&(v.headers=o.headers),u(null,v)}else u(o);return}var g=c.RefererConfiguration||{};if(g.DomainList){var x=i.makeArray(g.DomainList.Domain||[]);g.DomainList={Domains:x}}u(null,{RefererConfiguration:g,statusCode:c.statusCode,headers:c.headers})})}function se(e,u){var o=e.DomainConfiguration||{},c=o.DomainRule||e.DomainRule||[];c=i.clone(c);var v=i.json2xml({DomainConfiguration:{DomainRule:c}}),g=e.Headers;g["Content-Type"]="application/xml",g["Content-MD5"]=i.b64(i.md5(v)),Y.call(this,{Action:"name/cos:PutBucketDomain",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:v,action:"domain",headers:g,tracker:e.tracker},function(x,E){if(x&&x.statusCode===204)return u(null,{statusCode:x.statusCode});if(x)return u(x);u(null,{statusCode:E.statusCode,headers:E.headers})})}function ee(e,u){Y.call(this,{Action:"name/cos:GetBucketDomain",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"domain",tracker:e.tracker},function(o,c){if(o)return u(o);var v=[];try{v=c.DomainConfiguration.DomainRule||[]}catch{}v=i.clone(i.isArray(v)?v:[v]),u(null,{DomainRule:v,statusCode:c.statusCode,headers:c.headers})})}function W(e,u){Y.call(this,{Action:"name/cos:DeleteBucketDomain",method:"DELETE",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"domain",tracker:e.tracker},function(o,c){if(o&&o.statusCode===204)return u(null,{statusCode:o.statusCode});if(o)return u(o);u(null,{statusCode:c.statusCode,headers:c.headers})})}function te(e,u){var o=e.OriginConfiguration||{},c=o.OriginRule||e.OriginRule||[];c=i.clone(c);var v=i.json2xml({OriginConfiguration:{OriginRule:c}}),g=e.Headers;g["Content-Type"]="application/xml",g["Content-MD5"]=i.b64(i.md5(v)),Y.call(this,{Action:"name/cos:PutBucketOrigin",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:v,action:"origin",headers:g,tracker:e.tracker},function(x,E){if(x&&x.statusCode===204)return u(null,{statusCode:x.statusCode});if(x)return u(x);u(null,{statusCode:E.statusCode,headers:E.headers})})}function de(e,u){Y.call(this,{Action:"name/cos:GetBucketOrigin",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"origin",tracker:e.tracker},function(o,c){if(o)return u(o);var v=[];try{v=c.OriginConfiguration.OriginRule||[]}catch{}v=i.clone(i.isArray(v)?v:[v]),u(null,{OriginRule:v,statusCode:c.statusCode,headers:c.headers})})}function he(e,u){Y.call(this,{Action:"name/cos:DeleteBucketOrigin",method:"DELETE",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"origin",tracker:e.tracker},function(o,c){if(o&&o.statusCode===204)return u(null,{statusCode:o.statusCode});if(o)return u(o);u(null,{statusCode:c.statusCode,headers:c.headers})})}function re(e,u){var o=i.json2xml({BucketLoggingStatus:e.BucketLoggingStatus||""}),c=e.Headers;c["Content-Type"]="application/xml",c["Content-MD5"]=i.b64(i.md5(o)),Y.call(this,{Action:"name/cos:PutBucketLogging",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:o,action:"logging",headers:c,tracker:e.tracker},function(v,g){if(v&&v.statusCode===204)return u(null,{statusCode:v.statusCode});if(v)return u(v);u(null,{statusCode:g.statusCode,headers:g.headers})})}function ce(e,u){Y.call(this,{Action:"name/cos:GetBucketLogging",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"logging",tracker:e.tracker},function(o,c){if(o)return u(o);u(null,{BucketLoggingStatus:c.BucketLoggingStatus,statusCode:c.statusCode,headers:c.headers})})}function ve(e,u,o){var c=i.clone(u.InventoryConfiguration);if(c.OptionalFields){var v=c.OptionalFields||[];c.OptionalFields={Field:v}}if(c.Destination&&c.Destination.COSBucketDestination&&c.Destination.COSBucketDestination.Encryption){var g=c.Destination.COSBucketDestination.Encryption;Object.keys(g).indexOf("SSECOS")>-1&&(g["SSE-COS"]=g.SSECOS,delete g.SSECOS)}var x=i.json2xml({InventoryConfiguration:c}),E=u.Headers;E["Content-Type"]="application/xml",E["Content-MD5"]=i.b64(i.md5(x));var H=e==="PUT"?"name/cos:PutBucketInventory":"name/cos:PostBucketInventory";Y.call(this,{Action:H,method:e,Bucket:u.Bucket,Region:u.Region,body:x,action:"inventory",qs:{id:u.Id},headers:E,tracker:u.tracker},function(ue,ae){if(ue&&ue.statusCode===204)return o(null,{statusCode:ue.statusCode});if(ue)return o(ue);o(null,{statusCode:ae.statusCode,headers:ae.headers})})}function pe(e,u){return ve.call(this,"PUT",e,u)}function Ce(e,u){return ve.call(this,"POST",e,u)}function Ae(e,u){Y.call(this,{Action:"name/cos:GetBucketInventory",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"inventory",qs:{id:e.Id},tracker:e.tracker},function(o,c){if(o)return u(o);var v=c.InventoryConfiguration;if(v&&v.OptionalFields&&v.OptionalFields.Field){var g=v.OptionalFields.Field;i.isArray(g)||(g=[g]),v.OptionalFields=g}if(v.Destination&&v.Destination.COSBucketDestination&&v.Destination.COSBucketDestination.Encryption){var x=v.Destination.COSBucketDestination.Encryption;Object.keys(x).indexOf("SSE-COS")>-1&&(x.SSECOS=x["SSE-COS"],delete x["SSE-COS"])}u(null,{InventoryConfiguration:v,statusCode:c.statusCode,headers:c.headers})})}function me(e,u){Y.call(this,{Action:"name/cos:ListBucketInventory",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"inventory",qs:{"continuation-token":e.ContinuationToken},tracker:e.tracker},function(o,c){if(o)return u(o);var v=c.ListInventoryConfigurationResult,g=v.InventoryConfiguration||[];g=i.isArray(g)?g:[g],delete v.InventoryConfiguration,i.each(g,function(x){if(x&&x.OptionalFields&&x.OptionalFields.Field){var E=x.OptionalFields.Field;i.isArray(E)||(E=[E]),x.OptionalFields=E}if(x.Destination&&x.Destination.COSBucketDestination&&x.Destination.COSBucketDestination.Encryption){var H=x.Destination.COSBucketDestination.Encryption;Object.keys(H).indexOf("SSE-COS")>-1&&(H.SSECOS=H["SSE-COS"],delete H["SSE-COS"])}}),v.InventoryConfigurations=g,i.extend(v,{statusCode:c.statusCode,headers:c.headers}),u(null,v)})}function je(e,u){Y.call(this,{Action:"name/cos:DeleteBucketInventory",method:"DELETE",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"inventory",qs:{id:e.Id},tracker:e.tracker},function(o,c){if(o&&o.statusCode===204)return u(null,{statusCode:o.statusCode});if(o)return u(o);u(null,{statusCode:c.statusCode,headers:c.headers})})}function We(e,u){if(!e.AccelerateConfiguration){u(i.error(new Error("missing param AccelerateConfiguration")));return}var o={AccelerateConfiguration:e.AccelerateConfiguration||{}},c=i.json2xml(o),v={};v["Content-Type"]="application/xml",v["Content-MD5"]=i.b64(i.md5(c)),Y.call(this,{Action:"name/cos:PutBucketAccelerate",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:c,action:"accelerate",headers:v,tracker:e.tracker},function(g,x){if(g)return u(g);u(null,{statusCode:x.statusCode,headers:x.headers})})}function He(e,u){Y.call(this,{Action:"name/cos:GetBucketAccelerate",method:"GET",Bucket:e.Bucket,Region:e.Region,action:"accelerate",tracker:e.tracker},function(o,c){o||!c.AccelerateConfiguration&&(c.AccelerateConfiguration={}),u(o,c)})}function Qe(e,u){var o=e.ServerSideEncryptionConfiguration||{},c=o.Rule||o.Rules||[],v=i.json2xml({ServerSideEncryptionConfiguration:{Rule:c}}),g=e.Headers;g["Content-Type"]="application/xml",g["Content-MD5"]=i.b64(i.md5(v)),Y.call(this,{Action:"name/cos:PutBucketEncryption",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:v,action:"encryption",headers:g,tracker:e.tracker},function(x,E){if(x&&x.statusCode===204)return u(null,{statusCode:x.statusCode});if(x)return u(x);u(null,{statusCode:E.statusCode,headers:E.headers})})}function Ye(e,u){Y.call(this,{Action:"name/cos:GetBucketEncryption",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"encryption",tracker:e.tracker},function(o,c){if(o){if(o.statusCode===404&&o.code==="NoSuchEncryptionConfiguration"){var v={EncryptionConfiguration:{Rules:[]},statusCode:o.statusCode};o.headers&&(v.headers=o.headers),u(null,v)}else u(o);return}var g=i.makeArray(c.EncryptionConfiguration&&c.EncryptionConfiguration.Rule||[]);c.EncryptionConfiguration={Rules:g},u(o,c)})}function ze(e,u){Y.call(this,{Action:"name/cos:DeleteBucketReplication",method:"DELETE",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"encryption",tracker:e.tracker},function(o,c){if(o&&o.statusCode===204)return u(null,{statusCode:o.statusCode});if(o)return u(o);u(null,{statusCode:c.statusCode,headers:c.headers})})}function Je(e,u){Y.call(this,{Action:"name/cos:HeadObject",method:"HEAD",Bucket:e.Bucket,Region:e.Region,Key:e.Key,VersionId:e.VersionId,headers:e.Headers,tracker:e.tracker},function(o,c){if(o){var v=o.statusCode;return e.Headers["If-Modified-Since"]&&v&&v===304?u(null,{NotModified:!0,statusCode:v}):u(o)}c.ETag=i.attr(c.headers,"etag",""),u(null,c)})}function st(e,u){var o={};o.prefix=e.Prefix||"",o.delimiter=e.Delimiter,o["key-marker"]=e.KeyMarker,o["version-id-marker"]=e.VersionIdMarker,o["max-keys"]=e.MaxKeys,o["encoding-type"]=e.EncodingType,Y.call(this,{Action:"name/cos:GetBucketObjectVersions",ResourceKey:o.prefix,method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,qs:o,action:"versions",tracker:e.tracker},function(c,v){if(c)return u(c);var g=v.ListVersionsResult||{},x=g.DeleteMarker||[];x=i.isArray(x)?x:[x];var E=g.Version||[];E=i.isArray(E)?E:[E];var H=i.clone(g);delete H.DeleteMarker,delete H.Version,i.extend(H,{DeleteMarkers:x,Versions:E,statusCode:v.statusCode,headers:v.headers}),u(null,H)})}function ft(e,u){var o=this;if(o.logger.info({cate:"PROCESS",tag:"download",msg:"[key=".concat(e.Key,"] getObject开始")}),this.options.ObjectKeySimplifyCheck){var c=i.simplifyPath(e.Key);if(c==="/"){u(i.error(new Error("The Getobject Key is illegal")));return}}var v=e.Query||{},g=e.QueryString||"",x=i.throttleOnProgress.call(this,0,e.onProgress),E=e.tracker;E&&E.setParams({signStartTime:new Date().getTime()}),v["response-content-type"]=e.ResponseContentType,v["response-content-language"]=e.ResponseContentLanguage,v["response-expires"]=e.ResponseExpires,v["response-cache-control"]=e.ResponseCacheControl,v["response-content-disposition"]=e.ResponseContentDisposition,v["response-content-encoding"]=e.ResponseContentEncoding,Y.call(this,{Action:"name/cos:GetObject",method:"GET",Bucket:e.Bucket,Region:e.Region,Key:e.Key,VersionId:e.VersionId,DataType:e.DataType,headers:e.Headers,qs:v,qsStr:g,rawBody:!0,onDownloadProgress:x,tracker:E},function(H,ue){if(x(null,!0),H){var ae=H.statusCode;return e.Headers["If-Modified-Since"]&&ae&&ae===304?u(null,{NotModified:!0}):u(H)}u(null,{Body:ue.body,ETag:i.attr(ue.headers,"etag",""),statusCode:ue.statusCode,headers:ue.headers}),o.logger.info({cate:"PROCESS",tag:"download",msg:"[key=".concat(e.Key,"] getObject结束")})})}function ht(e,u){var o=this,c=e.ContentLength,v=i.throttleOnProgress.call(o,c,e.onProgress);o.logger.info({cate:"PROCESS",tag:"upload",msg:"[key=".concat(e.Key,"] putObject开始")});var g=e.Headers;!g["Cache-Control"]&&!g["cache-control"]&&(g["Cache-Control"]=""),!g["Content-Type"]&&!g["content-type"]&&(g["Content-Type"]=e.Body&&e.Body.type||"");var x=e.UploadAddMetaMd5||o.options.UploadAddMetaMd5||o.options.UploadCheckContentMd5,E=e.tracker;x&&E&&E.setParams({md5StartTime:new Date().getTime()}),x&&o.logger.debug({cate:"PROCESS",tag:"upload",msg:"[key=".concat(e.Key,"] 开始计算 md5")}),i.getBodyMd5(x,e.Body,function(H){H&&(o.logger.debug({cate:"PROCESS",tag:"upload",msg:"[key=".concat(e.Key,"] md5: ").concat(H,"，md5Base64=").concat(i.b64(H))}),E&&E.setParams({md5EndTime:new Date().getTime()}),o.options.UploadCheckContentMd5&&(g["Content-MD5"]=i.b64(H)),(e.UploadAddMetaMd5||o.options.UploadAddMetaMd5)&&(g["x-cos-meta-md5"]=H)),e.ContentLength!==void 0&&(g["Content-Length"]=e.ContentLength),v(null,!0),Y.call(o,{Action:"name/cos:PutObject",TaskId:e.TaskId,method:"PUT",Bucket:e.Bucket,Region:e.Region,Key:e.Key,headers:e.Headers,qs:e.Query,body:e.Body,onProgress:v,tracker:E},function(ue,ae){if(ue)return o.logger.error({cate:"ERROR",tag:"upload",msg:"上传失败，错误信息：".concat(JSON.stringify(ue))}),v(null,!0),u(ue);v({loaded:c,total:c},!0);var xe=qe({ForcePathStyle:o.options.ForcePathStyle,protocol:o.options.Protocol,domain:o.options.Domain,bucket:e.Bucket,region:o.options.UseAccelerate?"accelerate":e.Region,object:e.Key});xe=xe.substr(xe.indexOf("://")+3),ae.Location=xe,ae.ETag=i.attr(ae.headers,"etag",""),o.logger.info({cate:"RESULT",tag:"upload",msg:"上传成功，Location=".concat(xe)}),o.logger.info({cate:"PROCESS",tag:"upload",msg:"[key=".concat(e.Key,"] putObject结束")}),u(null,ae)})},e.onHashProgress)}function gt(e,u){Y.call(this,{Action:"name/cos:DeleteObject",method:"DELETE",Bucket:e.Bucket,Region:e.Region,Key:e.Key,headers:e.Headers,VersionId:e.VersionId,action:e.Recursive?"recursive":"",tracker:e.tracker},function(o,c){if(o){var v=o.statusCode;return v&&v===404?u(null,{BucketNotFound:!0,statusCode:v}):u(o)}u(null,{statusCode:c.statusCode,headers:c.headers})})}function vt(e,u){var o={};e.VersionId&&(o.versionId=e.VersionId),Y.call(this,{Action:"name/cos:GetObjectACL",method:"GET",Bucket:e.Bucket,Region:e.Region,Key:e.Key,headers:e.Headers,qs:o,action:"acl",tracker:e.tracker},function(c,v){if(c)return u(c);var g=v.AccessControlPolicy||{},x=g.Owner||{},E=g.AccessControlList&&g.AccessControlList.Grant||[];E=i.isArray(E)?E:[E];var H=be(g);delete H.GrantWrite,v.headers&&v.headers["x-cos-acl"]&&(H.ACL=v.headers["x-cos-acl"]),H=i.extend(H,{Owner:x,Grants:E,statusCode:v.statusCode,headers:v.headers}),u(null,H)})}function pt(e,u){var o=e.Headers,c="";if(e.AccessControlPolicy){var v=i.clone(e.AccessControlPolicy||{}),g=v.Grants||v.Grant;g=i.isArray(g)?g:[g],delete v.Grant,delete v.Grants,v.AccessControlList={Grant:g},c=i.json2xml({AccessControlPolicy:v}),o["Content-Type"]="application/xml",o["Content-MD5"]=i.b64(i.md5(c))}i.each(o,function(x,E){E.indexOf("x-cos-grant-")===0&&(o[E]=$e(o[E]))}),Y.call(this,{Action:"name/cos:PutObjectACL",method:"PUT",Bucket:e.Bucket,Region:e.Region,Key:e.Key,action:"acl",headers:o,body:c,tracker:e.tracker},function(x,E){if(x)return u(x);u(null,{statusCode:E.statusCode,headers:E.headers})})}function yt(e,u){var o=e.Headers;o.Origin=e.Origin,o["Access-Control-Request-Method"]=e.AccessControlRequestMethod,o["Access-Control-Request-Headers"]=e.AccessControlRequestHeaders,Y.call(this,{Action:"name/cos:OptionsObject",method:"OPTIONS",Bucket:e.Bucket,Region:e.Region,Key:e.Key,headers:o,tracker:e.tracker},function(c,v){if(c)return c.statusCode&&c.statusCode===403?u(null,{OptionsForbidden:!0,statusCode:c.statusCode}):u(c);var g=v.headers||{};u(null,{AccessControlAllowOrigin:g["access-control-allow-origin"],AccessControlAllowMethods:g["access-control-allow-methods"],AccessControlAllowHeaders:g["access-control-allow-headers"],AccessControlExposeHeaders:g["access-control-expose-headers"],AccessControlMaxAge:g["access-control-max-age"],statusCode:v.statusCode,headers:v.headers})})}function Ct(e,u){var o=this,c=e.Headers;!c["Cache-Control"]&&!c["cache-control"]&&(c["Cache-Control"]="");var v=e.CopySource||"",g=i.getSourceParams.call(this,v);if(!g){u(i.error(new Error("CopySource format error")));return}var x=g.Bucket,E=g.Region,H=decodeURIComponent(g.Key);Y.call(this,{Scope:[{action:"name/cos:GetObject",bucket:x,region:E,prefix:H},{action:"name/cos:PutObject",bucket:e.Bucket,region:e.Region,prefix:e.Key}],method:"PUT",Bucket:e.Bucket,Region:e.Region,Key:e.Key,VersionId:e.VersionId,headers:e.Headers,tracker:e.tracker},function(ue,ae){if(ue)return u(ue);var xe=i.clone(ae.CopyObjectResult||{}),$=qe({ForcePathStyle:o.options.ForcePathStyle,protocol:o.options.Protocol,domain:o.options.Domain,bucket:e.Bucket,region:e.Region,object:e.Key,isLocation:!0});i.extend(xe,{Location:$,statusCode:ae.statusCode,headers:ae.headers}),u(null,xe)})}function Fe(e,u){var o=e.CopySource||"",c=i.getSourceParams.call(this,o);if(!c){u(i.error(new Error("CopySource format error")));return}var v=c.Bucket,g=c.Region,x=decodeURIComponent(c.Key);Y.call(this,{Scope:[{action:"name/cos:GetObject",bucket:v,region:g,prefix:x},{action:"name/cos:PutObject",bucket:e.Bucket,region:e.Region,prefix:e.Key}],method:"PUT",Bucket:e.Bucket,Region:e.Region,Key:e.Key,VersionId:e.VersionId,qs:{partNumber:e.PartNumber,uploadId:e.UploadId},headers:e.Headers,tracker:e.tracker},function(E,H){if(E)return u(E);var ue=i.clone(H.CopyPartResult||{});i.extend(ue,{statusCode:H.statusCode,headers:H.headers}),u(null,ue)})}function V(e,u){var o=e.Objects||[],c=e.Quiet;o=i.isArray(o)?o:[o];var v=i.json2xml({Delete:{Object:o,Quiet:c||!1}}),g=e.Headers;g["Content-Type"]="application/xml",g["Content-MD5"]=i.b64(i.md5(v));var x=i.map(o,function(E){return{action:"name/cos:DeleteObject",bucket:e.Bucket,region:e.Region,prefix:E.Key}});Y.call(this,{Scope:x,method:"POST",Bucket:e.Bucket,Region:e.Region,body:v,action:"delete",headers:g,tracker:e.tracker},function(E,H){if(E)return u(E);var ue=H.DeleteResult||{},ae=ue.Deleted||[],xe=ue.Error||[];ae=i.isArray(ae)?ae:[ae],xe=i.isArray(xe)?xe:[xe];var $=i.clone(ue);i.extend($,{Error:xe,Deleted:ae,statusCode:H.statusCode,headers:H.headers}),u(null,$)})}function R(e,u){var o=e.Headers;if(!e.RestoreRequest){u(i.error(new Error("missing param RestoreRequest")));return}var c=e.RestoreRequest||{},v=i.json2xml({RestoreRequest:c});o["Content-Type"]="application/xml",o["Content-MD5"]=i.b64(i.md5(v)),Y.call(this,{Action:"name/cos:RestoreObject",method:"POST",Bucket:e.Bucket,Region:e.Region,Key:e.Key,VersionId:e.VersionId,body:v,action:"restore",headers:o,tracker:e.tracker},u)}function O(e,u){var o=e.Tagging||{},c=o.TagSet||o.Tags||e.Tags||[];c=i.clone(i.isArray(c)?c:[c]);var v=i.json2xml({Tagging:{TagSet:{Tag:c}}}),g=e.Headers;g["Content-Type"]="application/xml",g["Content-MD5"]=i.b64(i.md5(v)),Y.call(this,{Action:"name/cos:PutObjectTagging",method:"PUT",Bucket:e.Bucket,Key:e.Key,Region:e.Region,body:v,action:"tagging",headers:g,VersionId:e.VersionId,tracker:e.tracker},function(x,E){if(x&&x.statusCode===204)return u(null,{statusCode:x.statusCode});if(x)return u(x);u(null,{statusCode:E.statusCode,headers:E.headers})})}function w(e,u){Y.call(this,{Action:"name/cos:GetObjectTagging",method:"GET",Key:e.Key,Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"tagging",VersionId:e.VersionId,tracker:e.tracker},function(o,c){if(o){if(o.statusCode===404&&o.error&&(o.error==="Not Found"||o.error.Code==="NoSuchTagSet")){var v={Tags:[],statusCode:o.statusCode};o.headers&&(v.headers=o.headers),u(null,v)}else u(o);return}var g=[];try{g=c.Tagging.TagSet.Tag||[]}catch{}g=i.clone(i.isArray(g)?g:[g]),u(null,{Tags:g,statusCode:c.statusCode,headers:c.headers})})}function D(e,u){Y.call(this,{Action:"name/cos:DeleteObjectTagging",method:"DELETE",Bucket:e.Bucket,Region:e.Region,Key:e.Key,headers:e.Headers,action:"tagging",VersionId:e.VersionId,tracker:e.tracker},function(o,c){if(o&&o.statusCode===204)return u(null,{statusCode:o.statusCode});if(o)return u(o);u(null,{statusCode:c.statusCode,headers:c.headers})})}function Q(e,u){var o=e.SelectType;if(!o)return u(i.error(new Error("missing param SelectType")));var c=e.SelectRequest||{},v=i.json2xml({SelectRequest:c}),g=e.Headers;g["Content-Type"]="application/xml",g["Content-MD5"]=i.b64(i.md5(v)),Y.call(this,{Action:"name/cos:GetObject",method:"POST",Bucket:e.Bucket,Region:e.Region,Key:e.Key,headers:e.Headers,action:"select",qs:{"select-type":e.SelectType},VersionId:e.VersionId,body:v,DataType:"arraybuffer",rawBody:!0,tracker:e.tracker},function(x,E){if(x&&x.statusCode===204)return u(null,{statusCode:x.statusCode});if(x)return u(x);var H=i.parseSelectPayload(E.body);u(null,{statusCode:E.statusCode,headers:E.headers,Body:H.body,Payload:H.payload})})}function ie(e,u){var o=this,c=e.Headers,v=e.tracker;!c["Cache-Control"]&&!c["cache-control"]&&(c["Cache-Control"]=""),!c["Content-Type"]&&!c["content-type"]&&(c["Content-Type"]=e.Body&&e.Body.type||"");var g=e.Body&&(e.UploadAddMetaMd5||o.options.UploadAddMetaMd5);g&&v&&v.setParams({md5StartTime:new Date().getTime()}),i.getBodyMd5(g,e.Body,function(x){x&&(e.Headers["x-cos-meta-md5"]=x),g&&v&&v.setParams({md5EndTime:new Date().getTime()}),Y.call(o,{Action:"name/cos:InitiateMultipartUpload",method:"POST",Bucket:e.Bucket,Region:e.Region,Key:e.Key,action:"uploads",headers:e.Headers,qs:e.Query,tracker:v},function(E,H){if(E)return v&&v.parent&&v.parent.setParams({errorNode:"multipartInit"}),u(E);if(H=i.clone(H||{}),H&&H.InitiateMultipartUploadResult)return u(null,i.extend(H.InitiateMultipartUploadResult,{statusCode:H.statusCode,headers:H.headers}));u(null,H)})},e.onHashProgress)}function ge(e,u){var o=this;i.getFileSize("multipartUpload",e,function(){var c=e.tracker,v=o.options.UploadCheckContentMd5;v&&c&&c.setParams({md5StartTime:new Date().getTime()}),i.getBodyMd5(v,e.Body,function(g){g&&(e.Headers["Content-MD5"]=i.b64(g)),v&&c&&c.setParams({md5EndTime:new Date().getTime()}),c&&c.setParams({partNumber:e.PartNumber}),Y.call(o,{Action:"name/cos:UploadPart",TaskId:e.TaskId,method:"PUT",Bucket:e.Bucket,Region:e.Region,Key:e.Key,qs:{partNumber:e.PartNumber,uploadId:e.UploadId},headers:e.Headers,onProgress:e.onProgress,body:e.Body||null,tracker:c},function(x,E){if(x)return c&&c.parent&&c.parent.setParams({errorNode:"multipartUpload"}),u(x);u(null,{ETag:i.attr(E.headers,"etag",""),statusCode:E.statusCode,headers:E.headers})})})})}function ke(e,u){for(var o=this,c=e.UploadId,v=e.Parts,g=e.tracker,x=0,E=v.length;x<E;x++)v[x].ETag&&v[x].ETag.indexOf('"')===0||(v[x].ETag='"'+v[x].ETag+'"');var H=i.json2xml({CompleteMultipartUpload:{Part:v}});H=H.replace(/\n\s*/g,"");var ue=e.Headers;ue["Content-Type"]="application/xml",ue["Content-MD5"]=i.b64(i.md5(H)),Y.call(this,{Action:"name/cos:CompleteMultipartUpload",method:"POST",Bucket:e.Bucket,Region:e.Region,Key:e.Key,qs:{uploadId:c},body:H,headers:ue,tracker:g},function(ae,xe){if(ae)return g&&g.parent&&g.parent.setParams({errorNode:"multipartComplete"}),u(ae);var $=qe({ForcePathStyle:o.options.ForcePathStyle,protocol:o.options.Protocol,domain:o.options.Domain,bucket:e.Bucket,region:o.options.UseAccelerate?"accelerate":e.Region,object:e.Key,isLocation:!0}),Re=xe.CompleteMultipartUploadResult||{};if(Re.ProcessResults&&(Re.UploadResult={OriginalInfo:{Key:Re.Key,Location:$,ETag:Re.ETag,ImageInfo:Re.ImageInfo},ProcessResults:Re.ProcessResults},delete Re.ImageInfo,delete Re.ProcessResults),Re.CallbackResult){var Ne=Re.CallbackResult;if(Ne.Status==="200"&&Ne.CallbackBody)try{Re.CallbackBody=JSON.parse(i.decodeBase64(Ne.CallbackBody))}catch{Re.CallbackBody={}}else Re.CallbackError=Ne.Error||{};delete Re.CallbackResult}if(Re.ReturnBodyResult){var Me=Re.ReturnBodyResult;if(Me.Status==="200"&&Me.ReturnBody)try{Re.ReturnBody=JSON.parse(i.decodeBase64(Me.ReturnBody))}catch{Re.ReturnBody={}}else Re.ReturnError={Code:Me.Code,Message:Me.Message,Status:Me.Status};delete Re.ReturnBodyResult}var Ke=i.extend(Re,{Location:$,statusCode:xe.statusCode,headers:xe.headers});u(null,Ke)})}function Be(e,u){var o={};o.delimiter=e.Delimiter,o["encoding-type"]=e.EncodingType,o.prefix=e.Prefix||"",o["max-uploads"]=e.MaxUploads,o["key-marker"]=e.KeyMarker,o["upload-id-marker"]=e.UploadIdMarker,o=i.clearKey(o);var c=e.tracker;c&&c.setParams({signStartTime:new Date().getTime()}),Y.call(this,{Action:"name/cos:ListMultipartUploads",ResourceKey:o.prefix,method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,qs:o,action:"uploads",tracker:c},function(v,g){if(v)return c&&c.parent&&c.parent.setParams({errorNode:"multipartList"}),u(v);if(g&&g.ListMultipartUploadsResult){var x=g.ListMultipartUploadsResult.Upload||[];x=i.isArray(x)?x:[x],g.ListMultipartUploadsResult.Upload=x}var E=i.clone(g.ListMultipartUploadsResult||{});i.extend(E,{statusCode:g.statusCode,headers:g.headers}),u(null,E)})}function we(e,u){var o={},c=e.tracker;o.uploadId=e.UploadId,o["encoding-type"]=e.EncodingType,o["max-parts"]=e.MaxParts,o["part-number-marker"]=e.PartNumberMarker,Y.call(this,{Action:"name/cos:ListParts",method:"GET",Bucket:e.Bucket,Region:e.Region,Key:e.Key,headers:e.Headers,qs:o,tracker:c},function(v,g){if(v)return c&&c.parent&&c.parent.setParams({errorNode:"multipartListPart"}),u(v);var x=g.ListPartsResult||{},E=x.Part||[];E=i.isArray(E)?E:[E],x.Part=E;var H=i.clone(x);i.extend(H,{statusCode:g.statusCode,headers:g.headers}),u(null,H)})}function Le(e,u){var o={};o.uploadId=e.UploadId,Y.call(this,{Action:"name/cos:AbortMultipartUpload",method:"DELETE",Bucket:e.Bucket,Region:e.Region,Key:e.Key,headers:e.Headers,qs:o,tracker:e.tracker},function(c,v){if(c)return u(c);u(null,{statusCode:v.statusCode,headers:v.headers})})}function Ie(e,u){Y.call(this,{method:e.Method,Bucket:e.Bucket,Region:e.Region,Key:e.Key,action:e.Action,headers:e.Headers,qs:e.Query,body:e.Body,Url:e.Url,rawBody:e.RawBody,DataType:e.DataType,tracker:e.tracker},function(o,c){if(o)return u(o);c&&c.body&&(c.Body=c.body,delete c.body),u(o,c)})}function Ve(e,u){var o=e.Headers;!o["Cache-Control"]&&!o["cache-control"]&&(o["Cache-Control"]=""),!o["Content-Type"]&&!o["content-type"]&&(o["Content-Type"]=e.Body&&e.Body.type||""),Y.call(this,{Action:"name/cos:AppendObject",method:"POST",Bucket:e.Bucket,Region:e.Region,action:"append",Key:e.Key,body:e.Body,qs:{position:e.Position},headers:e.Headers,tracker:e.tracker},function(c,v){if(c)return u(c);u(null,v)})}function tt(e){var u=this;return i.getAuth({SecretId:e.SecretId||this.options.SecretId||"",SecretKey:e.SecretKey||this.options.SecretKey||"",Bucket:e.Bucket,Region:e.Region,Method:e.Method,Key:e.Key,Query:e.Query,Headers:e.Headers,Expires:e.Expires,UseRawKey:u.options.UseRawKey,SystemClockOffset:u.options.SystemClockOffset})}function Ge(e,u){var o=this,c=e.UseAccelerate===void 0?o.options.UseAccelerate:e.UseAccelerate,v=qe({ForcePathStyle:o.options.ForcePathStyle,protocol:e.Protocol||o.options.Protocol,domain:e.Domain||o.options.Domain,bucket:e.Bucket,region:c?"accelerate":e.Region,object:e.Key}),g="";e.Query&&(g+=i.obj2str(e.Query)),e.QueryString&&(g+=(g?"&":"")+e.QueryString);var x=v;if(e.Sign!==void 0&&!e.Sign)return g&&(x+="?"+g),u(null,{Url:x}),x;var E=rt.call(this,{Bucket:e.Bucket,Region:e.Region,UseAccelerate:e.UseAccelerate,Url:v}),H=at.call(this,{Action:(e.Method||"").toUpperCase()==="PUT"?"name/cos:PutObject":"name/cos:GetObject",Bucket:e.Bucket||"",Region:e.Region||"",Method:e.Method||"get",Key:e.Key,Expires:e.Expires,Headers:e.Headers,Query:e.Query,SignHost:E,ForceSignHost:e.ForceSignHost===!1?!1:o.options.ForceSignHost},function(ue,ae){if(u){if(ue){u(ue);return}var xe=function(Ne){var Me=Ne.match(/q-url-param-list.*?(?=&)/g)[0],Ke="q-url-param-list="+encodeURIComponent(Me.replace(/q-url-param-list=/,"")).toLowerCase(),_e=new RegExp(Me,"g"),Xe=Ne.replace(_e,Ke);return Xe},$=v;$+="?"+(ae.Authorization.indexOf("q-signature")>-1?xe(ae.Authorization):"sign="+encodeURIComponent(ae.Authorization)),ae.SecurityToken&&($+="&x-cos-security-token="+ae.SecurityToken),ae.ClientIP&&($+="&clientIP="+ae.ClientIP),ae.ClientUA&&($+="&clientUA="+ae.ClientUA),ae.Token&&($+="&token="+ae.Token),g&&($+="&"+g),setTimeout(function(){u(null,{Url:$})})}});return H?(x+="?"+H.Authorization+(H.SecurityToken?"&x-cos-security-token="+H.SecurityToken:""),g&&(x+="&"+g)):g&&(x+="?"+g),x}function be(e){var u={GrantFullControl:[],GrantWrite:[],GrantRead:[],GrantReadAcp:[],GrantWriteAcp:[],ACL:""},o={FULL_CONTROL:"GrantFullControl",WRITE:"GrantWrite",READ:"GrantRead",READ_ACP:"GrantReadAcp",WRITE_ACP:"GrantWriteAcp"},c=e&&e.AccessControlList||{},v=c.Grant;v&&(v=i.isArray(v)?v:[v]);var g={READ:0,WRITE:0,FULL_CONTROL:0};return v&&v.length&&i.each(v,function(x){var E=x.Grantee.URI&&x.Grantee.URI.endsWith("/groups/global/AllUsers");x.Grantee.ID==="qcs::cam::anyone:anyone"||E?g[x.Permission]=1:x.Grantee.ID!==e.Owner.ID&&u[o[x.Permission]].push('id="'+x.Grantee.ID+'"')}),g.FULL_CONTROL||g.WRITE&&g.READ?u.ACL="public-read-write":g.READ?u.ACL="public-read":u.ACL="private",i.each(o,function(x){u[x]=$e(u[x].join(","))}),u}function $e(e){var u=e.split(","),o={},c,v;for(c=0;c<u.length;)v=u[c].trim(),o[v]?u.splice(c,1):(o[v]=!0,u[c]=v,c++);return u.join(",")}function qe(e){var u=e.region||"",o=e.bucket||"",c=o.substr(0,o.lastIndexOf("-")),v=o.substr(o.lastIndexOf("-")+1),g=e.domain,x=e.object;typeof g=="function"&&(g=g({Bucket:o,Region:u})),["http","https"].includes(e.protocol)&&(e.protocol=e.protocol+":");var E=e.protocol||(i.isBrowser&&(typeof location>"u"?"undefined":A(location))==="object"&&location.protocol==="http:"?"http:":"https:");g||(["cn-south","cn-south-2","cn-north","cn-east","cn-southwest","sg"].indexOf(u)>-1?g="{Region}.myqcloud.com":g="cos.{Region}.myqcloud.com",e.ForcePathStyle||(g="{Bucket}."+g)),g=g.replace(/\{\{AppId\}\}/gi,v).replace(/\{\{Bucket\}\}/gi,c).replace(/\{\{Region\}\}/gi,u).replace(/\{\{.*?\}\}/gi,""),g=g.replace(/\{AppId\}/gi,v).replace(/\{BucketName\}/gi,c).replace(/\{Bucket\}/gi,o).replace(/\{Region\}/gi,u).replace(/\{.*?\}/gi,""),/^[a-zA-Z]+:\/\//.test(g)||(g=E+"//"+g),g.slice(-1)==="/"&&(g=g.slice(0,-1));var H=g;return e.ForcePathStyle&&(H+="/"+o),H+="/",x&&(H+=i.camSafeUrlEncode(x).replace(/%2F/g,"/")),e.isLocation&&(H=H.replace(/^https?:\/\//,"")),H}var rt=function(u){var o=u.Url||u.Bucket&&u.Region;if(!o)return"";var c=u.UseAccelerate===void 0?this.options.UseAccelerate:u.UseAccelerate,v=u.Url||qe({ForcePathStyle:this.options.ForcePathStyle,protocol:this.options.Protocol,domain:this.options.Domain,bucket:u.Bucket,region:c?"accelerate":u.Region}),g=v.replace(/^https?:\/\/([^/]+)(\/.*)?$/,"$1");return g};function at(e,u){var o=i.clone(e.Headers),c="";i.each(o,function(Ee,ye){(Ee===""||["content-type","cache-control","expires"].indexOf(ye.toLowerCase())>-1)&&delete o[ye],ye.toLowerCase()==="host"&&(c=Ee)});var v=e.ForceSignHost!==!1;!c&&e.SignHost&&v&&(o.Host=e.SignHost);var g=!1,x=function(ye,Oe){g||(g=!0,Oe&&Oe.XCosSecurityToken&&!Oe.SecurityToken&&(Oe=i.clone(Oe),Oe.SecurityToken=Oe.XCosSecurityToken,delete Oe.XCosSecurityToken),u&&u(ye,Oe))},E=this,H=e.Bucket||"",ue=e.Region||"",ae=e.Key||"";E.options.ForcePathStyle&&H&&(ae=H+"/"+ae);var xe="/"+ae,$={},Re=e.Scope;if(!Re){var Ne=e.Action||"",Me=e.ResourceKey||e.Key||"";Re=e.Scope||[{action:Ne,bucket:H,region:ue,prefix:Me}]}var Ke=i.md5(JSON.stringify(Re));E._StsCache=E._StsCache||[],function(){var Ee,ye;for(Ee=E._StsCache.length-1;Ee>=0;Ee--){ye=E._StsCache[Ee];var Oe=Math.round(i.getSkewTime(E.options.SystemClockOffset)/1e3)+30;if(ye.StartTime&&Oe<ye.StartTime||Oe>=ye.ExpiredTime){E._StsCache.splice(Ee,1);continue}if(!ye.ScopeLimit||ye.ScopeLimit&&ye.ScopeKey===Ke){$=ye;break}}}();var _e=function(){var ye="";$.StartTime&&e.Expires?ye=$.StartTime+";"+($.StartTime+e.Expires*1):$.StartTime&&$.ExpiredTime&&(ye=$.StartTime+";"+$.ExpiredTime);var Oe=i.getAuth({SecretId:$.TmpSecretId,SecretKey:$.TmpSecretKey,Method:e.Method,Pathname:xe,Query:e.Query,Headers:o,Expires:e.Expires,UseRawKey:E.options.UseRawKey,SystemClockOffset:E.options.SystemClockOffset,KeyTime:ye,ForceSignHost:v}),Te={Authorization:Oe,SecurityToken:$.SecurityToken||$.XCosSecurityToken||"",Token:$.Token||"",ClientIP:$.ClientIP||"",ClientUA:$.ClientUA||"",SignFrom:"client"};x(null,Te)},Xe=function(ye){if(ye.Authorization){var Oe=!1,Te=ye.Authorization;if(Te)if(Te.indexOf(" ")>-1)Oe=!1;else if(Te.indexOf("q-sign-algorithm=")>-1&&Te.indexOf("q-ak=")>-1&&Te.indexOf("q-sign-time=")>-1&&Te.indexOf("q-key-time=")>-1&&Te.indexOf("q-url-param-list=")>-1)Oe=!0;else try{Te=atob(Te),Te.indexOf("a=")>-1&&Te.indexOf("k=")>-1&&Te.indexOf("t=")>-1&&Te.indexOf("r=")>-1&&Te.indexOf("b=")>-1&&(Oe=!0)}catch{}if(!Oe)return i.error(new Error("getAuthorization callback params format error"))}else{if(!ye.TmpSecretId)return i.error(new Error('getAuthorization callback params missing "TmpSecretId"'));if(!ye.TmpSecretKey)return i.error(new Error('getAuthorization callback params missing "TmpSecretKey"'));if(!ye.SecurityToken&&!ye.XCosSecurityToken)return i.error(new Error('getAuthorization callback params missing "SecurityToken"'));if(!ye.ExpiredTime)return i.error(new Error('getAuthorization callback params missing "ExpiredTime"'));if(ye.ExpiredTime&&ye.ExpiredTime.toString().length!==10)return i.error(new Error('getAuthorization callback params "ExpiredTime" should be 10 digits'));if(ye.StartTime&&ye.StartTime.toString().length!==10)return i.error(new Error('getAuthorization callback params "StartTime" should be 10 StartTime'))}return!1};if($.ExpiredTime&&$.ExpiredTime-i.getSkewTime(E.options.SystemClockOffset)/1e3>60)_e();else if(E.options.getAuthorization)E.options.getAuthorization.call(E,{Bucket:H,Region:ue,Method:e.Method,Key:ae,Pathname:xe,Query:e.Query,Headers:o,Scope:Re,SystemClockOffset:E.options.SystemClockOffset,ForceSignHost:v},function(Ee){typeof Ee=="string"&&(Ee={Authorization:Ee});var ye=Xe(Ee);if(ye)return x(ye);Ee.Authorization?x(null,Ee):($=Ee||{},$.Scope=Re,$.ScopeKey=Ke,E._StsCache.push($),_e())});else if(E.options.getSTS)E.options.getSTS.call(E,{Bucket:H,Region:ue},function(Ee){$=Ee||{},$.Scope=Re,$.ScopeKey=Ke,$.TmpSecretId||($.TmpSecretId=$.SecretId),$.TmpSecretKey||($.TmpSecretKey=$.SecretKey);var ye=Xe($);if(ye)return x(ye);E._StsCache.push($),_e()});else return function(){var Ee="";if(E.options.StartTime&&e.Expires){if(E.options.StartTime.toString().length!==10)return x(i.error(new Error('params "StartTime" should be 10 digits')));Ee=E.options.StartTime+";"+(E.options.StartTime+e.Expires*1)}else if(E.options.StartTime&&E.options.ExpiredTime){if(E.options.StartTime.toString().length!==10)return x(i.error(new Error('params "StartTime" should be 10 digits')));if(E.options.ExpiredTime.toString().length!==10)return x(i.error(new Error('params "ExpiredTime" should be 10 digits')));Ee=E.options.StartTime+";"+E.options.ExpiredTime*1}var ye=i.getAuth({SecretId:e.SecretId||E.options.SecretId,SecretKey:e.SecretKey||E.options.SecretKey,Method:e.Method,Pathname:xe,Query:e.Query,Headers:o,Expires:e.Expires,KeyTime:Ee,UseRawKey:E.options.UseRawKey,SystemClockOffset:E.options.SystemClockOffset,ForceSignHost:v}),Oe={Authorization:ye,SecurityToken:E.options.SecurityToken||E.options.XCosSecurityToken,SignFrom:"client"};return x(null,Oe),Oe}();return""}function kt(e){var u=this,o=!1,c=!1,v=!1,g=e.headers&&(e.headers.date||e.headers.Date)||e.error&&e.error.ServerTime;try{var x=e.error.Code,E=e.error.Message;(x==="RequestTimeTooSkewed"||x==="AccessDenied"&&E==="Request has expired")&&(c=!0)}catch{}if(e)if(c&&g){var H=Date.parse(g);this.options.CorrectClockSkew&&Math.abs(i.getSkewTime(this.options.SystemClockOffset)-H)>=3e4&&(console.error("error: Local time is too skewed."),this.options.SystemClockOffset=H-Date.now(),o=!0)}else Math.floor(e.statusCode/100)===5?(o=!0,v=!1):(e.message==="timeout"||e.message==="CORS blocked or network error")&&(o=!0,v=u.options.AutoSwitchHost);return{canRetry:o,networkError:v}}function St(e){var u=e.requestUrl,o=e.clientCalcSign,c=e.networkError;if(!this.options.AutoSwitchHost||!u||!o||!c)return!1;var v=/^https?:\/\/[^\/]*\.cos\.[^\/]*\.myqcloud\.com(\/.*)?$/,g=/^https?:\/\/[^\/]*\.cos\.accelerate\.myqcloud\.com(\/.*)?$/,x=v.test(u)&&!g.test(u);return x}function Y(e,u){var o=this;!e.headers&&(e.headers={}),!e.qs&&(e.qs={}),e.VersionId&&(e.qs.versionId=e.VersionId),e.qs=i.clearKey(e.qs),e.headers&&(e.headers=i.clearKey(e.headers)),e.qs&&(e.qs=i.clearKey(e.qs));var c=i.clone(e.qs);e.action&&(c[e.action]="");var v=e.url||e.Url,g=e.SignHost||rt.call(this,{Bucket:e.Bucket,Region:e.Region,Url:v}),x=e.tracker,E=function(ue){var ae=o.options.SystemClockOffset;x&&x.setParams({signStartTime:new Date().getTime(),httpRetryTimes:ue-1}),e.SwitchHost&&(g=g.replace(/myqcloud.com/,"tencentcos.cn"));var xe=N(N({},e),{},{Query:c,SignHost:g,ForceSignHost:o.options.ForceSignHost});delete xe.tracker,o.logger.debug({cate:"PROCESS",tag:"base",msg:"开始计算签名, opt=".concat(JSON.stringify(xe))}),at.call(o,{Bucket:e.Bucket||"",Region:e.Region||"",Method:e.method,Key:e.Key,Query:c,Headers:e.headers,SignHost:g,Action:e.Action,ResourceKey:e.ResourceKey,Scope:e.Scope,ForceSignHost:o.options.ForceSignHost,SwitchHost:e.SwitchHost},function($,Re){if($){o.logger.error({cate:"PROCESS",tag:"base",msg:"签名获取失败, err=".concat(JSON.stringify($.message))}),u($);return}x&&x.setParams({signEndTime:new Date().getTime(),httpStartTime:new Date().getTime()}),e.AuthData=Re,o.logger.debug({cate:"PROCESS",tag:"base",msg:"签名获取成功"}),o.logger.info({cate:"PROCESS",tag:"base",msg:"准备发起请求"}),xt.call(o,e,function(Ne,Me){x&&x.setParams({httpEndTime:new Date().getTime()});var Ke=!1,_e=!1;if(Ne){var Xe=kt.call(o,Ne);Ke=Xe.canRetry||ae!==o.options.SystemClockOffset,_e=Xe.networkError,o.logger.error({cate:"PROCESS",tag:"network",msg:"请求失败, err=".concat(JSON.stringify(Ne),", canRetry=").concat(Ke,", networkError=").concat(_e,", tryTimes=").concat(ue)})}if(Ne&&ue<4&&Ke){e.headers&&(delete e.headers.Authorization,delete e.headers.token,delete e.headers.clientIP,delete e.headers.clientUA,e.headers["x-cos-security-token"]&&delete e.headers["x-cos-security-token"],e.headers["x-ci-security-token"]&&delete e.headers["x-ci-security-token"]);var Ee=St.call(o,{requestUrl:(Ne==null?void 0:Ne.url)||"",clientCalcSign:Re.SignFrom==="client",networkError:_e});e.SwitchHost=Ee,e.headers["x-cos-sdk-retry"]=!0,o.logger.info({cate:"PROCESS",tag:"base",msg:"重试请求, 重试第".concat(ue,"次")}),E(ue+1)}else o.logger.info({cate:"PROCESS",tag:"base",msg:"请求完成"}),u(Ne,Me)})})};E(1)}function xt(e,u){var o=this,c=e.TaskId;if(!(c&&!o._isRunningTask(c))){var v=e.Bucket,g=e.Region,x=e.Key,E=e.method||"GET",H=e.Url||e.url,ue=e.body,ae=e.rawBody;o.options.UseAccelerate&&(g="accelerate"),H=H||qe({ForcePathStyle:o.options.ForcePathStyle,protocol:o.options.Protocol,domain:o.options.Domain,bucket:v,region:g,object:x}),e.SwitchHost&&(H=H.replace(/myqcloud.com/,"tencentcos.cn"));var xe=x?H:"";e.action&&(H=H+"?"+(i.isIOS_QQ?"".concat(e.action,"="):e.action)),e.qsStr&&(H.indexOf("?")>-1?H=H+"&"+e.qsStr:H=H+"?"+e.qsStr);var $={method:E,url:H,headers:e.headers,qs:e.qs,body:ue},Re="x-cos-security-token";if(i.isCIHost(H)&&(Re="x-ci-security-token"),$.headers.Authorization=e.AuthData.Authorization,e.AuthData.Token&&($.headers.token=e.AuthData.Token),e.AuthData.ClientIP&&($.headers.clientIP=e.AuthData.ClientIP),e.AuthData.ClientUA&&($.headers.clientUA=e.AuthData.ClientUA),e.AuthData.SecurityToken&&($.headers[Re]=e.AuthData.SecurityToken),e.Action&&($.action=e.Action),$.key=e.Key||e.ResourceKey,$.headers&&($.headers=i.clearKey($.headers)),$=i.clearKey($),e.onProgress&&typeof e.onProgress=="function"){var Ne=ue&&(ue.size||ue.length)||0;$.onProgress=function(Te){if(!(c&&!o._isRunningTask(c))){var De=Te?Te.loaded:0;e.onProgress({loaded:De,total:Ne})}}}e.onDownloadProgress&&($.onDownloadProgress=e.onDownloadProgress),e.DataType&&($.dataType=e.DataType),this.options.Timeout&&($.timeout=this.options.Timeout),o.options.ForcePathStyle&&($.pathStyle=o.options.ForcePathStyle);var Me=i.uuid();o.logger.info({cate:"PROCESS",tag:"network",msg:"[Request] ".concat(Me,", requestOpt=").concat(JSON.stringify($))}),o.emit("before-send",$);var Ke=$.url.includes("accelerate."),_e=$.qs?Object.keys($.qs).map(function(Te){return"".concat(Te,"=").concat($.qs[Te])}).join("&"):"",Xe=_e?$.url+"?"+_e:$.url;if(e.tracker){var Ee;e.tracker.setParams({url:Xe,httpMethod:$.method,accelerate:Ke,httpSize:((Ee=$.body)===null||Ee===void 0?void 0:Ee.size)||0}),e.tracker.parent&&!e.tracker.parent.params.url&&e.tracker.parent.setParams({url:xe,accelerate:Ke})}var ye=(o.options.Request||M)($,function(Te){if(!(Te&&Te.error==="abort")){var De={options:$,error:Te&&Te.error,statusCode:Te&&Te.statusCode||0,statusMessage:Te&&Te.statusMessage||"",headers:Te&&Te.headers||{},body:Te&&Te.body};o.emit("after-receive",De);var mt=De.error,ct=De.body,Ze={statusCode:De.statusCode,statusMessage:De.statusMessage,headers:De.headers},It=mt?"[error]":"[success]";o.logger.info({cate:"PROCESS",tag:"network",msg:"[Response] ".concat(Me,", ").concat(It,", response=").concat(JSON.stringify(Ze))});var Bt,nt=function(ot,Ue){if(c&&o.off("inner-kill-task",Oe),!Bt){Bt=!0;var it={};if(Ze&&Ze.statusCode&&(it.statusCode=Ze.statusCode),Ze&&Ze.headers&&(it.headers=Ze.headers),ot)$.url&&(it.url=$.url),$.method&&(it.method=$.method),ot=i.extend(ot||{},it),u(ot,null);else{if(e.Action==="name/cos:PutObject"){var Rt={};for(var Pt in e.headers){var jt=Pt.toLowerCase();Rt[jt]=e.headers[Pt]}Rt["x-cos-callback"]?Ue.Error?(Ue.CallbackError=i.clone(Ue.Error),delete Ue.Error):Ue.CallbackBody=i.clone(Ue):Rt["x-cos-return-body"]&&(Ue.Error?(Ue.ReturnError=i.clone(Ue.Error),delete Ue.Error):Ue.ReturnBody=i.clone(Ue))}Ue=i.extend(Ue||{},it),u(null,Ue)}ye=null}};if(mt)return nt(i.error(mt));var ut=Ze.statusCode,Et=Math.floor(ut/100)===2;if(ae){if(Et)return nt(null,{body:ct});if(ct instanceof Blob){i.readAsBinaryString(ct,function(At){var ot=i.parseResBody(At),Ue=ot.Error||ot;return nt(i.error(new Error(Ue.Message||"response body error"),{code:Ue.Code,error:Ue}))});return}}var Tt=i.parseResBody(ct),lt=Tt.Error||Tt;Et?nt(null,Tt):lt?nt(i.error(new Error(lt.Message),{code:lt.Code,error:lt})):ut?nt(i.error(new Error(Ze.statusMessage),{code:""+ut})):ut&&nt(i.error(new Error("statusCode error")))}}),Oe=function(De){De.TaskId===c&&(ye&&ye.abort&&ye.abort(),o.off("inner-kill-task",Oe))};c&&o.on("inner-kill-task",Oe)}}var bt={getService:p,putBucket:l,headBucket:C,getBucket:f,deleteBucket:k,putBucketAcl:S,getBucketAcl:b,putBucketCors:P,getBucketCors:j,deleteBucketCors:z,getBucketLocation:q,getBucketPolicy:d,putBucketPolicy:h,deleteBucketPolicy:m,putBucketTagging:s,getBucketTagging:n,deleteBucketTagging:t,putBucketLifecycle:r,getBucketLifecycle:a,deleteBucketLifecycle:y,putBucketVersioning:I,getBucketVersioning:T,putBucketReplication:K,getBucketReplication:_,deleteBucketReplication:Z,putBucketWebsite:X,getBucketWebsite:ne,deleteBucketWebsite:oe,putBucketReferer:Se,getBucketReferer:le,putBucketDomain:se,getBucketDomain:ee,deleteBucketDomain:W,putBucketOrigin:te,getBucketOrigin:de,deleteBucketOrigin:he,putBucketLogging:re,getBucketLogging:ce,putBucketInventory:pe,postBucketInventory:Ce,getBucketInventory:Ae,listBucketInventory:me,deleteBucketInventory:je,putBucketAccelerate:We,getBucketAccelerate:He,putBucketEncryption:Qe,getBucketEncryption:Ye,deleteBucketEncryption:ze,getObject:ft,headObject:Je,listObjectVersions:st,putObject:ht,deleteObject:gt,getObjectAcl:vt,putObjectAcl:pt,optionsObject:yt,putObjectCopy:Ct,deleteMultipleObject:V,restoreObject:R,putObjectTagging:O,getObjectTagging:w,deleteObjectTagging:D,selectObjectContent:Q,appendObject:Ve,uploadPartCopy:Fe,multipartInit:ie,multipartUpload:ge,multipartComplete:ke,multipartList:Be,multipartListPart:we,multipartAbort:Le,request:Ie,getObjectUrl:Ge,getAuth:tt};function wt(e,u,o){i.each(["Cors","Acl"],function(c){if(e.slice(-c.length)===c){var v=e.slice(0,-c.length)+c.toUpperCase(),g=i.apiWrapper(e,u),x=!1;o[v]=function(){!x&&console.warn("warning: cos."+v+" has been deprecated. Please Use cos."+e+" instead."),x=!0,g.apply(this,arguments)}}})}L.exports.init=function(e,u){u.transferToTaskMethod(bt,"putObject"),i.each(bt,function(o,c){e.prototype[c]=i.apiWrapper(c,o),wt(c,o,e.prototype)})}},"./src/cos.js":function(L,J,B){var U=B("./src/util.js"),A=B("./src/event.js"),F=B("./src/task.js"),N=B("./src/base.js"),M=B("./src/advance.js"),i=B("./src/logger.js"),p=B("./package.json"),l={AppId:"",SecretId:"",SecretKey:"",SecurityToken:"",StartTime:0,ExpiredTime:0,ChunkRetryTimes:2,FileParallelLimit:3,ChunkParallelLimit:3,ChunkSize:1024*1024,SliceSize:1024*1024,CopyChunkParallelLimit:20,CopyChunkSize:1024*1024*10,CopySliceSize:1024*1024*10,MaxPartNumber:1e4,ProgressInterval:1e3,Domain:"",ServiceDomain:"",Protocol:"",CompatibilityMode:!1,ForcePathStyle:!1,UseRawKey:!1,Timeout:0,CorrectClockSkew:!0,SystemClockOffset:0,UploadCheckContentMd5:!1,UploadQueueSize:1e4,UploadAddMetaMd5:!1,UploadIdCacheLimit:50,UseAccelerate:!1,ForceSignHost:!0,AutoSwitchHost:!0,CopySourceParser:null,ObjectKeySimplifyCheck:!0,DeepTracker:!1,TrackerDelay:5e3,CustomId:"",BeaconReporter:null,ClsReporter:null,EnableLog:!1,EnableLogcat:!1,LogLevel:"VERBOSE",ClsLogger:null,LogExtras:{}},C=function(k){var S,b,P=this;if(this.options=U.extend(U.clone(l),k||{}),this.options.FileParallelLimit=Math.max(1,this.options.FileParallelLimit),this.options.ChunkParallelLimit=Math.max(1,this.options.ChunkParallelLimit),this.options.ChunkRetryTimes=Math.max(0,this.options.ChunkRetryTimes),this.options.ChunkSize=Math.max(1024*1024,this.options.ChunkSize),this.options.CopyChunkParallelLimit=Math.max(1,this.options.CopyChunkParallelLimit),this.options.CopyChunkSize=Math.max(1024*1024,this.options.CopyChunkSize),this.options.CopySliceSize=Math.max(0,this.options.CopySliceSize),this.options.MaxPartNumber=Math.max(1024,Math.min(1e4,this.options.MaxPartNumber)),this.options.Timeout=Math.max(0,this.options.Timeout),this.options.EnableReporter=this.options.BeaconReporter||this.options.ClsReporter,this.options.AppId&&console.warn('warning: AppId has been deprecated, Please put it at the end of parameter Bucket(E.g: "test-1250000000").'),this.options.SecretId&&this.options.SecretId.indexOf(" ")>-1&&(console.error("error: SecretId格式错误，请检查"),console.error("error: SecretId format is incorrect. Please check")),this.options.SecretKey&&this.options.SecretKey.indexOf(" ")>-1&&(console.error("error: SecretKey格式错误，请检查"),console.error("error: SecretKey format is incorrect. Please check")),U.isNode()&&(console.log("Tip: Next.js、Nuxt.js 等服务端渲染技术可正常使用JavaScript SDK，请忽略下方 nodejs 环境警告"),console.warn("warning: cos-js-sdk-v5 不支持 nodejs 环境使用，请改用 cos-nodejs-sdk-v5，参考文档： https://cloud.tencent.com/document/product/436/8629"),console.warn("warning: cos-js-sdk-v5 does not support nodejs environment. Please use cos-nodejs-sdk-v5 instead. See: https://cloud.tencent.com/document/product/436/8629")),this.options.ForcePathStyle)throw console.warn("cos-js-sdk-v5不再支持使用path-style，仅支持使用virtual-hosted-style，参考文档：https://cloud.tencent.com/document/product/436/96243"),new Error("ForcePathStyle is not supported");A.init(this),F.init(this),this.logger=new i({enableLog:this.options.EnableLog,enableLogcat:this.options.EnableLogcat,level:(S=this.options.LogLevel)!==null&&S!==void 0?S:"VERBOSE",clsLogger:this.options.ClsLogger,logExtras:(b=this.options.LogExtras)!==null&&b!==void 0?b:{}}),this.options.EnableLog&&(A.init(this.logger),this.logger.on("log-message",function(j){P.emit("log-message",j)}))};N.init(C,F),M.init(C,F),C.util={md5:U.md5,xml2json:U.xml2json,json2xml:U.json2xml,encodeBase64:U.encodeBase64},C.getAuthorization=U.getAuth,C.version=p.version,L.exports=C},"./src/event.js":function(L,J){var B=function(F){var N={},M=function(p){return!N[p]&&(N[p]=[]),N[p]};F.on=function(i,p){i==="task-list-update"&&console.warn('warning: Event "'+i+'" has been deprecated. Please use "list-update" instead.'),M(i).push(p)},F.off=function(i,p){for(var l=M(i),C=l.length-1;C>=0;C--)p===l[C]&&l.splice(C,1)},F.emit=function(i,p){for(var l=M(i).map(function(f){return f}),C=0;C<l.length;C++)l[C](p)}},U=function(){B(this)};L.exports.init=B,L.exports.EventProxy=U},"./src/logger.js":function(L,J,B){var U=B("./node_modules/@babel/runtime/helpers/classCallCheck.js"),A=B("./node_modules/@babel/runtime/helpers/createClass.js"),F=B("./node_modules/@babel/runtime/helpers/defineProperty.js"),N=B("./package.json"),M=N.version,i=["VERBOSE","DEBUG","INFO","WARN","ERROR"],p=function(){function l(C){var f;U(this,l),F(this,"level","VERBOSE"),F(this,"clsLogger",null),F(this,"logExtras",{}),this.enableLog=(f=C.enableLog)!==null&&f!==void 0?f:!1,this.level=C.level||"VERBOSE",i.includes(this.level)||(this.level="VERBOSE"),this.enableLogcat=C.enableLogcat,this.clsLogger=C.clsLogger,this.logExtras=C.logExtras}return A(l,[{key:"info",value:function(){if(["VERBOSE","INFO"].includes(this.level)){for(var f=arguments.length,k=new Array(f),S=0;S<f;S++)k[S]=arguments[S];this.log.apply(this,["info"].concat(k))}}},{key:"debug",value:function(){if(["VERBOSE","DEBUG"].includes(this.level)){for(var f=arguments.length,k=new Array(f),S=0;S<f;S++)k[S]=arguments[S];this.log.apply(this,["debug"].concat(k))}}},{key:"warn",value:function(){if(["VERBOSE","WARN"].includes(this.level)){for(var f=arguments.length,k=new Array(f),S=0;S<f;S++)k[S]=arguments[S];this.log.apply(this,["warn"].concat(k))}}},{key:"error",value:function(){if(["VERBOSE","ERROR"].includes(this.level)){for(var f=arguments.length,k=new Array(f),S=0;S<f;S++)k[S]=arguments[S];this.log.apply(this,["error"].concat(k))}}},{key:"log",value:function(){if(this.enableLog){var f=arguments.length<=0?void 0:arguments[0],k=arguments.length<=1?void 0:arguments[1],S=k.cate,b=S===void 0?"base":S,P=k.tag,j=P===void 0?"base":P,z=k.msg,q={version:"cos-js-sdk-v5-".concat(M),timestamp:new Date().toISOString(),cate:"[".concat(b.toUpperCase(),"]"),tag:"[".concat(j.toUpperCase(),"]"),msg:z,extras:this.logExtras};this.enableLogcat&&console[f]("[".concat(q.version,"] ").concat(q.timestamp," ").concat(q.cate," ").concat(q.tag," ").concat(q.msg," ").concat(q.extras?JSON.stringify(q.extras):"")),this.clsLogger&&this.clsLogger.log(q,!1),this.emit("log-message",q)}}}])}();L.exports=p},"./src/session.js":function(L,J,B){var U=B("./src/util.js"),A="cos_sdk_upload_cache",F=30*24*3600,N,M,i=function(){try{var S=JSON.parse(localStorage.getItem(A))}catch{}S||(S=[]),N=S},p=function(){try{N.length?localStorage.setItem(A,JSON.stringify(N)):localStorage.removeItem(A)}catch{}},l=function(){if(!N){i.call(this);for(var S=!1,b=Math.round(Date.now()/1e3),P=N.length-1;P>=0;P--){var j=N[P][2];(!j||j+F<b)&&(N.splice(P,1),S=!0)}S&&p()}},C=function(){M||(M=setTimeout(function(){p(),M=null},400))},f={using:{},setUsing:function(S){f.using[S]=!0},removeUsing:function(S){delete f.using[S]},getFileId:function(S,b,P,j){return S.name&&S.size&&S.lastModifiedDate&&b?U.md5([S.name,S.size,S.lastModifiedDate,b,P,j].join("::")):null},getCopyFileId:function(S,b,P,j,z){var q=b["content-length"],h=b.etag||"",d=b["last-modified"];return S&&P?U.md5([S,q,h,d,P,j,z].join("::")):null},getUploadIdList:function(S){if(!S)return null;l.call(this);for(var b=[],P=0;P<N.length;P++)N[P][0]===S&&b.push(N[P][1]);return b.length?b:null},saveUploadId:function(S,b,P){if(l.call(this),!!S){for(var j=N.length-1;j>=0;j--){var z=N[j];z[0]===S&&z[1]===b&&N.splice(j,1)}N.unshift([S,b,Math.round(Date.now()/1e3)]),N.length>P&&N.splice(P),C()}},removeUploadId:function(S){l.call(this),delete f.using[S];for(var b=N.length-1;b>=0;b--)N[b][1]===S&&N.splice(b,1);C()}};L.exports=f},"./src/task.js":function(L,J,B){var U=B("./src/session.js"),A=B("./src/util.js"),F={},N=function(p,l){F[l]=p[l],p[l]=function(C,f){C.SkipTask?F[l].call(this,C,f):this._addTask(l,C,f)}},M=function(p){var l=[],C={},f=0,k=0,S=function(d){var m={id:d.id,Bucket:d.Bucket,Region:d.Region,Key:d.Key,FilePath:d.FilePath,state:d.state,loaded:d.loaded,size:d.size,speed:d.speed,percent:d.percent,hashPercent:d.hashPercent,error:d.error};return d.FilePath&&(m.FilePath=d.FilePath),d._custom&&(m._custom=d._custom),m},b=function(){var h,d=function(){h=0,p.emit("task-list-update",{list:A.map(l,S)}),p.emit("list-update",{list:A.map(l,S)})};return function(){h||(h=setTimeout(d))}}(),P=function(){if(!(l.length<=p.options.UploadQueueSize)){for(var d=0;d<k&&d<l.length&&l.length>p.options.UploadQueueSize;){var m=l[d].state==="waiting"||l[d].state==="checking"||l[d].state==="uploading";!l[d]||!m?(C[l[d].id]&&delete C[l[d].id],l.splice(d,1),k--):d++}b()}},j=function(){if(!(f>=p.options.FileParallelLimit)){for(;l[k]&&l[k].state!=="waiting";)k++;if(!(k>=l.length)){var d=l[k];k++,f++,d.state="checking",d.params.onTaskStart&&d.params.onTaskStart(S(d)),!d.params.UploadData&&(d.params.UploadData={});var m=A.formatParams(d.api,d.params);F[d.api].call(p,m,function(s,n){p._isRunningTask(d.id)&&((d.state==="checking"||d.state==="uploading")&&(d.state=s?"error":"success",s&&(d.error=s),f--,b(),j(),d.callback&&d.callback(s,n),d.state==="success"&&(d.params&&(delete d.params.UploadData,delete d.params.Body,delete d.params),delete d.callback)),P())}),b(),setTimeout(j)}}},z=function(d,m){var s=C[d];if(s){var n=s&&s.state==="waiting",t=s&&(s.state==="checking"||s.state==="uploading");if(m==="canceled"&&s.state!=="canceled"||m==="paused"&&n||m==="paused"&&t){s.state=m,p.emit("inner-kill-task",{TaskId:d,toState:m});try{var r=s&&s.params&&s.params.UploadData.UploadId}catch{}m==="canceled"&&r&&U.removeUsing(r),b(),t&&(f--,j()),m==="canceled"&&(s.params&&(delete s.params.UploadData,delete s.params.Body,delete s.params),delete s.callback)}P()}};p._addTasks=function(h){A.each(h,function(d){p._addTask(d.api,d.params,d.callback,!0)}),b()};var q=!0;p._addTask=function(h,d,m,s){d=A.formatParams(h,d);var n=A.uuid();d.TaskId=n,d.onTaskReady&&d.onTaskReady(n),d.TaskReady&&(d.TaskReady(n),q&&console.warn('warning: Param "TaskReady" has been deprecated. Please use "onTaskReady" instead.'),q=!1);var t={params:d,callback:m,api:h,index:l.length,id:n,Bucket:d.Bucket,Region:d.Region,Key:d.Key,FilePath:d.FilePath||"",state:"waiting",loaded:0,size:0,speed:0,percent:0,hashPercent:0,error:null,_custom:d._custom},r=d.onHashProgress;d.onHashProgress=function(y){p._isRunningTask(t.id)&&(t.hashPercent=y.percent,r&&r(y),b())};var a=d.onProgress;return d.onProgress=function(y){p._isRunningTask(t.id)&&(t.state==="checking"&&(t.state="uploading"),t.loaded=y.loaded,t.speed=y.speed,t.percent=y.percent,a&&a(y),b())},A.getFileSize(h,d,function(y,I){if(y)return m(A.error(y));C[n]=t,l.push(t),t.size=I,!s&&b(),j(),P()}),n},p._isRunningTask=function(h){var d=C[h];return!!(d&&(d.state==="checking"||d.state==="uploading"))},p.getTaskList=function(){return A.map(l,S)},p.cancelTask=function(h){z(h,"canceled")},p.pauseTask=function(h){z(h,"paused")},p.restartTask=function(h){var d=C[h];d&&(d.state==="paused"||d.state==="error")&&(d.state="waiting",b(),k=Math.min(k,d.index),j())},p.isUploadRunning=function(){return f||k<l.length}};L.exports.transferToTaskMethod=N,L.exports.init=M},"./src/tracker.js":function(L,J,B){var U=B("./node_modules/@babel/runtime/helpers/classCallCheck.js"),A=B("./node_modules/@babel/runtime/helpers/createClass.js"),F=B("./node_modules/@babel/runtime/helpers/typeof.js"),N=B("./package.json"),M=null,i=function(m,s){if(!M){if(typeof m!="function")throw new Error("Beacon not found");M=new m({appkey:"0WEB05PY6MHRGK0U",versionCode:N.version,channelID:"js_sdk",openid:"openid",unionid:"unid",strictMode:!1,delay:s,sessionDuration:60*1e3})}return M},p=function(m){return!m||m<0?0:(m/1e3).toFixed(3)},l={getUid:function(){var m=function(){return((1+Math.random())*65536|0).toString(16).substring(1)};return m()+m()+"-"+m()+"-"+m()+"-"+m()+"-"+m()+m()+m()},getNetType:function(){if((typeof navigator>"u"?"undefined":F(navigator))==="object"){var m=navigator.connection||navigator.mozConnection||navigator.webkitConnection;return(m==null?void 0:m.type)||(m==null?void 0:m.effectiveType)||"unknown"}return"unknown"},getProtocol:function(){return(typeof location>"u"?"undefined":F(location))==="object"?location.protocol.replace(/:/,""):"unknown protocol"},getOsType:function(){if((typeof navigator>"u"?"undefined":F(navigator))!=="object")return"unknown os";var m=navigator.userAgent.toLowerCase(),s=/macintosh|mac os x/i.test(navigator.userAgent);return m.indexOf("win32")>=0||m.indexOf("wow32")>=0?"win32":m.indexOf("win64")>=0||m.indexOf("wow64")>=0?"win64":s?"mac":"unknown os"},isMobile:function(){var m=/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i;return!!((typeof navigator>"u"?"undefined":F(navigator))==="object"&&navigator.userAgent.match(m))},isAndroid:function(){var m=/(Android|Adr|Linux)/i;return!!((typeof navigator>"u"?"undefined":F(navigator))==="object"&&navigator.userAgent.match(m))},isIOS:function(){var m=/(iPhone|iPod|iPad|iOS)/i;return!!((typeof navigator>"u"?"undefined":F(navigator))==="object"&&navigator.userAgent.match(m))},isOtherMobile:function(){return C&&!isAndroid&&!isIOS},getUA:function(){if((typeof navigator>"u"?"undefined":F(navigator))!=="object")return"unknown device";var m=navigator.userAgent;return m}},C=l.isMobile(),f=l.isAndroid()?"android":l.isIOS?"ios":"other_mobile",k=l.getOsType(),S=C?f:k,b=l.getUA(),P=l.getProtocol(),j=function(m){return["putObject","sliceUploadFile","uploadFile","uploadFiles"].includes(m)?"UploadTask":m==="getObject"?"DownloadTask":["putObjectCopy","sliceCopyFile"].includes(m)?"CopyTask":m};function z(d){return d.replace(/([A-Z])/g,"_$1").toLowerCase()}function q(d){var m={},s=["sdkVersionName","sdkVersionCode","osName","networkType","requestName","requestResult","bucket","region","appid","accelerate","url","host","requestPath","userAgent","networkProtocol","httpMethod","httpSize","httpSpeed","httpTookTime","httpMd5","httpSign","httpFullTime","httpDomain","partNumber","httpRetryTimes","customId","traceId","realApi"],n=[].concat(s,["errorNode","errorCode","errorName","errorMessage","errorRequestId","errorHttpCode","errorServiceName","errorType","fullError"]),t=d.requestResult==="Success"?s:n;for(var r in d)if(t.includes(r)){var a=z(r);m[a]=d[r]}return m.request_name=d.realApi?j(d.realApi):d.requestName,m}var h=function(){function d(m){U(this,d);var s=m.parent,n=m.traceId,t=m.bucket,r=m.region,a=m.apiName,y=m.realApi,I=m.httpMethod,T=m.fileKey,K=m.fileSize,_=m.accelerate,Z=m.customId,X=m.delay,ne=m.deepTracker,oe=m.Beacon,Se=m.clsReporter,le=t&&t.substr(t.lastIndexOf("-")+1)||"";this.parent=s,this.deepTracker=ne,this.delay=X,Se&&!this.clsReporter&&(this.clsReporter=Se),this.params={sdkVersionName:"cos-js-sdk-v5",sdkVersionCode:N.version,osName:S,networkType:"",requestName:a||"",requestResult:"",realApi:y,bucket:t,region:r,accelerate:_,httpMethod:I,url:"",host:"",httpDomain:"",requestPath:T||"",userAgent:b,networkProtocol:P,errorType:"",errorCode:"",errorName:"",errorMessage:"",errorRequestId:"",errorHttpCode:0,errorServiceName:"",errorNode:"",httpTookTime:0,httpSize:K||0,httpMd5:0,httpSign:0,httpFullTime:0,httpSpeed:0,md5StartTime:0,md5EndTime:0,signStartTime:0,signEndTime:0,httpStartTime:0,httpEndTime:0,startTime:new Date().getTime(),endTime:0,traceId:n||l.getUid(),appid:le,partNumber:0,httpRetryTimes:0,customId:Z||"",partTime:0},oe&&(this.beacon=i(oe,X))}return A(d,[{key:"formatResult",value:function(s,n){var t,r,a,y,I,T,K=new Date().getTime(),_=l.getNetType(),Z=s?(s==null?void 0:s.code)||(s==null||(t=s.error)===null||t===void 0?void 0:t.code)||(s==null||(r=s.error)===null||r===void 0?void 0:r.Code):"",X=s?(s==null?void 0:s.message)||(s==null||(a=s.error)===null||a===void 0?void 0:a.message)||(s==null||(y=s.error)===null||y===void 0?void 0:y.Message):"",ne=X,oe=s?(s==null?void 0:s.resource)||(s==null||(I=s.error)===null||I===void 0?void 0:I.resource)||(s==null||(T=s.error)===null||T===void 0?void 0:T.Resource):"",Se=s?s==null?void 0:s.statusCode:n.statusCode,le=s?(s==null?void 0:s.headers)&&(s==null?void 0:s.headers["x-cos-request-id"]):(n==null?void 0:n.headers)&&(n==null?void 0:n.headers["x-cos-request-id"]),se=s?le?"Server":"Client":"";this.params.requestName==="getObject"&&(this.params.httpSize=n?n.headers&&n.headers["content-length"]:0);var ee=this.params.realApi==="sliceUploadFile",W=this.params.realApi==="sliceCopyFile";if(ee||W){var te=this.params.httpSize/1024/this.params.partTime;Object.assign(this.params,{httpSpeed:te<0?0:te.toFixed(3)})}else{var de=K-this.params.startTime,he=this.params.httpEndTime-this.params.httpStartTime,re=this.params.httpSize/1024/(he/1e3),ce=this.params.md5EndTime-this.params.md5StartTime,ve=this.params.signEndTime-this.params.signStartTime;this.parent&&(this.parent.addParamValue("httpTookTime",p(he)),this.parent.addParamValue("httpFullTime",p(de)),this.parent.addParamValue("httpMd5",p(ce)),this.parent.addParamValue("httpSign",p(ve)),["multipartUpload","uploadPartCopy","putObjectCopy"].includes(this.params.requestName)&&this.parent.addParamValue("partTime",p(he))),Object.assign(this.params,{httpFullTime:p(de),httpMd5:p(ce),httpSign:p(ve),httpTookTime:p(he),httpSpeed:re<0?0:re.toFixed(3)})}if(Object.assign(this.params,{networkType:_,requestResult:s?"Failure":"Success",errorType:se,errorCode:Z,errorHttpCode:Se,errorName:ne,errorMessage:X,errorServiceName:oe,errorRequestId:le}),s&&(!Z||!X)&&(this.params.fullError=s?JSON.stringify(s):""),this.params.url){try{var pe=/^http(s)?:\/\/(.*?)\//.exec(this.params.url);this.params.host=pe[2]}catch{this.params.host=this.params.url}this.params.httpDomain=this.params.host}}},{key:"report",value:function(s,n){if(!(!this.beacon&&!this.clsReporter)){this.formatResult(s,n);var t=q(this.params);this.beacon&&this.sendEventsToBeacon(t),this.clsReporter&&this.sendEventsToCLS(t)}}},{key:"setParams",value:function(s){Object.assign(this.params,s)}},{key:"addParamValue",value:function(s,n){this.params[s]=(+this.params[s]+ +n).toFixed(3)}},{key:"sendEventsToBeacon",value:function(s){var n=this.params.requestName==="sliceUploadFile"||this.params.realApi==="sliceUploadFile";if(!(n&&!this.deepTracker)){var t="qcloud_track_cos_sdk";this.delay===0?this.beacon&&this.beacon.onDirectUserAction(t,s):this.beacon&&this.beacon.onUserAction(t,s)}}},{key:"sendEventsToCLS",value:function(s){var n=this.delay===0;this.clsReporter.log(s,n)}},{key:"generateSubTracker",value:function(s){return Object.assign(s,{parent:this,deepTracker:this.deepTracker,traceId:this.params.traceId,bucket:this.params.bucket,region:this.params.region,accelerate:this.params.accelerate,fileKey:this.params.requestPath,customId:this.params.customId,delay:this.delay,clsReporter:this.clsReporter}),new d(s)}}])}();L.exports=h},"./src/util.js":function(L,J,B){(function(U){var A=B("./node_modules/@babel/runtime/helpers/typeof.js");function F(V,R){var O=typeof Symbol<"u"&&V[Symbol.iterator]||V["@@iterator"];if(!O){if(Array.isArray(V)||(O=N(V))||R){O&&(V=O);var w=0,D=function(){};return{s:D,n:function(){return w>=V.length?{done:!0}:{done:!1,value:V[w++]}},e:function(Be){throw Be},f:D}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Q,ie=!0,ge=!1;return{s:function(){O=O.call(V)},n:function(){var Be=O.next();return ie=Be.done,Be},e:function(Be){ge=!0,Q=Be},f:function(){try{ie||O.return==null||O.return()}finally{if(ge)throw Q}}}}function N(V,R){if(V){if(typeof V=="string")return M(V,R);var O={}.toString.call(V).slice(8,-1);return O==="Object"&&V.constructor&&(O=V.constructor.name),O==="Map"||O==="Set"?Array.from(V):O==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(O)?M(V,R):void 0}}function M(V,R){(R==null||R>V.length)&&(R=V.length);for(var O=0,w=Array(R);O<R;O++)w[O]=V[O];return w}var i=B("./lib/md5.js"),p=B("./lib/crypto.js"),l=B("./node_modules/fast-xml-parser/src/fxp.js"),C=l.XMLParser,f=l.XMLBuilder,k=new C({ignoreDeclaration:!0,ignoreAttributes:!0,parseTagValue:!1,trimValues:!1}),S=new f,b=B("./lib/base64.js"),P=B("./src/tracker.js"),j="#text",z=function(R){if(de(R))for(var O in R){var w=R[O];typeof w=="string"?O===j&&delete R[O]:Array.isArray(w)?w.forEach(function(D){z(D)}):de(w)&&z(w)}},q=function(R){var O=k.parse(R);return z(O),O},h=function(R){var O=S.build(R);return O};function d(V){return encodeURIComponent(V).replace(/!/g,"%21").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A")}function m(V,R){var O=[];for(var w in V)V.hasOwnProperty(w)&&O.push(R?d(w).toLowerCase():w);return O.sort(function(D,Q){return D=D.toLowerCase(),Q=Q.toLowerCase(),D===Q?0:D>Q?1:-1})}var s=function(R,O){var w,D,Q,ie=[],ge=m(R);for(w=0;w<ge.length;w++)D=ge[w],Q=R[D]===void 0||R[D]===null?"":""+R[D],D=O?d(D).toLowerCase():d(D),Q=d(Q)||"",ie.push(D+"="+Q);return ie.join("&")},n=["cache-control","content-disposition","content-encoding","content-length","content-md5","expect","expires","host","if-match","if-modified-since","if-none-match","if-unmodified-since","origin","range","transfer-encoding","pic-operations"],t=function(R){var O={};for(var w in R){var D=w.toLowerCase();(D.indexOf("x-cos-")>-1||D.indexOf("x-ci-")>-1||n.indexOf(D)>-1)&&(O[w]=R[w])}return O},r=function(R){R=R||{};var O=R.SecretId,w=R.SecretKey,D=R.KeyTime,Q=(R.method||R.Method||"get").toLowerCase(),ie=se(R.Query||R.params||{}),ge=t(se(R.Headers||R.headers||{})),ke=R.Key||"",Be;R.UseRawKey?Be=R.Pathname||R.pathname||"/"+ke:(Be=R.Pathname||R.pathname||ke,Be.indexOf("/")!==0&&(Be="/"+Be));var we=R.ForceSignHost!==!1;if(!ge.Host&&!ge.host&&R.Bucket&&R.Region&&we&&(ge.Host=R.Bucket+".cos."+R.Region+".myqcloud.com"),!O)throw new Error("missing param SecretId");if(!w)throw new Error("missing param SecretKey");var Le=Math.round(Ye(R.SystemClockOffset)/1e3)-1,Ie=Le,Ve=R.Expires||R.expires;Ve===void 0?Ie+=900:Ie+=Ve*1||0;var tt="sha1",Ge=O,be=D||Le+";"+Ie,$e=D||Le+";"+Ie,qe=m(ge,!0).join(";").toLowerCase(),rt=m(ie,!0).join(";").toLowerCase(),at=p.HmacSHA1($e,w).toString(),kt=[Q,Be,Fe.obj2str(ie,!0),Fe.obj2str(ge,!0),""].join(`
`),St=["sha1",be,p.SHA1(kt).toString(),""].join(`
`),Y=p.HmacSHA1(St,at).toString(),xt=["q-sign-algorithm="+tt,"q-ak="+Ge,"q-sign-time="+be,"q-key-time="+$e,"q-header-list="+qe,"q-url-param-list="+rt,"q-signature="+Y].join("&");return xt},a=function(R,O,w){var D=O/8,Q=R.slice(w,w+D);return new Uint8Array(Q).reverse(),new{8:Uint8Array,16:Uint16Array,32:Uint32Array}[O](Q)[0]},y=function(R,O,w,D){var Q=R.slice(O,w),ie="";return new Uint8Array(Q).forEach(function(ge){ie+=String.fromCharCode(ge)}),D&&(ie=decodeURIComponent(escape(ie))),ie},I=function(R){for(var O={},w=y(R),D={records:[]};R.byteLength;){var Q=a(R,32,0),ie=a(R,32,4),ge=Q-ie-16,ke=0,Be;for(R=R.slice(12);ke<ie;){var we=a(R,8,ke),Le=y(R,ke+1,ke+1+we),Ie=a(R,16,ke+we+2),Ve=y(R,ke+we+4,ke+we+4+Ie);O[Le]=Ve,ke+=we+4+Ie}if(O[":event-type"]==="Records")Be=y(R,ke,ke+ge,!0),D.records.push(Be);else if(O[":event-type"]==="Stats")Be=y(R,ke,ke+ge,!0),D.stats=Fe.xml2json(Be).Stats;else if(O[":event-type"]==="error"){var tt=O[":error-code"],Ge=O[":error-message"],be=new Error(Ge);be.message=Ge,be.name=be.code=tt,D.error=be}R=R.slice(ke+ge+4)}return{payload:D.records.join(""),body:w}},T=function(R){var O=this.options.CopySourceParser;if(O)return O(R);var w=R.match(/^([^.]+-\d+)\.cos(v6|-cdc|-cdz|-internal)?\.([^.]+)\.((myqcloud\.com)|(tencentcos\.cn))\/(.+)$/);return w?{Bucket:w[1],Region:w[3],Key:w[7]}:null},K=function(){},_=function(R){var O={};for(var w in R)R.hasOwnProperty(w)&&R[w]!==void 0&&R[w]!==null&&(O[w]=R[w]);return O},Z=function(R,O){var w,D=new FileReader;FileReader.prototype.readAsBinaryString?(w=FileReader.prototype.readAsBinaryString,D.onload=function(){O(this.result)}):FileReader.prototype.readAsArrayBuffer?w=function(ie){var ge="",ke=new FileReader;ke.onload=function(Be){for(var we=new Uint8Array(ke.result),Le=we.byteLength,Ie=0;Ie<Le;Ie++)ge+=String.fromCharCode(we[Ie]);O(ge)},ke.readAsArrayBuffer(ie)}:console.error("FileReader not support readAsBinaryString"),w.call(D,R)},X=function(){var V=function(w,D){w=w.split("."),D=D.split(".");for(var Q=0;Q<D.length;Q++)if(w[Q]!==D[Q])return parseInt(w[Q])>parseInt(D[Q])?1:-1;return 0},R=function(w){if(!w)return!1;var D=(w.match(/Chrome\/([.\d]+)/)||[])[1],Q=(w.match(/QBCore\/([.\d]+)/)||[])[1],ie=(w.match(/QQBrowser\/([.\d]+)/)||[])[1],ge=D&&V(D,"53.0.2785.116")<0&&Q&&V(Q,"3.53.991.400")<0&&ie&&V(ie,"9.0.2524.400")<=0||!1;return ge};return R(typeof navigator<"u"&&navigator.userAgent)}(),ne=function(R,O,w,D,Q){var ie;if(R.slice?ie=R.slice(O,w):R.mozSlice?ie=R.mozSlice(O,w):R.webkitSlice&&(ie=R.webkitSlice(O,w)),D&&X){var ge=new FileReader;ge.onload=function(ke){ie=null,Q(new Blob([ge.result]))},ge.readAsArrayBuffer(ie)}else Q(ie)},oe=function(R,O,w,D){w=w||K,R?typeof O=="string"?w(Fe.md5(O,!0)):Blob&&O instanceof Blob?Fe.getFileMd5(O,function(Q,ie){w(ie)},D):w():w()},Se=1024*1024,le=function(R,O,w){var D=R.size,Q=0,ie=i.getCtx(),ge=function(Be){if(Be>=D){var we=ie.digest("hex");O(null,we);return}var Le=Math.min(D,Be+Se);Fe.fileSlice(R,Be,Le,!1,function(Ie){Z(Ie,function(Ve){Ie=null,ie=ie.update(Ve,!0),Q+=Ve.length,Ve=null,w&&w({loaded:Q,total:D,percent:Math.round(Q/D*1e4)/1e4}),ge(Be+Se)})})};ge(0)};function se(V){return ve(V,function(R){return A(R)==="object"&&R!==null?se(R):R})}function ee(V,R,O){return V&&R in V?V[R]:O}function W(V,R){return ce(R,function(O,w){V[w]=R[w]}),V}function te(V){return V instanceof Array}function de(V){return Object.prototype.toString.call(V)==="[object Object]"}function he(V,R){for(var O=!1,w=0;w<V.length;w++)if(R===V[w]){O=!0;break}return O}function re(V){return te(V)?V:[V]}function ce(V,R){for(var O in V)V.hasOwnProperty(O)&&R(V[O],O)}function ve(V,R){var O=te(V)?[]:{};for(var w in V)V.hasOwnProperty(w)&&(O[w]=R(V[w],w));return O}function pe(V,R){var O=te(V),w=O?[]:{};for(var D in V)V.hasOwnProperty(D)&&R(V[D],D)&&(O?w.push(V[D]):w[D]=V[D]);return w}var Ce=function(R){var O,w,D,Q="";for(O=0,w=R.length/2;O<w;O++)D=parseInt(R[O*2]+R[O*2+1],16),Q+=String.fromCharCode(D);return btoa(Q)},Ae=function(){var R=function(){return((1+Math.random())*65536|0).toString(16).substring(1)};return R()+R()+"-"+R()+"-"+R()+"-"+R()+"-"+R()+R()+R()},me=function(R,O){var w=O.Bucket,D=O.Region,Q=O.Key,ie=this.options.Domain,ge=!ie||typeof ie=="string"&&ie.indexOf("{Bucket}")>-1,ke=!ie||typeof ie=="string"&&ie.indexOf("{Region}")>-1;if(R.indexOf("Bucket")>-1||R==="deleteMultipleObject"||R==="multipartList"||R==="listObjectVersions"){if(ge&&!w)return"Bucket";if(ke&&!D)return"Region"}else if(R.indexOf("Object")>-1||R.indexOf("multipart")>-1||R==="sliceUploadFile"||R==="abortUploadTask"||R==="uploadFile"){if(ge&&!w)return"Bucket";if(ke&&!D)return"Region";if(!Q)return"Key"}return!1},je=function(R,O){if(O=W({},O),R!=="getAuth"&&R!=="getV4Auth"&&R!=="getObjectUrl"){var w=O.Headers||{};if(O&&A(O)==="object"){(function(){for(var Q in O)O.hasOwnProperty(Q)&&Q.indexOf("x-cos-")>-1&&(w[Q]=O[Q])})();var D={"x-cos-mfa":"MFA","Content-MD5":"ContentMD5","Content-Length":"ContentLength","Content-Type":"ContentType",Expect:"Expect",Expires:"Expires","Cache-Control":"CacheControl","Content-Disposition":"ContentDisposition","Content-Encoding":"ContentEncoding",Range:"Range","If-Modified-Since":"IfModifiedSince","If-Unmodified-Since":"IfUnmodifiedSince","If-Match":"IfMatch","If-None-Match":"IfNoneMatch","x-cos-copy-source":"CopySource","x-cos-copy-source-Range":"CopySourceRange","x-cos-metadata-directive":"MetadataDirective","x-cos-copy-source-If-Modified-Since":"CopySourceIfModifiedSince","x-cos-copy-source-If-Unmodified-Since":"CopySourceIfUnmodifiedSince","x-cos-copy-source-If-Match":"CopySourceIfMatch","x-cos-copy-source-If-None-Match":"CopySourceIfNoneMatch","x-cos-acl":"ACL","x-cos-grant-read":"GrantRead","x-cos-grant-write":"GrantWrite","x-cos-grant-full-control":"GrantFullControl","x-cos-grant-read-acp":"GrantReadAcp","x-cos-grant-write-acp":"GrantWriteAcp","x-cos-storage-class":"StorageClass","x-cos-traffic-limit":"TrafficLimit","x-cos-mime-limit":"MimeLimit","x-cos-server-side-encryption-customer-algorithm":"SSECustomerAlgorithm","x-cos-server-side-encryption-customer-key":"SSECustomerKey","x-cos-server-side-encryption-customer-key-MD5":"SSECustomerKeyMD5","x-cos-server-side-encryption":"ServerSideEncryption","x-cos-server-side-encryption-cos-kms-key-id":"SSEKMSKeyId","x-cos-server-side-encryption-context":"SSEContext","Pic-Operations":"PicOperations","x-cos-callback":"Callback","x-cos-callback-var":"CallbackVar","x-cos-return-body":"ReturnBody"};Fe.each(D,function(Q,ie){O[Q]!==void 0&&(w[ie]=O[Q])}),O.Headers=_(w)}}return O},We=function(R,O){return function(w,D){var Q=this;typeof w=="function"&&(D=w,w={}),w=je(R,w);var ie;if(Q.options.EnableReporter)if(w.calledBySdk==="sliceUploadFile"||w.calledBySdk==="sliceCopyFile")ie=w.tracker&&w.tracker.generateSubTracker({apiName:R});else if(["uploadFile","uploadFiles"].includes(R))ie=null;else{var ge=0;w.Body&&(ge=typeof w.Body=="string"?w.Body.length:w.Body.size||w.Body.byteLength||0);var ke=Q.options.UseAccelerate||typeof Q.options.Domain=="string"&&Q.options.Domain.includes("accelerate.");ie=new P({Beacon:Q.options.BeaconReporter,clsReporter:Q.options.ClsReporter,bucket:w.Bucket,region:w.Region,apiName:R,realApi:R,accelerate:ke,fileKey:w.Key,fileSize:ge,deepTracker:Q.options.DeepTracker,customId:Q.options.CustomId,delay:Q.options.TrackerDelay})}w.tracker=ie;var Be=function(be){return be&&be.headers&&(be.headers["x-ci-request-id"]&&(be.RequestId=be.headers["x-ci-request-id"]),be.headers["x-cos-request-id"]&&(be.RequestId=be.headers["x-cos-request-id"]),be.headers["x-cos-version-id"]&&(be.VersionId=be.headers["x-cos-version-id"]),be.headers["x-cos-delete-marker"]&&(be.DeleteMarker=be.headers["x-cos-delete-marker"])),be},we=function(be,$e){ie&&ie.report(be,$e),D&&D(Be(be),Be($e))},Le=function(){if(R!=="getService"&&R!=="abortUploadTask"){var be=me.call(Q,R,w);if(be)return"missing param "+be;if(w.Region){if(Q.options.CompatibilityMode){if(!/^([a-z\d-.]+)$/.test(w.Region))return"Region format error."}else{if(w.Region.indexOf("cos.")>-1)return'param Region should not be start with "cos."';if(!/^([a-z\d-]+)$/.test(w.Region))return"Region format error."}!Q.options.CompatibilityMode&&w.Region.indexOf("-")===-1&&w.Region!=="yfb"&&w.Region!=="default"&&w.Region!=="accelerate"&&console.warn("warning: param Region format error, find help here: https://cloud.tencent.com/document/product/436/6224")}if(w.Bucket){if(!/^([a-z\d-]+)-(\d+)$/.test(w.Bucket))if(w.AppId)w.Bucket=w.Bucket+"-"+w.AppId;else if(Q.options.AppId)w.Bucket=w.Bucket+"-"+Q.options.AppId;else return'Bucket should format as "test-1250000000".';w.AppId&&(console.warn('warning: AppId has been deprecated, Please put it at the end of parameter Bucket(E.g Bucket:"test-1250000000" ).'),delete w.AppId)}!Q.options.UseRawKey&&w.Key&&w.Key.substr(0,1)==="/"&&(w.Key=w.Key.substr(1))}},Ie=Le(),Ve=["getAuth","getObjectUrl"].includes(R);if(typeof Promise=="function"&&!Ve&&!D)return new Promise(function(Ge,be){if(D=function(qe,rt){qe?be(qe):Ge(rt)},Ie)return we(Fe.error(new Error(Ie)));O.call(Q,w,we)});if(Ie)return we(Fe.error(new Error(Ie)));var tt=O.call(Q,w,we);if(Ve)return tt}},He=function(R,O){var w=this,D=0,Q=0,ie=Date.now(),ge,ke;function Be(){if(ke=0,O&&typeof O=="function"){ge=Date.now();var we=Math.max(0,Math.round((Q-D)/((ge-ie)/1e3)*100)/100)||0,Le;Q===0&&R===0?Le=1:Le=Math.floor(Q/R*100)/100||0,ie=ge,D=Q;try{O({loaded:Q,total:R,speed:we,percent:Le})}catch{}}}return function(we,Le){if(we&&(Q=we.loaded,R=we.total),Le)clearTimeout(ke),Be();else{if(ke)return;ke=setTimeout(Be,w.options.ProgressInterval)}}},Qe=function(R,O,w){var D;if(typeof O.Body=="string"?O.Body=new Blob([O.Body],{type:"text/plain"}):O.Body instanceof ArrayBuffer&&(O.Body=new Blob([O.Body])),O.Body&&(O.Body instanceof Blob||O.Body.toString()==="[object File]"||O.Body.toString()==="[object Blob]"))D=O.Body.size;else{w(Fe.error(new Error("params body format error, Only allow File|Blob|String.")));return}O.ContentLength=D,w(null,D)},Ye=function(R){return Date.now()+(R||0)},ze=function(R,O){var w=R;return R.message=R.message||null,typeof O=="string"?(R.error=O,R.message=O):A(O)==="object"&&O!==null&&(W(R,O),(O.code||O.name)&&(R.code=O.code||O.name),O.message&&(R.message=O.message),O.stack&&(R.stack=O.stack)),typeof Object.defineProperty=="function"&&(Object.defineProperty(R,"name",{writable:!0,enumerable:!1}),Object.defineProperty(R,"message",{enumerable:!0})),R.name=O&&O.name||R.name||R.code||"Error",R.code||(R.code=R.name),R.error||(R.error=se(w)),R},Je=function(){return(typeof globalThis>"u"?"undefined":A(globalThis))==="object"&&(globalThis.constructor.name==="DedicatedWorkerGlobalScope"||globalThis.FileReaderSync)},st=function(){return(typeof window>"u"?"undefined":A(window))!=="object"&&(typeof U>"u"?"undefined":A(U))==="object"&&!0&&!Je()},ft=function(R){return/^https?:\/\/([^/]+\.)?ci\.[^/]+/.test(R)},ht=function(){if((typeof navigator>"u"?"undefined":A(navigator))!=="object")return!1;var V=navigator.userAgent,R=!!V.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/);return R}(),gt=function(){return(typeof navigator>"u"?"undefined":A(navigator))!=="object"?!1:/\sQQ/i.test(navigator.userAgent)}(),vt=function(R,O){var w=b.encode(R);return O&&(w=w.replaceAll("+","-").replaceAll("/","_").replaceAll("=","")),w},pt=function(R){return R?b.decode(R):""},yt=function(R){var O=R.split("/"),w=[],D=F(O),Q;try{for(D.s();!(Q=D.n()).done;){var ie=Q.value;ie===".."?w.length&&w.pop():ie.length&&ie!=="."&&w.push(ie)}}catch(ge){D.e(ge)}finally{D.f()}return"/"+w.join("/")},Ct=function(R){var O;if(R&&typeof R=="string"){var w=R.trim(),D=w.indexOf("<")===0,Q=w.indexOf("{")===0;if(D)O=Fe.xml2json(R)||{};else if(Q)try{var ie=R.replace(/\n/g," "),ge=JSON.parse(ie);Object.prototype.toString.call(ge)==="[object Object]"?O=ge:O=R}catch{O=R}else O=R}else O=R||{};return O},Fe={noop:K,formatParams:je,apiWrapper:We,xml2json:q,json2xml:h,md5:i,clearKey:_,fileSlice:ne,getBodyMd5:oe,getFileMd5:le,b64:Ce,extend:W,isArray:te,isInArray:he,makeArray:re,each:ce,map:ve,filter:pe,clone:se,attr:ee,uuid:Ae,camSafeUrlEncode:d,throttleOnProgress:He,getFileSize:Qe,getSkewTime:Ye,error:ze,obj2str:s,getAuth:r,parseSelectPayload:I,getSourceParams:T,isBrowser:!0,isNode:st,isCIHost:ft,isIOS_QQ:ht&&gt,encodeBase64:vt,decodeBase64:pt,simplifyPath:yt,readAsBinaryString:Z,parseResBody:Ct};L.exports=Fe}).call(this,B("./node_modules/process/browser.js"))}})})})(Ot);var Vt=Ot.exports;const qt=Ut(Vt);class Gt{constructor(fe){dt(this,"cos");dt(this,"config");dt(this,"uploadTasks",new Map);this.config=fe,this.cos=new qt({...fe.secretId&&fe.secretKey&&{SecretId:fe.secretId,SecretKey:fe.secretKey},...fe.getAuthorization&&{getAuthorization:fe.getAuthorization}}),console.log("[COS Uploader] 初始化完成",{bucket:fe.bucket,region:fe.region,hasSecretId:!!fe.secretId,hasGetAuth:!!fe.getAuthorization})}async uploadFile(fe){const{file:L,key:J,onProgress:B,onSuccess:U,onError:A}=fe,F=J||this.generateFileKey(L),N=`upload_${Date.now()}_${Math.random()}`;return console.log("[COS Uploader] 开始上传文件",{taskId:N,fileName:L.name,fileSize:L.size,fileType:L.type,key:F,bucket:this.config.bucket,region:this.config.region}),new Promise((M,i)=>{try{this.cos.uploadFile({Bucket:this.config.bucket,Region:this.config.region,Key:F,Body:L,SliceSize:1024*1024,onTaskReady:p=>{this.uploadTasks.set(N,p),console.log("[COS Uploader] 任务就绪",{taskId:N,tid:p})},onProgress:p=>{const l={loaded:p.loaded,total:p.total,percent:Math.round(p.loaded/p.total*100)};console.log("[COS Uploader] 上传进度",{taskId:N,...l,speed:p.speed?`${(p.speed/1024).toFixed(2)} KB/s`:"N/A"}),B==null||B(l)}},(p,l)=>{if(this.uploadTasks.delete(N),p){console.error("[COS Uploader] 上传失败",{taskId:N,error:p.message||p,code:p.code,statusCode:p.statusCode});const C=new Error(`上传失败: ${p.message||"未知错误"}`);A==null||A(C),i(C)}else{const C={url:l.Location.startsWith("http")?l.Location:`https://${l.Location}`,key:l.Key,etag:l.ETag,location:l.Location};console.log("[COS Uploader] 上传成功",{taskId:N,...C}),U==null||U(C),M(C)}})}catch(p){console.error("[COS Uploader] 上传异常",{taskId:N,error:p instanceof Error?p.message:String(p)});const l=p instanceof Error?p:new Error("上传异常");A==null||A(l),i(l)}})}cancelUpload(fe){const L=this.uploadTasks.get(fe);return L?(console.log("[COS Uploader] 取消上传任务",{taskId:fe,cosTaskId:L}),this.cos.cancelTask(L),this.uploadTasks.delete(fe),!0):!1}pauseUpload(fe){const L=this.uploadTasks.get(fe);return L?(console.log("[COS Uploader] 暂停上传任务",{taskId:fe,cosTaskId:L}),this.cos.pauseTask(L),!0):!1}resumeUpload(fe){const L=this.uploadTasks.get(fe);return L?(console.log("[COS Uploader] 恢复上传任务",{taskId:fe,cosTaskId:L}),this.cos.restartTask(L),!0):!1}generateFileKey(fe){const L=Date.now(),J=Math.random().toString(36).substring(2,8),B=fe.name.split(".").pop()||"";return`uploads/avatar/${L}_${J}.${B}`}getActiveTaskCount(){return this.uploadTasks.size}clearAllTasks(){console.log("[COS Uploader] 清理所有任务",{count:this.uploadTasks.size}),this.uploadTasks.forEach((fe,L)=>{this.cos.cancelTask(fe)}),this.uploadTasks.clear()}}const Dt=(Pe={})=>{const fe={bucket:"test-1250000000",region:"ap-guangzhou",getAuthorization:(L,J)=>{console.warn("[COS Uploader] 使用模拟授权，生产环境请实现真实的临时密钥获取",L),setTimeout(()=>{J({TmpSecretId:"mock-tmp-secret-id",TmpSecretKey:"mock-tmp-secret-key",SecurityToken:"mock-security-token",StartTime:Math.floor(Date.now()/1e3),ExpiredTime:Math.floor(Date.now()/1e3)+3600})},100)},...Pe};return new Gt(fe)},Wt=({currentAvatar:Pe,onAvatarChange:fe,size:L="md",disabled:J=!1})=>{const[B,U]=et.useState(!1),[A,F]=et.useState(!1),[N,M]=et.useState(null),[i,p]=et.useState(!1),l=et.useRef(null),C=et.useRef(Dt()),f=et.useRef(null),k={sm:{container:"w-12 h-12",icon:"w-6 h-6"},md:{container:"w-16 h-16",icon:"w-8 h-8"},lg:{container:"w-24 h-24",icon:"w-12 h-12"}},{container:S,icon:b}=k[L];et.useEffect(()=>()=>{f.current&&C.current.clearAllTasks()},[]);const P=n=>{if(!n.type.startsWith("image/")){alert("请选择图片文件");return}if(n.size>5*1024*1024){alert("图片大小不能超过5MB");return}j(n)},j=async n=>{U(!0),M(null),p(!0),console.log("[Avatar Uploader] 开始上传头像",{fileName:n.name,fileSize:n.size,fileType:n.type});try{const t=`avatar_${Date.now()}_${Math.random()}`;f.current=t;const r=await C.current.uploadFile({file:n,key:`avatar/${Date.now()}_${n.name}`,onProgress:a=>{console.log("[Avatar Uploader] 上传进度更新",a),M(a)},onSuccess:a=>{console.log("[Avatar Uploader] 上传成功回调",a)},onError:a=>{console.error("[Avatar Uploader] 上传错误回调",a)}});console.log("[Avatar Uploader] 头像上传完成",{taskId:t,url:r.url,key:r.key}),fe(r.url),M(null),p(!1)}catch(t){console.error("[Avatar Uploader] 头像上传失败",{taskId:f.current,error:t instanceof Error?t.message:String(t)}),alert(`上传失败: ${t instanceof Error?t.message:"未知错误"}`),M(null),p(!1)}finally{U(!1),f.current=null}},z=()=>{f.current&&i&&(console.log("[Avatar Uploader] 用户取消上传",{taskId:f.current}),C.current.cancelUpload(f.current),U(!1),M(null),p(!1),f.current=null)},q=()=>{var n;J||B||(n=l.current)==null||n.click()},h=n=>{var r;const t=(r=n.target.files)==null?void 0:r[0];t&&P(t),n.target.value=""},d=n=>{n.preventDefault(),!J&&!B&&F(!0)},m=n=>{n.preventDefault(),F(!1)},s=n=>{var r;if(n.preventDefault(),F(!1),J||B)return;const t=(r=n.dataTransfer.files)==null?void 0:r[0];t&&P(t)};return G.jsxs("div",{className:"relative inline-block",children:[G.jsx("input",{ref:l,type:"file",accept:"image/*",onChange:h,className:"hidden","aria-label":"选择头像图片"}),G.jsxs("div",{"data-testid":"avatar-container",className:`
          ${S} relative cursor-pointer rounded-full overflow-hidden
          border-2 border-dashed transition-all duration-200
          ${A?"border-blue-400 bg-blue-50":Pe?"border-transparent":"border-gray-300 hover:border-gray-400"}
          ${J?"cursor-not-allowed opacity-50":""}
          ${B?"cursor-wait":""}
        `,onClick:q,onDragOver:d,onDragLeave:m,onDrop:s,children:[Pe?G.jsx("img",{src:Pe,alt:"头像",className:"w-full h-full object-cover"}):G.jsx("div",{className:"w-full h-full bg-gray-100 flex items-center justify-center",children:G.jsx("svg",{className:`${b} text-gray-400`,fill:"currentColor",viewBox:"0 0 20 20",children:G.jsx("path",{fillRule:"evenodd",d:"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z",clipRule:"evenodd"})})}),B&&G.jsxs("div",{className:"absolute inset-0 bg-black bg-opacity-50 flex flex-col items-center justify-center",children:[N?G.jsxs("div",{className:"relative",children:[G.jsxs("svg",{className:"w-8 h-8 transform -rotate-90",viewBox:"0 0 32 32",children:[G.jsx("circle",{cx:"16",cy:"16",r:"14",stroke:"rgba(255,255,255,0.3)",strokeWidth:"3",fill:"none"}),G.jsx("circle",{cx:"16",cy:"16",r:"14",stroke:"white",strokeWidth:"3",fill:"none",strokeDasharray:`${N.percent*.88} 88`,strokeLinecap:"round"})]}),G.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:G.jsxs("span",{className:"text-xs text-white font-medium",children:[N.percent,"%"]})})]}):G.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-white border-t-transparent"}),i&&G.jsx("button",{onClick:n=>{n.stopPropagation(),z()},className:"mt-2 px-2 py-1 bg-red-500 text-white text-xs rounded hover:bg-red-600 transition-colors",children:"取消"})]}),!J&&!B&&G.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 hover:bg-opacity-30 transition-all duration-200 flex items-center justify-center",children:G.jsxs("svg",{className:"w-4 h-4 text-white opacity-0 hover:opacity-100 transition-opacity duration-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[G.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),G.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})]})})]}),A&&G.jsx("div",{className:"absolute -bottom-8 left-1/2 transform -translate-x-1/2 text-xs text-blue-600 whitespace-nowrap",children:"释放以上传图片"}),N&&!1]})},$t=Ft()(Kt((Pe,fe)=>({isLoggedIn:!1,user:null,token:null,isLoading:!1,login:(L,J)=>{Pe({isLoggedIn:!0,user:L,token:J,isLoading:!1})},logout:()=>{Pe({isLoggedIn:!1,user:null,token:null,isLoading:!1}),localStorage.removeItem("authToken")},updateUser:L=>{const J=fe();J.user&&Pe({user:{...J.user,...L}})},updateAvatar:L=>{const J=fe();J.user&&Pe({user:{...J.user,avatar:L}})},mockLogin:()=>{const L={id:"mock-user-1",name:"张三",nickname:"小张",email:"zhangsan@example.com",phone:"13800138000",avatar:"",createdAt:new Date().toISOString()},J="mock-token-"+Date.now();localStorage.setItem("authToken",J),fe().login(L,J)}}),{name:"user-storage",partialize:Pe=>({isLoggedIn:Pe.isLoggedIn,user:Pe.user,token:Pe.token})})),Xt=()=>{const Pe=_t(),{isLoggedIn:fe,user:L,updateAvatar:J,mockLogin:B,logout:U}=$t(),A=[{id:"favorites",icon:G.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:G.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}),label:"收藏",color:"text-red-500"},{id:"history",icon:G.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:G.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),label:"足迹",color:"text-green-500"},{id:"wallet",icon:G.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:G.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"})}),label:"钱包",color:"text-purple-500"}],F=[{id:"pending_payment",icon:G.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:G.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"})}),label:"待付款",color:"text-orange-500"},{id:"pending_shipment",icon:G.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:G.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})}),label:"待发货",color:"text-blue-500"},{id:"pending_delivery",icon:G.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:G.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),label:"待收货",color:"text-green-500"},{id:"pending_review",icon:G.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:G.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"})}),label:"待评价",color:"text-yellow-500"},{id:"refund_service",icon:G.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:G.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})}),label:"退款/售后",color:"text-red-500"}],N=[{id:"account",icon:G.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:G.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),label:"账户管理",description:"个人信息、密码设置"},{id:"address",icon:G.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[G.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),G.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),label:"收货地址",description:"管理您的收货地址"},{id:"notifications",icon:G.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:G.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 17h5l-5 5v-5zM10.6 14.4a9 9 0 01-5.2-5.2m5.2 5.2L15 20m-4.4-5.6c-1.1-1.1-1.6-2.7-1.6-4.4C9 7.8 10.8 6 13 6s4 1.8 4 4c0 1.7-.5 3.3-1.6 4.4"})}),label:"消息通知",description:"推送和通知设置"},{id:"privacy",icon:G.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:G.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})}),label:"隐私设置",description:"数据和隐私保护"},{id:"security",icon:G.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:G.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),label:"安全设置",description:"密码、二步验证"},{id:"help",icon:G.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:G.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),label:"帮助中心",description:"常见问题和客服支持"}],M=S=>{switch(console.log("点击功能:",S),S){case"favorites":alert("收藏功能开发中...");break;case"history":alert("浏览足迹功能开发中...");break;case"wallet":alert("钱包功能开发中...");break}},i=S=>{console.log("点击订单状态:",S);const P={pending_payment:"pending",pending_shipment:"paid",pending_delivery:"shipped",pending_review:"delivered",refund_service:"cancelled"}[S];Pe(P?`/orders?status=${P}`:"/orders")},p=()=>{Pe("/orders")},l=S=>{switch(console.log("点击设置:",S),S){case"account":alert("账户管理功能开发中...");break;case"address":alert("地址管理功能开发中...");break;case"notifications":alert("消息通知设置功能开发中...");break;case"privacy":alert("隐私设置功能开发中...");break;case"security":alert("安全设置功能开发中...");break;case"help":alert("帮助中心功能开发中...");break}},C=S=>{J(S)},f=()=>{fe?alert("个人资料编辑功能开发中..."):B()},k=()=>{confirm("确定要退出登录吗？")&&U()};return G.jsxs("div",{className:"min-h-screen bg-gray-50",children:[G.jsx(Ht,{}),G.jsxs("div",{className:"pb-20 pt-12",children:[G.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-purple-600 px-6 py-8 text-white",children:G.jsxs("div",{className:"flex items-center space-x-4",children:[G.jsx(Wt,{currentAvatar:L==null?void 0:L.avatar,onAvatarChange:C,size:"lg",disabled:!fe}),G.jsxs("div",{className:"flex-1 cursor-pointer",onClick:f,children:[G.jsx("h2",{className:"text-xl font-bold mb-1",children:fe?(L==null?void 0:L.nickname)||(L==null?void 0:L.name):"点击登录"}),G.jsx("p",{className:"text-blue-100 text-sm",children:fe?"点击查看和编辑个人资料":"登录后享受更多服务"}),fe&&(L==null?void 0:L.email)&&G.jsx("p",{className:"text-blue-200 text-xs mt-1",children:L.email})]}),!fe&&G.jsx("div",{className:"flex items-center justify-center w-8 h-8 bg-white bg-opacity-20 rounded-full",children:G.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:G.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"})})})]})}),G.jsxs("div",{className:"bg-white mx-4 mt-4 rounded-lg shadow-sm",children:[G.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-100",children:[G.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"我的订单"}),G.jsxs("button",{onClick:p,className:"flex items-center text-sm text-gray-500 hover:text-blue-600",children:[G.jsx("span",{children:"全部"}),G.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:G.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"})})]})]}),G.jsx("div",{className:"grid grid-cols-5 gap-2 p-6",children:F.map(S=>G.jsxs("div",{className:"flex flex-col items-center space-y-2 cursor-pointer",onClick:()=>i(S.id),children:[G.jsx("div",{className:`p-3 rounded-full bg-gray-50 ${S.color}`,children:S.icon}),G.jsx("span",{className:"text-xs text-gray-600 font-medium text-center",children:S.label})]},S.id))})]}),G.jsx("div",{className:"bg-white mx-4 mt-4 rounded-lg shadow-sm",children:G.jsx("div",{className:"grid grid-cols-3 gap-4 p-6",children:A.map(S=>G.jsxs("div",{className:"flex flex-col items-center space-y-2 cursor-pointer",onClick:()=>M(S.id),children:[G.jsx("div",{className:`p-3 rounded-full bg-gray-50 ${S.color}`,children:S.icon}),G.jsx("span",{className:"text-sm text-gray-600 font-medium",children:S.label})]},S.id))})}),G.jsxs("div",{className:"bg-white mx-4 mt-4 rounded-lg shadow-sm overflow-hidden",children:[N.map((S,b)=>G.jsxs("div",{className:`px-6 py-4 flex items-center space-x-4 cursor-pointer hover:bg-gray-50 ${b!==N.length-1?"border-b border-gray-100":""}`,onClick:()=>l(S.id),children:[G.jsx("div",{className:"text-gray-400",children:S.icon}),G.jsxs("div",{className:"flex-1",children:[G.jsx("div",{className:"font-medium text-gray-900",children:S.label}),G.jsx("div",{className:"text-sm text-gray-500",children:S.description})]}),G.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:G.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"})})]},S.id)),fe&&G.jsxs("div",{className:"px-6 py-4 flex items-center space-x-4 cursor-pointer hover:bg-red-50 border-t border-gray-100",onClick:k,children:[G.jsx("div",{className:"text-red-500",children:G.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:G.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})})}),G.jsxs("div",{className:"flex-1",children:[G.jsx("div",{className:"font-medium text-red-600",children:"退出登录"}),G.jsx("div",{className:"text-sm text-red-400",children:"安全退出当前账户"})]})]})]})]}),G.jsx(zt,{})]})};export{Xt as default};
//# sourceMappingURL=ProfilePage-BvQ-Yl5U.js.map
