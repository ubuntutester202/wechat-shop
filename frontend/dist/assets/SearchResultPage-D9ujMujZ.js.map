{"version":3,"file":"SearchResultPage-D9ujMujZ.js","sources":["../../src/components/ui/ProductCardSkeleton.tsx","../../src/pages/search/SearchResultPage.tsx"],"sourcesContent":["import React from 'react';\r\n\r\ninterface ProductCardSkeletonProps {\r\n  className?: string;\r\n}\r\n\r\n/**\r\n * 商品卡片骨架屏组件\r\n * 用于在商品数据加载时显示加载状态\r\n */\r\nconst ProductCardSkeleton: React.FC<ProductCardSkeletonProps> = ({ className = \"\" }) => {\r\n  return (\r\n    <div className={`bg-white rounded-lg shadow-sm overflow-hidden ${className}`}>\r\n      {/* 图片骨架 */}\r\n      <div className=\"w-full h-32 bg-gray-200 animate-pulse\"></div>\r\n      \r\n      {/* 内容骨架 */}\r\n      <div className=\"p-3\">\r\n        {/* 标题骨架 */}\r\n        <div className=\"space-y-2 mb-2\">\r\n          <div className=\"h-4 bg-gray-200 rounded animate-pulse\"></div>\r\n          <div className=\"h-4 bg-gray-200 rounded w-3/4 animate-pulse\"></div>\r\n        </div>\r\n        \r\n        {/* 价格骨架 */}\r\n        <div className=\"flex items-center justify-between mb-1\">\r\n          <div className=\"h-5 bg-gray-200 rounded w-16 animate-pulse\"></div>\r\n          <div className=\"h-3 bg-gray-200 rounded w-12 animate-pulse\"></div>\r\n        </div>\r\n        \r\n        {/* 评分骨架 */}\r\n        <div className=\"flex items-center\">\r\n          <div className=\"flex space-x-1\">\r\n            {[...Array(5)].map((_, i) => (\r\n              <div key={i} className=\"w-3 h-3 bg-gray-200 rounded animate-pulse\"></div>\r\n            ))}\r\n          </div>\r\n          <div className=\"h-3 bg-gray-200 rounded w-8 ml-1 animate-pulse\"></div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ProductCardSkeleton; ","import React, { useState, useEffect } from 'react';\r\nimport { useSearchParams, useNavigate } from 'react-router-dom';\r\nimport { Product } from '../../assets/data/mock/products';\r\nimport ProductCard from '../../components/ui/ProductCard';\r\nimport ProductCardSkeleton from '../../components/ui/ProductCardSkeleton';\r\nimport StatusBar from '../../components/common/StatusBar';\r\n\r\n/**\r\n * 搜索结果页面组件\r\n * 显示基于搜索关键词的商品搜索结果\r\n */\r\nconst SearchResultPage: React.FC = () => {\r\n  const [searchParams, setSearchParams] = useSearchParams();\r\n  const navigate = useNavigate();\r\n  \r\n  // 状态管理\r\n  const [products, setProducts] = useState<Product[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n  const [totalResults, setTotalResults] = useState(0);\r\n\r\n  // 从 URL 参数获取搜索词\r\n  const query = searchParams.get('q') || '';\r\n  const category = searchParams.get('category') || '';\r\n\r\n  // 获取搜索结果\r\n  useEffect(() => {\r\n    if (query) {\r\n      setSearchQuery(query);\r\n      performSearch(query, category);\r\n    }\r\n  }, [query, category]);\r\n\r\n  // 执行搜索\r\n  const performSearch = async (searchQuery: string, categoryFilter?: string) => {\r\n    try {\r\n      setLoading(true);\r\n      \r\n      // 构建查询参数\r\n      const queryParams = new URLSearchParams();\r\n      queryParams.append('q', searchQuery);\r\n      if (categoryFilter) {\r\n        queryParams.append('category', categoryFilter);\r\n      }\r\n      \r\n      console.log(`[搜索] 关键词: ${searchQuery}, 分类: ${categoryFilter}`);\r\n      \r\n      // 调用搜索 API\r\n      const response = await fetch(`/api/products/search?${queryParams.toString()}`);\r\n      const data = await response.json();\r\n      \r\n      if (response.ok) {\r\n        setProducts(data.data || []);\r\n        setTotalResults(data.total || 0);\r\n      } else {\r\n        console.error('搜索失败:', data);\r\n        setProducts([]);\r\n        setTotalResults(0);\r\n      }\r\n    } catch (error) {\r\n      console.error('搜索出错:', error);\r\n      setProducts([]);\r\n      setTotalResults(0);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // 处理返回\r\n  const handleGoBack = () => {\r\n    navigate(-1);\r\n  };\r\n\r\n  // 处理商品点击\r\n  const handleProductClick = (productId: string) => {\r\n    navigate(`/product/${productId}`);\r\n  };\r\n\r\n  // 处理新搜索\r\n  const handleNewSearch = (newQuery: string) => {\r\n    if (newQuery.trim()) {\r\n      setSearchParams({ q: newQuery.trim() });\r\n    }\r\n  };\r\n\r\n  // 处理搜索框变化\r\n  const handleSearchChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    setSearchQuery(e.target.value);\r\n  };\r\n\r\n  // 处理搜索提交\r\n  const handleSearchSubmit = (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    if (searchQuery.trim()) {\r\n      handleNewSearch(searchQuery.trim());\r\n    }\r\n  };\r\n\r\n  // 渲染搜索结果网格\r\n  const renderProductGrid = () => {\r\n    if (loading) {\r\n      return (\r\n        <div className=\"grid grid-cols-2 gap-4 px-4\">\r\n          {[...Array(8)].map((_, index) => (\r\n            <ProductCardSkeleton key={index} />\r\n          ))}\r\n        </div>\r\n      );\r\n    }\r\n\r\n    if (products.length === 0) {\r\n      return (\r\n        <div className=\"flex flex-col items-center justify-center py-16 px-4\">\r\n          <div className=\"w-24 h-24 bg-gray-200 rounded-full flex items-center justify-center mb-4\">\r\n            <svg className=\"w-12 h-12 text-gray-400\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"1.5\" d=\"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z\" />\r\n            </svg>\r\n          </div>\r\n          <h3 className=\"text-lg font-medium text-gray-900 mb-2\">未找到相关商品</h3>\r\n          <p className=\"text-sm text-gray-500 text-center mb-4\">\r\n            抱歉，没有找到与 \"{query}\" 相关的商品\r\n          </p>\r\n          <button\r\n            onClick={() => handleNewSearch('')}\r\n            className=\"px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium\"\r\n          >\r\n            浏览所有商品\r\n          </button>\r\n        </div>\r\n      );\r\n    }\r\n\r\n    return (\r\n      <div className=\"grid grid-cols-2 gap-4 px-4\">\r\n        {products.map((product) => (\r\n          <ProductCard\r\n            key={product.id}\r\n            product={product}\r\n            onClick={handleProductClick}\r\n          />\r\n        ))}\r\n      </div>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <div className=\"bg-gray-50 min-h-screen\">\r\n      <StatusBar />\r\n      \r\n      {/* 头部 */}\r\n      <div className=\"bg-white shadow-sm\">\r\n        <div className=\"flex items-center px-4 py-3\">\r\n          {/* 返回按钮 */}\r\n          <button\r\n            onClick={handleGoBack}\r\n            className=\"mr-3 p-1\"\r\n            aria-label=\"返回\"\r\n          >\r\n            <svg className=\"w-6 h-6 text-gray-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M15 19l-7-7 7-7\" />\r\n            </svg>\r\n          </button>\r\n          \r\n          {/* 搜索框 */}\r\n          <form onSubmit={handleSearchSubmit} className=\"flex-1\">\r\n            <div className=\"relative\">\r\n              <input\r\n                type=\"text\"\r\n                placeholder=\"搜索商品\"\r\n                value={searchQuery}\r\n                onChange={handleSearchChange}\r\n                className=\"w-full bg-gray-100 rounded-full px-4 py-2 pr-10 text-sm outline-none focus:bg-gray-50 transition-colors\"\r\n                autoFocus\r\n              />\r\n              <button\r\n                type=\"submit\"\r\n                className=\"absolute right-3 top-1/2 -translate-y-1/2\"\r\n                aria-label=\"搜索\"\r\n              >\r\n                <svg className=\"w-4 h-4 text-gray-500\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z\" />\r\n                </svg>\r\n              </button>\r\n            </div>\r\n          </form>\r\n        </div>\r\n      </div>\r\n\r\n      {/* 搜索结果信息 */}\r\n      {!loading && (\r\n        <div className=\"px-4 py-3 bg-white border-b border-gray-100\">\r\n          <p className=\"text-sm text-gray-600\">\r\n            {totalResults > 0 ? (\r\n              <>找到 <span className=\"font-medium text-gray-900\">{totalResults}</span> 个相关商品</>\r\n            ) : (\r\n              <>搜索 \"{query}\" 的结果</>\r\n            )}\r\n          </p>\r\n        </div>\r\n      )}\r\n\r\n      {/* 商品列表 */}\r\n      <div className=\"py-4\">\r\n        {renderProductGrid()}\r\n      </div>\r\n\r\n      {/* 加载更多（如果需要分页） */}\r\n      {!loading && products.length > 0 && products.length < totalResults && (\r\n        <div className=\"flex justify-center py-6\">\r\n          <button className=\"px-6 py-2 bg-white border border-gray-300 rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-50\">\r\n            加载更多\r\n          </button>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default SearchResultPage; "],"names":["ProductCardSkeleton","className","jsxs","jsx","_","i","SearchResultPage","searchParams","setSearchParams","useSearchParams","navigate","useNavigate","products","setProducts","useState","loading","setLoading","searchQuery","setSearchQuery","totalResults","setTotalResults","query","category","useEffect","performSearch","categoryFilter","queryParams","response","data","error","handleGoBack","handleProductClick","productId","handleNewSearch","newQuery","handleSearchChange","e","handleSearchSubmit","renderProductGrid","index","product","ProductCard","StatusBar","Fragment"],"mappings":"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"}